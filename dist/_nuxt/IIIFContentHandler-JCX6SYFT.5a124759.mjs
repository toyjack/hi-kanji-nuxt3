import{O as it,P as Kt,Q as Br,R as qr,S as wt,T as Yr,_ as nt}from"./entry.cc194de1.mjs";var Xt=Kt(_=>{Object.defineProperty(_,"__esModule",{value:!0}),function(s){s.BOOKMARKING="oa:bookmarking",s.CLASSIFYING="oa:classifying",s.COMMENTING="oa:commenting",s.DESCRIBING="oa:describing",s.EDITING="oa:editing",s.HIGHLIGHTING="oa:highlighting",s.IDENTIFYING="oa:identifying",s.LINKING="oa:linking",s.MODERATING="oa:moderating",s.PAINTING="sc:painting",s.QUESTIONING="oa:questioning",s.REPLYING="oa:replying",s.TAGGING="oa:tagging",s.TRANSCRIBING="oad:transcribing"}(_.AnnotationMotivation||(_.AnnotationMotivation={})),function(s){s.AUTO_ADVANCE="auto-advance",s.CONTINUOUS="continuous",s.FACING_PAGES="facing-pages",s.HIDDEN="hidden",s.INDIVIDUALS="individuals",s.MULTI_PART="multi-part",s.NO_NAV="no-nav",s.NON_PAGED="non-paged",s.PAGED="paged",s.REPEAT="repeat",s.SEQUENCE="sequence",s.THUMBNAIL_NAV="thumbnail-nav",s.TOGETHER="together",s.UNORDERED="unordered"}(_.Behavior||(_.Behavior={})),function(s){s.CANVAS="canvas",s.CHOICE="choice",s.OA_CHOICE="oa:choice",s.CONTENT_AS_TEXT="contentastext",s.DATASET="dataset",s.DOCUMENT="document",s.IMAGE="image",s.MODEL="model",s.MOVING_IMAGE="movingimage",s.PDF="pdf",s.PHYSICAL_OBJECT="physicalobject",s.SOUND="sound",s.TEXT="text",s.TEXTUALBODY="textualbody",s.VIDEO="video"}(_.ExternalResourceType||(_.ExternalResourceType={})),function(s){s.ANNOTATION="annotation",s.CANVAS="canvas",s.COLLECTION="collection",s.MANIFEST="manifest",s.RANGE="range",s.SEQUENCE="sequence"}(_.IIIFResourceType||(_.IIIFResourceType={})),function(s){s.AUDIO_MP4="audio/mp4",s.CORTO="application/corto",s.DICOM="application/dicom",s.DRACO="application/draco",s.EPUB="application/epub+zip",s.GIRDER="image/vnd.kitware.girder",s.GLB="model/gltf-binary",s.GLTF="model/gltf+json",s.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',s.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',s.JPG="image/jpeg",s.M3U8="application/vnd.apple.mpegurl",s.MP3="audio/mp3",s.MPEG_DASH="application/dash+xml",s.OBJ="text/plain",s.OPF="application/oebps-package+xml",s.PDF="application/pdf",s.PLY="application/ply",s.THREEJS="application/vnd.threejs+json",s.USDZ="model/vnd.usd+zip",s.VIDEO_MP4="video/mp4",s.WAV="audio/wav",s.WEBM="video/webm"}(_.MediaType||(_.MediaType={})),function(s){s.DOC="application/msword",s.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",s.PDF="application/pdf"}(_.RenderingFormat||(_.RenderingFormat={})),function(s){s.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",s.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",s.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",s.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",s.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",s.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",s.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",s.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",s.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",s.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",s.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",s.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",s.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",s.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",s.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",s.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",s.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",s.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",s.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",s.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",s.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",s.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",s.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",s.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",s.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",s.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",s.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",s.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",s.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",s.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",s.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",s.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",s.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",s.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",s.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",s.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",s.SEARCH_0="http://iiif.io/api/search/0/search",s.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",s.SEARCH_1="http://iiif.io/api/search/1/search",s.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",s.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",s.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",s.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",s.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",s.DOWNLOAD_EXTENSIONS="http://universalviewer.io/download-extensions-profile",s.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",s.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(_.ServiceProfile||(_.ServiceProfile={})),function(s){s.BOTTOM_TO_TOP="bottom-to-top",s.LEFT_TO_RIGHT="left-to-right",s.RIGHT_TO_LEFT="right-to-left",s.TOP_TO_BOTTOM="top-to-bottom"}(_.ViewingDirection||(_.ViewingDirection={})),function(s){s.CONTINUOUS="continuous",s.INDIVIDUALS="individuals",s.NON_PAGED="non-paged",s.PAGED="paged",s.TOP="top"}(_.ViewingHint||(_.ViewingHint={}))}),Jt=Kt((_,s)=>{(function(g,n){typeof _=="object"&&typeof s=="object"?s.exports=n():typeof define=="function"&&define.amd?define("manifesto",[],n):typeof _=="object"?_.manifesto=n():g.manifesto=n()})(typeof self<"u"?self:_,function(){return function(g){var n={};function c(o){if(n[o])return n[o].exports;var A=n[o]={i:o,l:!1,exports:{}};return g[o].call(A.exports,A,A.exports,c),A.l=!0,A.exports}return c.m=g,c.c=n,c.d=function(o,A,y){c.o(o,A)||Object.defineProperty(o,A,{enumerable:!0,get:y})},c.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},c.t=function(o,A){if(1&A&&(o=c(o)),8&A||4&A&&typeof o=="object"&&o&&o.__esModule)return o;var y=Object.create(null);if(c.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:o}),2&A&&typeof o!="string")for(var h in o)c.d(y,h,function(m){return o[m]}.bind(null,h));return y},c.n=function(o){var A=o&&o.__esModule?function(){return o.default}:function(){return o};return c.d(A,"a",A),A},c.o=function(o,A){return Object.prototype.hasOwnProperty.call(o,A)},c.p="",c(c.s=7)}([function(g,n,c){function o(A){for(var y in A)n.hasOwnProperty(y)||(n[y]=A[y])}Object.defineProperty(n,"__esModule",{value:!0}),o(c(9)),o(c(10)),o(c(11)),o(c(12)),o(c(13)),o(c(14)),o(c(15)),o(c(16)),o(c(17)),o(c(31)),o(c(32)),o(c(33)),o(c(34)),o(c(35)),o(c(38)),o(c(39)),o(c(40)),o(c(41)),o(c(42)),o(c(43)),o(c(44)),o(c(45)),o(c(46)),o(c(47)),o(c(48)),o(c(49)),o(c(50)),o(c(3))},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),function(o){o.BOOKMARKING="oa:bookmarking",o.CLASSIFYING="oa:classifying",o.COMMENTING="oa:commenting",o.DESCRIBING="oa:describing",o.EDITING="oa:editing",o.HIGHLIGHTING="oa:highlighting",o.IDENTIFYING="oa:identifying",o.LINKING="oa:linking",o.MODERATING="oa:moderating",o.PAINTING="sc:painting",o.QUESTIONING="oa:questioning",o.REPLYING="oa:replying",o.TAGGING="oa:tagging",o.TRANSCRIBING="oad:transcribing"}(n.AnnotationMotivation||(n.AnnotationMotivation={})),function(o){o.AUTO_ADVANCE="auto-advance",o.CONTINUOUS="continuous",o.FACING_PAGES="facing-pages",o.HIDDEN="hidden",o.INDIVIDUALS="individuals",o.MULTI_PART="multi-part",o.NO_NAV="no-nav",o.NON_PAGED="non-paged",o.PAGED="paged",o.REPEAT="repeat",o.SEQUENCE="sequence",o.THUMBNAIL_NAV="thumbnail-nav",o.TOGETHER="together",o.UNORDERED="unordered"}(n.Behavior||(n.Behavior={})),function(o){o.CANVAS="canvas",o.CHOICE="choice",o.OA_CHOICE="oa:choice",o.CONTENT_AS_TEXT="contentastext",o.DATASET="dataset",o.DOCUMENT="document",o.IMAGE="image",o.MODEL="model",o.MOVING_IMAGE="movingimage",o.PDF="pdf",o.PHYSICAL_OBJECT="physicalobject",o.SOUND="sound",o.TEXT="text",o.TEXTUALBODY="textualbody",o.VIDEO="video"}(n.ExternalResourceType||(n.ExternalResourceType={})),function(o){o.ANNOTATION="annotation",o.CANVAS="canvas",o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range",o.SEQUENCE="sequence"}(n.IIIFResourceType||(n.IIIFResourceType={})),function(o){o.AUDIO_MP4="audio/mp4",o.CORTO="application/corto",o.DICOM="application/dicom",o.DRACO="application/draco",o.EPUB="application/epub+zip",o.GLB="model/gltf-binary",o.GLTF="model/gltf+json",o.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',o.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',o.JPG="image/jpeg",o.M3U8="application/vnd.apple.mpegurl",o.MP3="audio/mp3",o.MPEG_DASH="application/dash+xml",o.OBJ="text/plain",o.OPF="application/oebps-package+xml",o.PDF="application/pdf",o.PLY="application/ply",o.THREEJS="application/vnd.threejs+json",o.USDZ="model/vnd.usd+zip",o.VIDEO_MP4="video/mp4",o.WEBM="video/webm"}(n.MediaType||(n.MediaType={})),function(o){o.DOC="application/msword",o.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",o.PDF="application/pdf"}(n.RenderingFormat||(n.RenderingFormat={})),function(o){o.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",o.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",o.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",o.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",o.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",o.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",o.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",o.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",o.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",o.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",o.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",o.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",o.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",o.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",o.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",o.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",o.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",o.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",o.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",o.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",o.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",o.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",o.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",o.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",o.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",o.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",o.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",o.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",o.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",o.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",o.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",o.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",o.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",o.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",o.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",o.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",o.SEARCH_0="http://iiif.io/api/search/0/search",o.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",o.SEARCH_1="http://iiif.io/api/search/1/search",o.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",o.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",o.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",o.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",o.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",o.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",o.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(n.ServiceProfile||(n.ServiceProfile={})),function(o){o.BOTTOM_TO_TOP="bottom-to-top",o.LEFT_TO_RIGHT="left-to-right",o.RIGHT_TO_LEFT="right-to-left",o.TOP_TO_BOTTOM="top-to-bottom"}(n.ViewingDirection||(n.ViewingDirection={})),function(o){o.CONTINUOUS="continuous",o.INDIVIDUALS="individuals",o.NON_PAGED="non-paged",o.PAGED="paged",o.TOP="top"}(n.ViewingHint||(n.ViewingHint={}))},function(g,n,c){var o=c(21).Symbol;g.exports=o},function(g,n,c){var o=this&&this.__awaiter||function(a,t,f,d){return new(f||(f=Promise))(function(E,R){function P(G){try{D(d.next(G))}catch(V){R(V)}}function j(G){try{D(d.throw(G))}catch(V){R(V)}}function D(G){var V;G.done?E(G.value):(V=G.value,V instanceof f?V:new f(function(K){K(V)})).then(P,j)}D((d=d.apply(a,t||[])).next())})},A=this&&this.__generator||function(a,t){var f,d,E,R,P={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return R={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function j(D){return function(G){return function(V){if(f)throw new TypeError("Generator is already executing.");for(;P;)try{if(f=1,d&&(E=2&V[0]?d.return:V[0]?d.throw||((E=d.return)&&E.call(d),0):d.next)&&!(E=E.call(d,V[1])).done)return E;switch(d=0,E&&(V=[2&V[0],E.value]),V[0]){case 0:case 1:E=V;break;case 4:return P.label++,{value:V[1],done:!1};case 5:P.label++,d=V[1],V=[0];continue;case 7:V=P.ops.pop(),P.trys.pop();continue;default:if(!(E=(E=P.trys).length>0&&E[E.length-1])&&(V[0]===6||V[0]===2)){P=0;continue}if(V[0]===3&&(!E||V[1]>E[0]&&V[1]<E[3])){P.label=V[1];break}if(V[0]===6&&P.label<E[1]){P.label=E[1],E=V;break}if(E&&P.label<E[2]){P.label=E[2],P.ops.push(V);break}E[2]&&P.ops.pop(),P.trys.pop();continue}V=t.call(a,P)}catch(K){V=[6,K],d=0}finally{f=E=0}if(5&V[0])throw V[1];return{value:V[0]?V[1]:void 0,done:!0}}([D,G])}}};Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=c(1),m=c(36);c(37);var I=function(){function a(){}return a.getMediaType=function(t){return(t=(t=t.toLowerCase()).split(";")[0]).trim()},a.getImageQuality=function(t){return t===h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||t===h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||t===h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||t===h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||t===h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||t===h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||t===h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||t===h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||t===h.ServiceProfile.IMAGE_1_LEVEL_1||t===h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||t===h.ServiceProfile.IMAGE_1_LEVEL_2||t===h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},a.getInexactLocale=function(t){return t.indexOf("-")!==-1?t.substr(0,t.indexOf("-")):t},a.getLocalisedValue=function(t,f){if(!Array.isArray(t))return t;for(var d=0;d<t.length;d++){var E=t[d];if(f===E["@language"])return E["@value"]}var R=f.substr(0,f.indexOf("-"));for(d=0;d<t.length;d++){var P=t[d];if(P["@language"]===R)return P["@value"]}return null},a.generateTreeNodeIds=function(t,f){var d;f===void 0&&(f=0),d=t.parentNode?t.parentNode.id+"-"+f:"0",t.id=d;for(var E=0;E<t.nodes.length;E++){var R=t.nodes[E];a.generateTreeNodeIds(R,E)}},a.normaliseType=function(t){return(t=(t||"").toLowerCase()).indexOf(":")!==-1?t.split(":")[1]:t},a.normaliseUrl=function(t){return(t=t.substr(t.indexOf("://"))).indexOf("#")!==-1&&(t=t.split("#")[0]),t},a.normalisedUrlsMatch=function(t,f){return a.normaliseUrl(t)===a.normaliseUrl(f)},a.isImageProfile=function(t){return!!(a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},a.isLevel0ImageProfile=function(t){return!!(a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_LEVEL_0)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},a.isLevel1ImageProfile=function(t){return!!(a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_LEVEL_1)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},a.isLevel2ImageProfile=function(t){return!!(a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_LEVEL_2)||a.normalisedUrlsMatch(t,h.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},a.parseManifest=function(t,f){return y.Deserialiser.parse(t,f)},a.checkStatus=function(t){if(t.ok)return t;var f=new Error(t.statusText);return f.response=t,Promise.reject(f)},a.loadManifest=function(t){return new Promise(function(f,d){fetch(t).then(a.checkStatus).then(function(E){return E.json()}).then(function(E){f(E)}).catch(function(E){d()})})},a.loadExternalResourcesAuth1=function(t,f,d,E,R,P,j,D){return new Promise(function(G,V){var K=t.map(function(Y){return a.loadExternalResourceAuth1(Y,f,d,E,R,P,j,D)});Promise.all(K).then(function(){G(t)}).catch(function(Y){V(Y)})})},a.loadExternalResourceAuth1=function(t,f,d,E,R,P,j,D){return o(this,void 0,void 0,function(){var G;return A(this,function(V){switch(V.label){case 0:return[4,E(t)];case 1:return(G=V.sent())?[4,t.getData(G)]:[3,6];case 2:return V.sent(),t.status!==m.OK?[3,3]:[2,t];case 3:return[4,a.doAuthChain(t,f,d,R,P,j,D)];case 4:V.sent(),V.label=5;case 5:if(t.status===m.OK||t.status===m.MOVED_TEMPORARILY)return[2,t];throw a.createAuthorizationFailedError();case 6:return[4,t.getData()];case 7:return V.sent(),t.status!==m.MOVED_TEMPORARILY&&t.status!==m.UNAUTHORIZED?[3,9]:[4,a.doAuthChain(t,f,d,R,P,j,D)];case 8:V.sent(),V.label=9;case 9:if(t.status===m.OK||t.status===m.MOVED_TEMPORARILY)return[2,t];throw a.createAuthorizationFailedError()}})})},a.doAuthChain=function(t,f,d,E,R,P,j){return o(this,void 0,void 0,function(){var D,G,V,K,Y,W,oe,Pe;return A(this,function(Oe){switch(Oe.label){case 0:return t.isAccessControlled()?((D=t.externalService)&&(D.options=t.options),(G=t.kioskService)&&(G.options=t.options),(V=t.clickThroughService)&&(V.options=t.options),(K=t.loginService)&&(K.options=t.options),t.isResponseHandled||t.status!==m.MOVED_TEMPORARILY?[3,2]:[4,P(t)]):[2,t];case 1:return Oe.sent(),[2,t];case 2:return Y=null,W=null,(Y=D)?(W=Y,[4,a.attemptResourceWithToken(t,d,Y)]):[3,4];case 3:return Oe.sent(),[2,t];case 4:return(Y=G)?(W=Y,(oe=f(Y))?[4,E(oe)]:[3,7]):[3,7];case 5:return Oe.sent(),[4,a.attemptResourceWithToken(t,d,Y)];case 6:return Oe.sent(),[2,t];case 7:return(Y=V)?(W=Y,[4,R(t,Y)]):[3,11];case 8:return(Pe=Oe.sent())?[4,E(Pe)]:[3,11];case 9:return Oe.sent(),[4,a.attemptResourceWithToken(t,d,Y)];case 10:return Oe.sent(),[2,t];case 11:return(Y=K)?(W=Y,[4,R(t,Y)]):[3,15];case 12:return(Pe=Oe.sent())?[4,E(Pe)]:[3,15];case 13:return Oe.sent(),[4,a.attemptResourceWithToken(t,d,Y)];case 14:return Oe.sent(),[2,t];case 15:return W&&j(t,W),[2]}})})},a.attemptResourceWithToken=function(t,f,d){return o(this,void 0,void 0,function(){var E,R;return A(this,function(P){switch(P.label){case 0:return(E=d.getService(h.ServiceProfile.AUTH_1_TOKEN))?[4,f(t,E)]:[3,3];case 1:return(R=P.sent())&&R.accessToken?[4,t.getData(R)]:[3,3];case 2:return P.sent(),[2,t];case 3:return[2]}})})},a.loadExternalResourcesAuth09=function(t,f,d,E,R,P,j,D,G,V){return new Promise(function(K,Y){var W=t.map(function(oe){return a.loadExternalResourceAuth09(oe,f,d,E,R,P,j,D,G,V)});Promise.all(W).then(function(){K(t)}).catch(function(oe){Y(oe)})})},a.loadExternalResourceAuth09=function(t,f,d,E,R,P,j,D,G,V){return new Promise(function(K,Y){V&&V.pessimisticAccessControl?t.getData().then(function(){t.isAccessControlled()?t.clickThroughService?(K(d(t)),K(E(t))):R(t).then(function(){P(t,!0).then(function(W){t.getData(W).then(function(){K(G(t))}).catch(function(oe){Y(a.createInternalServerError(oe))})}).catch(function(W){Y(a.createInternalServerError(W))})}).catch(function(W){Y(a.createInternalServerError(W))}):K(t)}).catch(function(W){Y(a.createInternalServerError(W))}):D(t,f).then(function(W){W?t.getData(W).then(function(){t.status===m.OK?K(G(t)):a.authorize(t,f,d,E,R,P,j,D).then(function(){K(G(t))}).catch(function(oe){Y(a.createAuthorizationFailedError())})}).catch(function(oe){Y(a.createAuthorizationFailedError())}):a.authorize(t,f,d,E,R,P,j,D).then(function(){K(G(t))}).catch(function(oe){Y(a.createAuthorizationFailedError())})}).catch(function(W){Y(a.createAuthorizationFailedError())})})},a.createError=function(t,f){var d=new Error;return d.message=f,d.name=String(t),d},a.createAuthorizationFailedError=function(){return a.createError(y.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},a.createRestrictedError=function(){return a.createError(y.StatusCode.RESTRICTED,"Restricted")},a.createInternalServerError=function(t){return a.createError(y.StatusCode.INTERNAL_SERVER_ERROR,t)},a.authorize=function(t,f,d,E,R,P,j,D){return new Promise(function(G,V){t.getData().then(function(){t.isAccessControlled()?D(t,f).then(function(K){K?t.getData(K).then(function(){t.status===m.OK?G(t):a.showAuthInteraction(t,f,d,E,R,P,j,G,V)}).catch(function(Y){V(a.createInternalServerError(Y))}):P(t,!1).then(function(Y){Y?j(t,Y,f).then(function(){t.getData(Y).then(function(){t.status===m.OK?G(t):a.showAuthInteraction(t,f,d,E,R,P,j,G,V)}).catch(function(W){V(a.createInternalServerError(W))})}).catch(function(W){V(a.createInternalServerError(W))}):a.showAuthInteraction(t,f,d,E,R,P,j,G,V)})}).catch(function(K){V(a.createInternalServerError(K))}):G(t)})})},a.showAuthInteraction=function(t,f,d,E,R,P,j,D,G){t.status!==m.MOVED_TEMPORARILY||t.isResponseHandled?t.clickThroughService&&!t.isResponseHandled?d(t).then(function(){P(t,!0).then(function(V){j(t,V,f).then(function(){t.getData(V).then(function(){D(t)}).catch(function(K){G(a.createInternalServerError(K))})}).catch(function(K){G(a.createInternalServerError(K))})}).catch(function(V){G(a.createInternalServerError(V))})}):R(t).then(function(){P(t,!0).then(function(V){j(t,V,f).then(function(){t.getData(V).then(function(){D(t)}).catch(function(K){G(a.createInternalServerError(K))})}).catch(function(K){G(a.createInternalServerError(K))})}).catch(function(V){G(a.createInternalServerError(V))})}):D(t)},a.getService=function(t,f){for(var d=this.getServices(t),E=0;E<d.length;E++){var R=d[E];if(R.getProfile()===f)return R}return null},a.getResourceById=function(t,f){return a.traverseAndFind(t.__jsonld,"@id",f)},a.traverseAndFind=function(t,f,d){if(t.hasOwnProperty(f)&&t[f]===d)return t;for(var E=0;E<Object.keys(t).length;E++)if(typeof t[Object.keys(t)[E]]=="object"){var R=a.traverseAndFind(t[Object.keys(t)[E]],f,d);if(R!=null)return R}},a.getServices=function(t,f){var d=f===void 0?{}:f,E=d.onlyService,R=E!==void 0&&E,P=d.onlyServices,j=P!==void 0&&P,D=d.skipParentResources,G=[];!(D!==void 0&&D)&&t&&t.options&&t.options.resource&&t.options.resource!==t&&G.push.apply(G,a.getServices(t.options.resource,{onlyServices:!0}));var V=j?[]:(t.__jsonld||t).service||[];if(Array.isArray(V)||(V=[V]),R||V.push.apply(V,(t.__jsonld||t).services||[]),V.length===0)return G;for(var K=0;K<V.length;K++){var Y=V[K];if(typeof Y=="string"){var W=this.getResourceById(t.options.resource,Y);W&&G.push(new y.Service(W.__jsonld||W,t.options))}else G.push(new y.Service(Y,t.options))}return G},a.getTemporalComponent=function(t){var f=/t=([^&]+)/g.exec(t),d=null;return f&&f[1]&&(d=f[1].split(",")),d},a}();n.Utils=I},function(g,n,c){var o=c(19),A=c(20);g.exports=function y(h,m,I,a,t){var f=-1,d=h.length;for(I||(I=A),t||(t=[]);++f<d;){var E=h[f];m>0&&I(E)?m>1?y(E,m-1,I,a,t):o(t,E):a||(t[t.length]=E)}return t}},function(g,n){g.exports=function(c){return c!=null&&typeof c=="object"}},function(g,n,c){c.r(n),n.default=function(o,A){return A=A||{},new Promise(function(y,h){var m=new XMLHttpRequest,I=[],a=[],t={},f=function(){return{ok:(m.status/100|0)==2,statusText:m.statusText,status:m.status,url:m.responseURL,text:function(){return Promise.resolve(m.responseText)},json:function(){return Promise.resolve(JSON.parse(m.responseText))},blob:function(){return Promise.resolve(new Blob([m.response]))},clone:f,headers:{keys:function(){return I},entries:function(){return a},get:function(E){return t[E.toLowerCase()]},has:function(E){return E.toLowerCase()in t}}}};for(var d in m.open(A.method||"get",o,!0),m.onload=function(){m.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(E,R,P){I.push(R=R.toLowerCase()),a.push([R,P]),t[R]=t[R]?t[R]+","+P:P}),y(f())},m.onerror=h,m.withCredentials=A.credentials=="include",A.headers)m.setRequestHeader(d,A.headers[d]);m.send(A.body||null)})}},function(g,n,c){g.exports=c(8)},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),function(A){for(var y in A)n.hasOwnProperty(y)||(n[y]=A[y])}(c(0));var o=c(3);n.loadManifest=function(A){return o.Utils.loadManifest(A)},n.parseManifest=function(A,y){return o.Utils.parseManifest(A,y)}},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function A(y){this.__jsonld=y,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return A.prototype.getProperty=function(y){var h=null;return this.__jsonld&&((h=this.__jsonld[y])||(h=this.__jsonld["@"+y])),h},A}();n.JSONLDResource=o},function(g,n,c){var o,A=this&&this.__extends||(o=function(I,a){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,f){t.__proto__=f}||function(t,f){for(var d in f)f.hasOwnProperty(d)&&(t[d]=f[d])})(I,a)},function(I,a){function t(){this.constructor=I}o(I,a),I.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=c(1),m=function(I){function a(t,f){var d=I.call(this,t)||this;return d.options=f,d}return A(a,I),a.prototype.getIIIFResourceType=function(){return y.Utils.normaliseType(this.getProperty("type"))},a.prototype.getLabel=function(){var t=this.getProperty("label");return t?y.PropertyValue.parse(t,this.options.locale):new y.PropertyValue([],this.options.locale)},a.prototype.getDefaultLabel=function(){return this.getLabel().getValue(this.options.locale)},a.prototype.getMetadata=function(){var t=this.getProperty("metadata"),f=[];if(!t)return f;for(var d=0;d<t.length;d++){var E=t[d],R=new y.LabelValuePair(this.options.locale);R.parse(E),f.push(R)}return f},a.prototype.getRendering=function(t){for(var f=this.getRenderings(),d=0;d<f.length;d++){var E=f[d];if(E.getFormat()===t)return E}return null},a.prototype.getRenderings=function(){var t,f=[];if(!(t=this.__jsonld?this.__jsonld.rendering:this.rendering))return f;Array.isArray(t)||(t=[t]);for(var d=0;d<t.length;d++){var E=t[d];f.push(new y.Rendering(E,this.options))}return f},a.prototype.getRequiredStatement=function(){var t=null,f=this.getProperty("requiredStatement");return f&&(t=new y.LabelValuePair(this.options.locale)).parse(f),t},a.prototype.getService=function(t){return y.Utils.getService(this,t)},a.prototype.getServices=function(){return y.Utils.getServices(this)},a.prototype.getThumbnail=function(){var t=this.getProperty("thumbnail");return Array.isArray(t)&&(t=t[0]),t?new y.Thumbnail(t,this.options):null},a.prototype.isAnnotation=function(){return this.getIIIFResourceType()===h.IIIFResourceType.ANNOTATION},a.prototype.isCanvas=function(){return this.getIIIFResourceType()===h.IIIFResourceType.CANVAS},a.prototype.isCollection=function(){return this.getIIIFResourceType()===h.IIIFResourceType.COLLECTION},a.prototype.isManifest=function(){return this.getIIIFResourceType()===h.IIIFResourceType.MANIFEST},a.prototype.isRange=function(){return this.getIIIFResourceType()===h.IIIFResourceType.RANGE},a.prototype.isSequence=function(){return this.getIIIFResourceType()===h.IIIFResourceType.SEQUENCE},a}(y.JSONLDResource);n.ManifestResource=m},function(g,n,c){var o,A=this&&this.__extends||(o=function(m,I){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var f in t)t.hasOwnProperty(f)&&(a[f]=t[f])})(m,I)},function(m,I){function a(){this.constructor=m}o(m,I),m.prototype=I===null?Object.create(I):(a.prototype=I.prototype,new a)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=function(m){function I(a,t){return m.call(this,a,t)||this}return A(I,m),I.prototype.getFormat=function(){var a=this.getProperty("format");return a?a.toLowerCase():null},I.prototype.getResources=function(){var a=[];if(!this.__jsonld.resources)return a;for(var t=0;t<this.__jsonld.resources.length;t++){var f=this.__jsonld.resources[t],d=new y.Annotation(f,this.options);a.push(d)}return a},I.prototype.getType=function(){var a=this.getProperty("type");return a?y.Utils.normaliseType(a):null},I.prototype.getWidth=function(){return this.getProperty("width")},I.prototype.getHeight=function(){return this.getProperty("height")},I.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},I.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},I}(y.ManifestResource);n.Resource=h},function(g,n,c){var o,A=this&&this.__extends||(o=function(I,a){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,f){t.__proto__=f}||function(t,f){for(var d in f)f.hasOwnProperty(d)&&(t[d]=f[d])})(I,a)},function(I,a){function t(){this.constructor=I}o(I,a),I.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=c(1),m=function(I){function a(t,f){var d=I.call(this,t,f)||this;d.index=-1,d.isLoaded=!1;var E={defaultLabel:"-",locale:"en-GB",resource:d,pessimisticAccessControl:!1};return d.options=Object.assign(E,f),d}return A(a,I),a.prototype.getAttribution=function(){var t=this.getProperty("attribution");return t?y.PropertyValue.parse(t,this.options.locale):new y.PropertyValue([],this.options.locale)},a.prototype.getDescription=function(){var t=this.getProperty("description");return t?y.PropertyValue.parse(t,this.options.locale):new y.PropertyValue([],this.options.locale)},a.prototype.getHomepage=function(){var t=this.getProperty("homepage");return t?typeof t=="string"?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},a.prototype.getIIIFResourceType=function(){return y.Utils.normaliseType(this.getProperty("type"))},a.prototype.getLogo=function(){var t=this.getProperty("logo");if(!t){var f=this.getProperty("provider");if(!f)return null;t=f.logo}return t?typeof t=="string"?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},a.prototype.getLicense=function(){return y.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},a.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},a.prototype.getRelated=function(){return this.getProperty("related")},a.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},a.prototype.getTrackingLabel=function(){var t=this.getService(h.ServiceProfile.TRACKING_EXTENSIONS);return t?t.getProperty("trackingLabel"):""},a.prototype.getDefaultTree=function(){return this.defaultTree=new y.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},a.prototype.getRequiredStatement=function(){var t=null,f=this.getProperty("requiredStatement");if(f)(t=new y.LabelValuePair(this.options.locale)).parse(f);else{var d=this.getAttribution();d&&((t=new y.LabelValuePair(this.options.locale)).value=d)}return t},a.prototype.isCollection=function(){return this.getIIIFResourceType()===h.IIIFResourceType.COLLECTION},a.prototype.isManifest=function(){return this.getIIIFResourceType()===h.IIIFResourceType.MANIFEST},a.prototype.load=function(){var t=this;return new Promise(function(f){if(t.isLoaded)f(t);else{var d=t.options;d.navDate=t.getNavDate();var E=t.__jsonld.id;E||(E=t.__jsonld["@id"]),y.Utils.loadManifest(E).then(function(R){t.parentLabel=t.getLabel().getValue(d.locale);var P=y.Deserialiser.parse(R,d);(t=Object.assign(t,P)).index=d.index,f(t)})}})},a}(y.ManifestResource);n.IIIFResource=m},function(g,n,c){var o,A=this&&this.__extends||(o=function(m,I){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var f in t)t.hasOwnProperty(f)&&(a[f]=t[f])})(m,I)},function(m,I){function a(){this.constructor=m}o(m,I),m.prototype=I===null?Object.create(I):(a.prototype=I.prototype,new a)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=function(m){function I(a,t){return m.call(this,a,t)||this}return A(I,m),I.prototype.getBody=function(){var a=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var f=0;f<t.length;f++)if((R=t[f]).items)for(var d=0;d<R.items.length;d++){var E=R.items[d];a.push(new y.AnnotationBody(E,this.options))}else a.push(new y.AnnotationBody(R,this.options));else if(t.items)for(f=0;f<t.items.length;f++){var R=t.items[f];a.push(new y.AnnotationBody(R,this.options))}else a.push(new y.AnnotationBody(t,this.options));return a},I.prototype.getMotivation=function(){var a=this.getProperty("motivation");return a||null},I.prototype.getOn=function(){return this.getProperty("on")},I.prototype.getTarget=function(){return this.getProperty("target")},I.prototype.getResource=function(){return new y.Resource(this.getProperty("resource"),this.options)},I}(y.ManifestResource);n.Annotation=h},function(g,n,c){var o,A=this&&this.__extends||(o=function(m,I){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var f in t)t.hasOwnProperty(f)&&(a[f]=t[f])})(m,I)},function(m,I){function a(){this.constructor=m}o(m,I),m.prototype=I===null?Object.create(I):(a.prototype=I.prototype,new a)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=function(m){function I(a,t){return m.call(this,a,t)||this}return A(I,m),I.prototype.getFormat=function(){var a=this.getProperty("format");return a?y.Utils.getMediaType(a):null},I.prototype.getType=function(){return this.getProperty("type")?y.Utils.normaliseType(this.getProperty("type")):null},I.prototype.getWidth=function(){return this.getProperty("width")},I.prototype.getHeight=function(){return this.getProperty("height")},I}(y.ManifestResource);n.AnnotationBody=h},function(g,n,c){var o,A=this&&this.__extends||(o=function(m,I){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var f in t)t.hasOwnProperty(f)&&(a[f]=t[f])})(m,I)},function(m,I){function a(){this.constructor=m}o(m,I),m.prototype=I===null?Object.create(I):(a.prototype=I.prototype,new a)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=function(m){function I(a,t,f){var d=m.call(this,t)||this;return d.label=a,d.options=f,d}return A(I,m),I.prototype.getIIIFResourceType=function(){return y.Utils.normaliseType(this.getProperty("type"))},I.prototype.getLabel=function(){return this.label},I.prototype.getResources=function(){var a=this;return this.getProperty("resources").map(function(t){return new y.Annotation(t,a.options)})},I.prototype.load=function(){var a=this;return new Promise(function(t,f){if(a.isLoaded)t(a);else{var d=a.__jsonld.id;d||(d=a.__jsonld["@id"]),y.Utils.loadManifest(d).then(function(E){a.__jsonld=E,a.context=a.getProperty("context"),a.id=a.getProperty("id"),a.isLoaded=!0,t(a)}).catch(f)}})},I}(y.JSONLDResource);n.AnnotationList=h},function(g,n,c){var o,A=this&&this.__extends||(o=function(h,m){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,a){I.__proto__=a}||function(I,a){for(var t in a)a.hasOwnProperty(t)&&(I[t]=a[t])})(h,m)},function(h,m){function I(){this.constructor=h}o(h,m),h.prototype=m===null?Object.create(m):(I.prototype=m.prototype,new I)});Object.defineProperty(n,"__esModule",{value:!0});var y=function(h){function m(I,a){return h.call(this,I,a)||this}return A(m,h),m.prototype.getItems=function(){return this.getProperty("items")},m}(c(0).ManifestResource);n.AnnotationPage=y},function(g,n,c){var o,A=this&&this.__extends||(o=function(f,d){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,R){E.__proto__=R}||function(E,R){for(var P in R)R.hasOwnProperty(P)&&(E[P]=R[P])})(f,d)},function(f,d){function E(){this.constructor=f}o(f,d),f.prototype=d===null?Object.create(d):(E.prototype=d.prototype,new E)}),y=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(n,"__esModule",{value:!0});var h=c(1),m=c(0),I=y(c(18)),a=y(c(30)),t=function(f){function d(E,R){return f.call(this,E,R)||this}return A(d,f),d.prototype.getCanonicalImageUri=function(E){var R,P=null,j="default",D=E;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])P=this.externalResource.data["@id"],D||(D=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(j="native");else{var G=this.getImages();if(G&&G.length){var V=G[0].getResource(),K=V.getServices();D||(D=V.getWidth());var Y=K?K.find(function(oe){return m.Utils.isImageProfile(oe.getProfile())}):null;if(Y)P=Y.id,j=m.Utils.getImageQuality(Y.getProfile());else if(D===V.getWidth())return V.id}if(!P){var W=this.getProperty("thumbnail");if(W){if(typeof W=="string")return W;if(W["@id"])return W["@id"];if(W.length)return W[0].id}}}return R=D+",",P&&P.endsWith("/")&&(P=P.substr(0,P.length-1)),[P,"full",R,0,j+".jpg"].join("/")},d.prototype.getMaxDimensions=function(){var E,R=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(E=this.externalResource.data.profile,Array.isArray(E)&&(E=E.filter(function(P){return P.maxWidth})[0])&&(R=new m.Size(E.maxWidth,E.maxHeight?E.maxHeight:E.maxWidth))),R},d.prototype.getContent=function(){var E=[],R=this.__jsonld.items||this.__jsonld.content;if(!R)return E;var P=null;if(R.length&&(P=new m.AnnotationPage(R[0],this.options)),!P)return E;for(var j=P.getItems(),D=0;D<j.length;D++){var G=j[D],V=new m.Annotation(G,this.options);E.push(V)}return E},d.prototype.getDuration=function(){return this.getProperty("duration")},d.prototype.getImages=function(){var E=[];if(!this.__jsonld.images)return E;for(var R=0;R<this.__jsonld.images.length;R++){var P=this.__jsonld.images[R],j=new m.Annotation(P,this.options);E.push(j)}return E},d.prototype.getIndex=function(){return this.getProperty("index")},d.prototype.getOtherContent=function(){var E=this,R=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],P=R.filter(function(j){return j&&(D=j["@type"],G="sc:AnnotationList",typeof D=="string"&&typeof G=="string"&&D.toLowerCase()==D.toLowerCase());var D,G}).map(function(j,D){return new m.AnnotationList(j.label||"Annotation list "+D,j,E.options)}).map(function(j){return j.load()});return Promise.all(P)},d.prototype.getWidth=function(){return this.getProperty("width")},d.prototype.getHeight=function(){return this.getProperty("height")},d.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(d.prototype,"imageResources",{get:function(){var E=this,R=a.default([this.getImages().map(function(P){return P.getResource()}),this.getContent().map(function(P){return P.getBody()})]);return I.default(R.map(function(P){switch(P.getProperty("type").toLowerCase()){case h.ExternalResourceType.CHOICE:case h.ExternalResourceType.OA_CHOICE:return new d({images:I.default([P.getProperty("default"),P.getProperty("item")]).map(function(j){return{resource:j}})},E.options).getImages().map(function(j){return j.getResource()});default:return P}}))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"resourceAnnotations",{get:function(){return a.default([this.getImages(),this.getContent()])},enumerable:!0,configurable:!0}),d.prototype.resourceAnnotation=function(E){return this.resourceAnnotations.find(function(R){return R.getResource().id===E||I.default(new Array(R.getBody())).some(function(P){return P.id===E})})},d.prototype.onFragment=function(E){var R=this.resourceAnnotation(E);if(R){var P=R.getProperty("on"),j=R.getProperty("target"),D=(P||j).match(/xywh=(.*)$/);if(D)return D[1].split(",").map(function(G){return parseInt(G,10)})}},Object.defineProperty(d.prototype,"iiifImageResources",{get:function(){return this.imageResources.filter(function(E){return E&&E.getServices()[0]&&E.getServices()[0].id})},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"imageServiceIds",{get:function(){return this.iiifImageResources.map(function(E){return E.getServices()[0].id})},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"aspectRatio",{get:function(){return this.getWidth()/this.getHeight()},enumerable:!0,configurable:!0}),d}(m.Resource);n.Canvas=t},function(g,n,c){var o=c(4);g.exports=function(A){return A!=null&&A.length?o(A,1):[]}},function(g,n){g.exports=function(c,o){for(var A=-1,y=o.length,h=c.length;++A<y;)c[h+A]=o[A];return c}},function(g,n,c){var o=c(2),A=c(24),y=c(29),h=o?o.isConcatSpreadable:void 0;g.exports=function(m){return y(m)||A(m)||!!(h&&m&&m[h])}},function(g,n,c){var o=c(22),A=typeof self=="object"&&self&&self.Object===Object&&self,y=o||A||Function("return this")();g.exports=y},function(g,n,c){(function(o){var A=typeof o=="object"&&o&&o.Object===Object&&o;g.exports=A}).call(this,c(23))},function(g,n){var c;c=function(){return this}();try{c=c||new Function("return this")()}catch{typeof window=="object"&&(c=window)}g.exports=c},function(g,n,c){var o=c(25),A=c(5),y=Object.prototype,h=y.hasOwnProperty,m=y.propertyIsEnumerable,I=o(function(){return arguments}())?o:function(a){return A(a)&&h.call(a,"callee")&&!m.call(a,"callee")};g.exports=I},function(g,n,c){var o=c(26),A=c(5),y="[object Arguments]";g.exports=function(h){return A(h)&&o(h)==y}},function(g,n,c){var o=c(2),A=c(27),y=c(28),h="[object Null]",m="[object Undefined]",I=o?o.toStringTag:void 0;g.exports=function(a){return a==null?a===void 0?m:h:I&&I in Object(a)?A(a):y(a)}},function(g,n,c){var o=c(2),A=Object.prototype,y=A.hasOwnProperty,h=A.toString,m=o?o.toStringTag:void 0;g.exports=function(I){var a=y.call(I,m),t=I[m];try{I[m]=void 0;var f=!0}catch{}var d=h.call(I);return f&&(a?I[m]=t:delete I[m]),d}},function(g,n){var c=Object.prototype.toString;g.exports=function(o){return c.call(o)}},function(g,n){var c=Array.isArray;g.exports=c},function(g,n,c){var o=c(4),A=1/0;g.exports=function(y){return y!=null&&y.length?o(y,A):[]}},function(g,n,c){var o,A=this&&this.__extends||(o=function(I,a){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,f){t.__proto__=f}||function(t,f){for(var d in f)f.hasOwnProperty(d)&&(t[d]=f[d])})(I,a)},function(I,a){function t(){this.constructor=I}o(I,a),I.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(1),h=c(0),m=function(I){function a(t,f){var d=I.call(this,t,f)||this;return d.items=[],d._collections=null,d._manifests=null,t.__collection=d,d}return A(a,I),a.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(t){return t.isCollection()})},a.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(t){return t.isManifest()})},a.prototype.getCollectionByIndex=function(t){for(var f,d=this.getCollections(),E=0;E<d.length;E++){var R=d[E];R.index===t&&(f=R)}if(f)return f.options.index=t,f.load();throw new Error("Collection index not found")},a.prototype.getManifestByIndex=function(t){for(var f,d=this.getManifests(),E=0;E<d.length;E++){var R=d[E];R.index===t&&(f=R)}if(f)return f.options.index=t,f.load();throw new Error("Manifest index not found")},a.prototype.getTotalCollections=function(){return this.getCollections().length},a.prototype.getTotalManifests=function(){return this.getManifests().length},a.prototype.getTotalItems=function(){return this.items.length},a.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):y.ViewingDirection.LEFT_TO_RIGHT},a.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},a.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},a.prototype.getDefaultTree=function(){return I.prototype.getDefaultTree.call(this),this.defaultTree.data.type=h.Utils.normaliseType(h.TreeNodeType.COLLECTION),this._parseManifests(this),this._parseCollections(this),h.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},a.prototype._parseManifests=function(t){if(t.getManifests()&&t.getManifests().length)for(var f=0;f<t.getManifests().length;f++){var d=t.getManifests()[f],E=d.getDefaultTree();E.label=d.parentLabel||d.getLabel().getValue(this.options.locale)||"manifest "+(f+1),E.navDate=d.getNavDate(),E.data.id=d.id,E.data.type=h.Utils.normaliseType(h.TreeNodeType.MANIFEST),t.defaultTree.addNode(E)}},a.prototype._parseCollections=function(t){if(t.getCollections()&&t.getCollections().length)for(var f=0;f<t.getCollections().length;f++){var d=t.getCollections()[f],E=d.getDefaultTree();E.label=d.parentLabel||d.getLabel().getValue(this.options.locale)||"collection "+(f+1),E.navDate=d.getNavDate(),E.data.id=d.id,E.data.type=h.Utils.normaliseType(h.TreeNodeType.COLLECTION),t.defaultTree.addNode(E)}},a}(h.IIIFResource);n.Collection=m},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function A(y,h){this.start=y,this.end=h}return A.prototype.getLength=function(){return this.end-this.start},A}();n.Duration=o},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=c(0),A=function(){function y(h){this.defaultLocale=h}return y.prototype.parse=function(h){this.resource=h,this.label=o.PropertyValue.parse(this.resource.label,this.defaultLocale),this.value=o.PropertyValue.parse(this.resource.value,this.defaultLocale)},y.prototype.getLabel=function(h){return this.label===null?null:(Array.isArray(h)&&!h.length&&(h=void 0),this.label.getValue(h||this.defaultLocale))},y.prototype.setLabel=function(h){this.label===null&&(this.label=new o.PropertyValue([])),this.label.setValue(h,this.defaultLocale)},y.prototype.getValue=function(h,m){return m===void 0&&(m="<br/>"),this.value===null?null:(Array.isArray(h)&&!h.length&&(h=void 0),this.value.getValue(h||this.defaultLocale,m))},y.prototype.getValues=function(h){return this.value===null?[]:(Array.isArray(h)&&!h.length&&(h=void 0),this.value.getValues(h||this.defaultLocale))},y.prototype.setValue=function(h){this.value===null&&(this.value=new o.PropertyValue([])),this.value.setValue(h,this.defaultLocale)},y}();n.LabelValuePair=A},function(g,n,c){var o,A=this&&this.__extends||(o=function(h,m){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,a){I.__proto__=a}||function(I,a){for(var t in a)a.hasOwnProperty(t)&&(I[t]=a[t])})(h,m)},function(h,m){function I(){this.constructor=h}o(h,m),h.prototype=m===null?Object.create(m):(I.prototype=m.prototype,new I)});Object.defineProperty(n,"__esModule",{value:!0});var y=function(h){function m(){return h!==null&&h.apply(this,arguments)||this}return A(m,h),m.getValue=function(I,a){return I.getValue(a,"<br/>")},m.getValues=function(I,a){return I.getValues(a)},m}(Array);n.LanguageMap=y},function(g,n,c){var o,A=this&&this.__extends||(o=function(a,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var E in d)d.hasOwnProperty(E)&&(f[E]=d[E])})(a,t)},function(a,t){function f(){this.constructor=a}o(a,t),a.prototype=t===null?Object.create(t):(f.prototype=t.prototype,new f)}),y=this&&this.__spreadArrays||function(){for(var a=0,t=0,f=arguments.length;t<f;t++)a+=arguments[t].length;var d=Array(a),E=0;for(t=0;t<f;t++)for(var R=arguments[t],P=0,j=R.length;P<j;P++,E++)d[E]=R[P];return d};Object.defineProperty(n,"__esModule",{value:!0});var h=c(3),m=function(){function a(t,f,d){d===void 0&&(d="none"),Array.isArray(t)&&t.length===1?this._value=t[0]:this._value=t,f!=="none"&&f!=="@none"||(f=void 0),this._locale=f,this._defaultLocale=d}return a.parseV2Value=function(t,f){return typeof t=="string"?new a(t,void 0,f):t["@value"]?new a(t["@value"],t["@language"],f):null},Object.defineProperty(a.prototype,"value",{get:function(){return Array.isArray(this._value)?this._value.join("<br/>"):this._value},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"locale",{get:function(){return this._locale===void 0?this._defaultLocale:this._locale},enumerable:!0,configurable:!0}),a.prototype.addValue=function(t){Array.isArray(this._value)||(this._value=[this._value]),Array.isArray(t)?this._value=this._value.concat(t):this._value.push(t)},a}();n.LocalizedValue=m;var I=function(a){function t(f,d){f===void 0&&(f=[]);var E=a.apply(this,f)||this;return E.__proto__=t.prototype,E._defaultLocale=d,E}return A(t,a),t.parse=function(f,d){if(!f)return new t([],d);if(Array.isArray(f)){var E=(R=f.map(function(P){return m.parseV2Value(P,d)}).filter(function(P){return P!==null})).reduce(function(P,j){var D=j._locale;return D||(D="none"),P[D]?P[D].addValue(j._value):P[D]=j,P},{});return new t(Object.values(E),d)}return typeof f=="string"?new t([new m(f,void 0,d)],d):f["@language"]?new t((R=m.parseV2Value(f))!==null?[R]:[],d):f["@value"]?new t((R=m.parseV2Value(f))!==null?[R]:[],d):new t(Object.keys(f).map(function(P){var j=f[P];if(!Array.isArray(j))throw new Error("A IIIF v3 localized property value must have an array as the value for a given language.");return new m(j,P,d)}),d);var R},t.prototype.getSuitableLocale=function(f){for(var d=y(this).map(function(Y){return Y._locale}).filter(function(Y){return Y!==void 0}),E=function(Y){var W=d.find(function(oe){return oe===Y});if(W)return{value:W}},R=0,P=f;R<P.length;R++){var j=E(P[R]);if(typeof j=="object")return j.value}for(var D=function(Y){var W=d.find(function(oe){return h.Utils.getInexactLocale(oe)===h.Utils.getInexactLocale(Y)});if(W)return{value:W}},G=0,V=f;G<V.length;G++){var K=D(V[G]);if(typeof K=="object")return K.value}},t.prototype.setValue=function(f,d){var E=void 0;if(d){var R=this.getSuitableLocale([d]);R&&(E=this.find(function(P){return P._locale===R}))}else E=this.find(function(P){return P._locale===void 0});E?E._value=f:this.push(new m(f,d,this._defaultLocale))},t.prototype.getValue=function(f,d){var E=this.getValues(f);return E.length===0?null:d?E.join(d):E[0]},t.prototype.getValues=function(f){if(!this.length)return[];var d;if(d=f?Array.isArray(f)?f:[f]:[],this.length===1&&this[0]._locale===void 0){var E=this[0]._value;return Array.isArray(E)?E:[E]}var R=this.getSuitableLocale(d);if(R)return E=this.find(function(j){return j._locale===R})._value,Array.isArray(E)?E:[E];if(!this.find(function(j){return j._locale===void 0}))return E=this[0]._value,Array.isArray(E)?E:[E];var P=this.find(function(j){return j._locale===void 0});return P?Array.isArray(P._value)?P._value:[P._value]:[]},t}(Array);n.PropertyValue=I},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.CONTINUE=100,n.SWITCHING_PROTOCOLS=101,n.PROCESSING=102,n.OK=200,n.CREATED=201,n.ACCEPTED=202,n.NON_AUTHORITATIVE_INFORMATION=203,n.NO_CONTENT=204,n.RESET_CONTENT=205,n.PARTIAL_CONTENT=206,n.MULTI_STATUS=207,n.MULTIPLE_CHOICES=300,n.MOVED_PERMANENTLY=301,n.MOVED_TEMPORARILY=302,n.SEE_OTHER=303,n.NOT_MODIFIED=304,n.USE_PROXY=305,n.TEMPORARY_REDIRECT=307,n.BAD_REQUEST=400,n.UNAUTHORIZED=401,n.PAYMENT_REQUIRED=402,n.FORBIDDEN=403,n.NOT_FOUND=404,n.METHOD_NOT_ALLOWED=405,n.NOT_ACCEPTABLE=406,n.PROXY_AUTHENTICATION_REQUIRED=407,n.REQUEST_TIME_OUT=408,n.CONFLICT=409,n.GONE=410,n.LENGTH_REQUIRED=411,n.PRECONDITION_FAILED=412,n.REQUEST_ENTITY_TOO_LARGE=413,n.REQUEST_URI_TOO_LARGE=414,n.UNSUPPORTED_MEDIA_TYPE=415,n.REQUESTED_RANGE_NOT_SATISFIABLE=416,n.EXPECTATION_FAILED=417,n.IM_A_TEAPOT=418,n.UNPROCESSABLE_ENTITY=422,n.LOCKED=423,n.FAILED_DEPENDENCY=424,n.UNORDERED_COLLECTION=425,n.UPGRADE_REQUIRED=426,n.PRECONDITION_REQUIRED=428,n.TOO_MANY_REQUESTS=429,n.REQUEST_HEADER_FIELDS_TOO_LARGE=431,n.INTERNAL_SERVER_ERROR=500,n.NOT_IMPLEMENTED=501,n.BAD_GATEWAY=502,n.SERVICE_UNAVAILABLE=503,n.GATEWAY_TIME_OUT=504,n.HTTP_VERSION_NOT_SUPPORTED=505,n.VARIANT_ALSO_NEGOTIATES=506,n.INSUFFICIENT_STORAGE=507,n.BANDWIDTH_LIMIT_EXCEEDED=509,n.NOT_EXTENDED=510,n.NETWORK_AUTHENTICATION_REQUIRED=511},function(g,n,c){g.exports=window.fetch||(window.fetch=c(6).default||c(6))},function(g,n,c){var o,A=this&&this.__extends||(o=function(I,a){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,f){t.__proto__=f}||function(t,f){for(var d in f)f.hasOwnProperty(d)&&(t[d]=f[d])})(I,a)},function(I,a){function t(){this.constructor=I}o(I,a),I.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(1),h=c(0),m=function(I){function a(t,f){var d=I.call(this,t,f)||this;if(d.index=0,d._allRanges=null,d.items=[],d._topRanges=[],d.__jsonld.structures&&d.__jsonld.structures.length)for(var E=d._getTopRanges(),R=0;R<E.length;R++){var P=E[R];d._parseRanges(P,String(R))}return d}return A(a,I),a.prototype.getPosterCanvas=function(){var t=this.getProperty("posterCanvas");return t&&(t=new h.Canvas(t,this.options)),t},a.prototype.getAccompanyingCanvas=function(){var t=this.getProperty("accompanyingCanvas");return t&&(t=new h.Canvas(t,this.options)),t},a.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},a.prototype.getDefaultTree=function(){if(I.prototype.getDefaultTree.call(this),this.defaultTree.data.type=h.Utils.normaliseType(h.TreeNodeType.MANIFEST),!this.isLoaded)return this.defaultTree;var t=this.getTopRanges();return t.length&&t[0].getTree(this.defaultTree),h.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},a.prototype._getTopRanges=function(){var t=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var f=0;f<this.__jsonld.structures.length;f++){var d=this.__jsonld.structures[f];d.viewingHint===y.ViewingHint.TOP&&t.push(d)}if(!t.length){var E={};E.ranges=this.__jsonld.structures,t.push(E)}}return t},a.prototype.getTopRanges=function(){return this._topRanges},a.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var f=0;f<this.__jsonld.structures.length;f++){var d=this.__jsonld.structures[f];if(d["@id"]===t||d.id===t)return d}return null},a.prototype._parseRanges=function(t,f,d){var E,R=null;if(typeof t=="string"&&(R=t,t=this._getRangeById(R)),t){(E=new h.Range(t,this.options)).parentRange=d,E.path=f,d?d.items.push(E):this._topRanges.push(E);var P=t.items||t.members;if(P)for(var j=0;j<P.length;j++){var D=P[j];if(D["@type"]&&D["@type"].toLowerCase()==="sc:range"||D.type&&D.type.toLowerCase()==="range")this._parseRanges(D,f+"/"+j,E);else if(D["@type"]&&D["@type"].toLowerCase()==="sc:canvas"||D.type&&D.type.toLowerCase()==="canvas"){E.canvases||(E.canvases=[]);var G=D.id||D["@id"];E.canvases.push(G)}}else if(t.ranges)for(j=0;j<t.ranges.length;j++)this._parseRanges(t.ranges[j],f+"/"+j,E)}else console.warn("Range:",R,"does not exist")},a.prototype.getAllRanges=function(){if(this._allRanges!=null)return this._allRanges;this._allRanges=[];for(var t=this.getTopRanges(),f=function(R){var P=t[R];P.id&&d._allRanges.push(P);var j=function(G,V){G.add(V);var K=V.getRanges();return K.length?K.reduce(j,G):G},D=Array.from(P.getRanges().reduce(j,new Set));d._allRanges=d._allRanges.concat(D)},d=this,E=0;E<t.length;E++)f(E);return this._allRanges},a.prototype.getRangeById=function(t){for(var f=this.getAllRanges(),d=0;d<f.length;d++){var E=f[d];if(E.id===t)return E}return null},a.prototype.getRangeByPath=function(t){for(var f=this.getAllRanges(),d=0;d<f.length;d++){var E=f[d];if(E.path===t)return E}return null},a.prototype.getSequences=function(){if(this.items.length)return this.items;var t=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(t)for(var f=0;f<t.length;f++){var d=t[f],E=new h.Sequence(d,this.options);this.items.push(E)}else this.__jsonld.items&&(E=new h.Sequence(this.__jsonld.items,this.options),this.items.push(E));return this.items},a.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},a.prototype.getTotalSequences=function(){return this.getSequences().length},a.prototype.getManifestType=function(){var t=this.getService(y.ServiceProfile.UI_EXTENSIONS);return t?t.getProperty("manifestType"):h.ManifestType.EMPTY},a.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},a.prototype.isPagingEnabled=function(){var t=this.getViewingHint();if(t)return t===y.ViewingHint.PAGED;var f=this.getBehavior();return!!f&&f===y.Behavior.PAGED},a.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},a.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},a}(h.IIIFResource);n.Manifest=m},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),function(o){o.EMPTY="",o.MANUSCRIPT="manuscript",o.MONOGRAPH="monograph"}(n.ManifestType||(n.ManifestType={}))},function(g,n,c){var o,A=this&&this.__extends||(o=function(I,a){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,f){t.__proto__=f}||function(t,f){for(var d in f)f.hasOwnProperty(d)&&(t[d]=f[d])})(I,a)},function(I,a){function t(){this.constructor=I}o(I,a),I.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=c(1),m=function(I){function a(t,f){var d=I.call(this,t,f)||this;return d._ranges=null,d.canvases=null,d.items=[],d}return A(a,I),a.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},a.prototype.getDuration=function(){if(this.canvases&&this.canvases.length){for(var t=[],f=[],d=0,E=this.canvases;d<E.length;d++)if(oe=E[d]){var R=oe.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/)||[void 0,oe],P=R[1],j=R[2],D=R[3];P&&(t.push(parseFloat(j)),f.push(parseFloat(D)))}if(t.length&&f.length)return new y.Duration(Math.min.apply(Math,t),Math.max.apply(Math,f))}else{t=[],f=[];for(var G=0,V=Oe=this.getRanges();G<V.length;G++)($e=V[G].getDuration())&&(t.push($e.start),f.push($e.end));if(t.length&&f.length)return new y.Duration(Math.min.apply(Math,t),Math.max.apply(Math,f))}var K,Y;if(this.canvases&&this.canvases.length)for(var W=0;W<this.canvases.length;W++){var oe=this.canvases[W],Pe=y.Utils.getTemporalComponent(oe);Pe&&Pe.length>1&&(W===0&&(K=Number(Pe[0])),W===this.canvases.length-1&&(Y=Number(Pe[1])))}else{var Oe=this.getRanges();for(W=0;W<Oe.length;W++){var $e;($e=Oe[W].getDuration())&&(W===0&&(K=$e.start),W===Oe.length-1&&(Y=$e.end))}}if(K!==void 0&&Y!==void 0)return new y.Duration(K,Y)},a.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(t){return t.isRange()})},a.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},a.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},a.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},a.prototype.getTree=function(t){t.data=this,this.treeNode=t;var f=this.getRanges();if(f&&f.length)for(var d=0;d<f.length;d++){var E=f[d],R=new y.TreeNode;t.addNode(R),this._parseTreeNode(R,E)}return y.Utils.generateTreeNodeIds(t),t},a.prototype.spansTime=function(t){var f=this.getDuration();return!!(f&&t>=f.start&&t<=f.end)},a.prototype._parseTreeNode=function(t,f){t.label=f.getLabel().getValue(this.options.locale),t.data=f,t.data.type=y.Utils.normaliseType(y.TreeNodeType.RANGE),f.treeNode=t;var d=f.getRanges();if(d&&d.length)for(var E=0;E<d.length;E++){var R=d[E];if(R.getBehavior()!==h.Behavior.NO_NAV){var P=new y.TreeNode;t.addNode(P),this._parseTreeNode(P,R)}}},a}(y.ManifestResource);n.Range=m},function(g,n,c){var o,A=this&&this.__extends||(o=function(h,m){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,a){I.__proto__=a}||function(I,a){for(var t in a)a.hasOwnProperty(t)&&(I[t]=a[t])})(h,m)},function(h,m){function I(){this.constructor=h}o(h,m),h.prototype=m===null?Object.create(m):(I.prototype=m.prototype,new I)});Object.defineProperty(n,"__esModule",{value:!0});var y=function(h){function m(I,a){return h.call(this,I,a)||this}return A(m,h),m.prototype.getFormat=function(){return this.getProperty("format")},m}(c(0).ManifestResource);n.Rendering=y},function(g,n,c){var o,A=this&&this.__extends||(o=function(I,a){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,f){t.__proto__=f}||function(t,f){for(var d in f)f.hasOwnProperty(d)&&(t[d]=f[d])})(I,a)},function(I,a){function t(){this.constructor=I}o(I,a),I.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(1),h=c(0),m=function(I){function a(t,f){var d=I.call(this,t,f)||this;return d.items=[],d._thumbnails=null,d}return A(a,I),a.prototype.getCanvases=function(){if(this.items.length)return this.items;var t=this.__jsonld.canvases||this.__jsonld.elements;if(t)for(var f=0;f<t.length;f++){var d=t[f];(E=new h.Canvas(d,this.options)).index=f,this.items.push(E)}else if(this.__jsonld)for(f=0;f<this.__jsonld.length;f++){var E;d=this.__jsonld[f],(E=new h.Canvas(d,this.options)).index=f,this.items.push(E)}return this.items},a.prototype.getCanvasById=function(t){for(var f=0;f<this.getTotalCanvases();f++){var d=this.getCanvasByIndex(f),E=h.Utils.normaliseUrl(d.id);if(h.Utils.normaliseUrl(t)===E)return d}return null},a.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},a.prototype.getCanvasIndexById=function(t){for(var f=0;f<this.getTotalCanvases();f++)if(this.getCanvasByIndex(f).id===t)return f;return null},a.prototype.getCanvasIndexByLabel=function(t,f){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),f&&(t+="r"));for(var d,E,R,P=/(\d*)\D+(\d*)/,j=0;j<this.getTotalCanvases();j++){var D=this.getCanvasByIndex(j);if(D.getLabel().getValue(this.options.locale)===t||(d=P.exec(t))&&(E=d[1],(R=d[2])&&new RegExp("^"+E+"\\D+"+R+"$").test(D.getLabel().toString())))return j}return-1},a.prototype.getLastCanvasLabel=function(t){for(var f=this.getTotalCanvases()-1;f>=0;f--){var d=this.getCanvasByIndex(f).getLabel().getValue(this.options.locale);if(t){if(/^[a-zA-Z0-9]*$/.test(d))return d}else if(d)return d}return this.options.defaultLabel},a.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},a.prototype.getNextPageIndex=function(t,f){var d;if(f){var E=this.getPagedIndices(t),R=this.getViewingDirection();d=R&&R===y.ViewingDirection.RIGHT_TO_LEFT?E[0]+1:E[E.length-1]+1}else d=t+1;return d>this.getLastPageIndex()?-1:d},a.prototype.getPagedIndices=function(t,f){var d=[];if(f){d=this.isFirstCanvas(t)||this.isLastCanvas(t)?[t]:t%2?[t,t+1]:[t-1,t];var E=this.getViewingDirection();E&&E===y.ViewingDirection.RIGHT_TO_LEFT&&(d=d.reverse())}else d.push(t);return d},a.prototype.getPrevPageIndex=function(t,f){var d;if(f){var E=this.getPagedIndices(t),R=this.getViewingDirection();d=R&&R===y.ViewingDirection.RIGHT_TO_LEFT?E[E.length-1]-1:E[0]-1}else d=t-1;return d},a.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t){for(var f=0;f<this.getTotalCanvases();f++)if(this.getCanvasByIndex(f).id===t)return f}return 0},a.prototype.getThumbs=function(t,f){for(var d=[],E=this.getTotalCanvases(),R=0;R<E;R++){var P=this.getCanvasByIndex(R),j=new h.Thumb(t,P);d.push(j)}return d},a.prototype.getThumbnails=function(){if(this._thumbnails!=null)return this._thumbnails;this._thumbnails=[];for(var t=this.getCanvases(),f=0;f<t.length;f++){var d=t[f].getThumbnail();d&&this._thumbnails.push(d)}return this._thumbnails},a.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},a.prototype.getTotalCanvases=function(){return this.getCanvases().length},a.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},a.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},a.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},a.prototype.isFirstCanvas=function(t){return t===0},a.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},a.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},a.prototype.isPagingEnabled=function(){var t=this.getViewingHint();return!!t&&t===y.ViewingHint.PAGED},a.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},a}(h.ManifestResource);n.Sequence=m},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=c(0),A=function(){function y(){}return y.parse=function(h,m){return typeof h=="string"&&(h=JSON.parse(h)),this.parseJson(h,m)},y.parseJson=function(h,m){var I;if(m&&m.navDate&&!isNaN(m.navDate.getTime())&&(h.navDate=m.navDate.toString()),h["@type"])switch(h["@type"]){case"sc:Collection":I=this.parseCollection(h,m);break;case"sc:Manifest":I=this.parseManifest(h,m);break;default:return null}else switch(h.type){case"Collection":I=this.parseCollection(h,m);break;case"Manifest":I=this.parseManifest(h,m);break;default:return null}return I.isLoaded=!0,I},y.parseCollection=function(h,m){var I=new o.Collection(h,m);return m?(I.index=m.index||0,m.resource&&(I.parentCollection=m.resource.parentCollection)):I.index=0,this.parseCollections(I,m),this.parseManifests(I,m),this.parseItems(I,m),I},y.parseCollections=function(h,m){var I;if(h.__jsonld.collections?I=h.__jsonld.collections:h.__jsonld.items&&(I=h.__jsonld.items.filter(function(f){return f.type.toLowerCase()==="collection"})),I)for(var a=0;a<I.length;a++){m&&(m.index=a);var t=this.parseCollection(I[a],m);t.index=a,t.parentCollection=h,h.items.push(t)}},y.parseManifest=function(h,m){return new o.Manifest(h,m)},y.parseManifests=function(h,m){var I;if(h.__jsonld.manifests?I=h.__jsonld.manifests:h.__jsonld.items&&(I=h.__jsonld.items.filter(function(f){return f.type.toLowerCase()==="manifest"})),I)for(var a=0;a<I.length;a++){var t=this.parseManifest(I[a],m);t.index=a,t.parentCollection=h,h.items.push(t)}},y.parseItem=function(h,m){if(h["@type"]){if(h["@type"].toLowerCase()==="sc:manifest")return this.parseManifest(h,m);if(h["@type"].toLowerCase()==="sc:collection")return this.parseCollection(h,m)}else if(h.type){if(h.type.toLowerCase()==="manifest")return this.parseManifest(h,m);if(h.type.toLowerCase()==="collection")return this.parseCollection(h,m)}return null},y.parseItems=function(h,m){var I=h.__jsonld.members||h.__jsonld.items;if(I)for(var a=function(E){m&&(m.index=E);var R=t.parseItem(I[E],m);return R?h.items.filter(function(P){return P.id===R.id})[0]?"continue":(R.index=E,R.parentCollection=h,void h.items.push(R)):{value:void 0}},t=this,f=0;f<I.length;f++){var d=a(f);if(typeof d=="object")return d.value}},y}();n.Deserialiser=A},function(g,n,c){var o,A=this&&this.__extends||(o=function(m,I){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var f in t)t.hasOwnProperty(f)&&(a[f]=t[f])})(m,I)},function(m,I){function a(){this.constructor=m}o(m,I),m.prototype=I===null?Object.create(I):(a.prototype=I.prototype,new a)});Object.defineProperty(n,"__esModule",{value:!0});var y=c(0),h=function(m){function I(a,t){return m.call(this,a,t)||this}return A(I,m),I.prototype.getProfile=function(){var a=this.getProperty("profile");return a||(a=this.getProperty("dcterms:conformsTo")),Array.isArray(a)?a[0]:a},I.prototype.getConfirmLabel=function(){return y.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},I.prototype.getDescription=function(){return y.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},I.prototype.getFailureDescription=function(){return y.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},I.prototype.getFailureHeader=function(){return y.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},I.prototype.getHeader=function(){return y.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},I.prototype.getServiceLabel=function(){return y.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},I.prototype.getInfoUri=function(){var a=this.id;return a.endsWith("/")||(a+="/"),a+="info.json"},I}(y.ManifestResource);n.Service=h},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=function(A,y){this.width=A,this.height=y};n.Size=o},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),function(o){o[o.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",o[o.FORBIDDEN=2]="FORBIDDEN",o[o.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",o[o.RESTRICTED=4]="RESTRICTED"}(n.StatusCode||(n.StatusCode={}))},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=function(A,y){this.data=y,this.index=y.index,this.width=A;var h=y.getHeight()/y.getWidth();this.height=h?Math.floor(this.width*h):A,this.uri=y.getCanonicalImageUri(A),this.label=y.getLabel().getValue(),this.viewingHint=y.getViewingHint()};n.Thumb=o},function(g,n,c){var o,A=this&&this.__extends||(o=function(h,m){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,a){I.__proto__=a}||function(I,a){for(var t in a)a.hasOwnProperty(t)&&(I[t]=a[t])})(h,m)},function(h,m){function I(){this.constructor=h}o(h,m),h.prototype=m===null?Object.create(m):(I.prototype=m.prototype,new I)});Object.defineProperty(n,"__esModule",{value:!0});var y=function(h){function m(I,a){return h.call(this,I,a)||this}return A(m,h),m}(c(0).Resource);n.Thumbnail=y},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0});var o=c(0),A=function(){function y(h,m){this.label=h,this.data=m||{},this.nodes=[]}return y.prototype.addNode=function(h){this.nodes.push(h),h.parentNode=this},y.prototype.isCollection=function(){return this.data.type===o.Utils.normaliseType(o.TreeNodeType.COLLECTION)},y.prototype.isManifest=function(){return this.data.type===o.Utils.normaliseType(o.TreeNodeType.MANIFEST)},y.prototype.isRange=function(){return this.data.type===o.Utils.normaliseType(o.TreeNodeType.RANGE)},y}();n.TreeNode=A},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),function(o){o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range"}(n.TreeNodeType||(n.TreeNodeType={}))}])})}),Wr=Kt((_,s)=>{(function(g,n){typeof _=="object"&&typeof s=="object"?s.exports=n():typeof define=="function"&&define.amd?define("httpstatuscodes",[],n):typeof _=="object"?_.httpstatuscodes=n():g.httpstatuscodes=n()})(window,function(){return function(g){var n={};function c(o){if(n[o])return n[o].exports;var A=n[o]={i:o,l:!1,exports:{}};return g[o].call(A.exports,A,A.exports,c),A.l=!0,A.exports}return c.m=g,c.c=n,c.d=function(o,A,y){c.o(o,A)||Object.defineProperty(o,A,{enumerable:!0,get:y})},c.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},c.t=function(o,A){if(1&A&&(o=c(o)),8&A||4&A&&typeof o=="object"&&o&&o.__esModule)return o;var y=Object.create(null);if(c.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:o}),2&A&&typeof o!="string")for(var h in o)c.d(y,h,function(m){return o[m]}.bind(null,h));return y},c.n=function(o){var A=o&&o.__esModule?function(){return o.default}:function(){return o};return c.d(A,"a",A),A},c.o=function(o,A){return Object.prototype.hasOwnProperty.call(o,A)},c.p="",c(c.s=0)}([function(g,n,c){g.exports=c(1)},function(g,n,c){Object.defineProperty(n,"__esModule",{value:!0}),n.CONTINUE=100,n.SWITCHING_PROTOCOLS=101,n.PROCESSING=102,n.OK=200,n.CREATED=201,n.ACCEPTED=202,n.NON_AUTHORITATIVE_INFORMATION=203,n.NO_CONTENT=204,n.RESET_CONTENT=205,n.PARTIAL_CONTENT=206,n.MULTI_STATUS=207,n.MULTIPLE_CHOICES=300,n.MOVED_PERMANENTLY=301,n.MOVED_TEMPORARILY=302,n.SEE_OTHER=303,n.NOT_MODIFIED=304,n.USE_PROXY=305,n.TEMPORARY_REDIRECT=307,n.BAD_REQUEST=400,n.UNAUTHORIZED=401,n.PAYMENT_REQUIRED=402,n.FORBIDDEN=403,n.NOT_FOUND=404,n.METHOD_NOT_ALLOWED=405,n.NOT_ACCEPTABLE=406,n.PROXY_AUTHENTICATION_REQUIRED=407,n.REQUEST_TIME_OUT=408,n.CONFLICT=409,n.GONE=410,n.LENGTH_REQUIRED=411,n.PRECONDITION_FAILED=412,n.REQUEST_ENTITY_TOO_LARGE=413,n.REQUEST_URI_TOO_LARGE=414,n.UNSUPPORTED_MEDIA_TYPE=415,n.REQUESTED_RANGE_NOT_SATISFIABLE=416,n.EXPECTATION_FAILED=417,n.IM_A_TEAPOT=418,n.UNPROCESSABLE_ENTITY=422,n.LOCKED=423,n.FAILED_DEPENDENCY=424,n.UNORDERED_COLLECTION=425,n.UPGRADE_REQUIRED=426,n.PRECONDITION_REQUIRED=428,n.TOO_MANY_REQUESTS=429,n.REQUEST_HEADER_FIELDS_TOO_LARGE=431,n.INTERNAL_SERVER_ERROR=500,n.NOT_IMPLEMENTED=501,n.BAD_GATEWAY=502,n.SERVICE_UNAVAILABLE=503,n.GATEWAY_TIME_OUT=504,n.HTTP_VERSION_NOT_SUPPORTED=505,n.VARIANT_ALSO_NEGOTIATES=506,n.INSUFFICIENT_STORAGE=507,n.BANDWIDTH_LIMIT_EXCEEDED=509,n.NOT_EXTENDED=510,n.NETWORK_AUTHENTICATION_REQUIRED=511}])})}),Kr=function(){function _(s){this.isVisible=!0;var g=s.target.match(/.*[^n]xyz=(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?)/),n=s.target.match(/.*nxyz=(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?)/);this.bodyValue=s.bodyValue,this.x=Number(g[1]),this.y=Number(g[2]),this.z=Number(g[3]),this.nx=Number(n[1]),this.ny=Number(n[2]),this.nz=Number(n[3])}return _}(),Xr=function(){function _(s){this.isVisible=!0;var g;s.on?(g=s.on.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/),this.chars=s.resource.chars):(g=s.target.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/),this.chars=s.bodyValue),this.x=Number(g[1]),this.y=Number(g[2]),this.width=Number(g[3]),this.height=Number(g[4])}return _}(),ro=function(){function _(s){this.rects=[],this.points3D=[],this.canvasId=s}return _.prototype.addRect=function(s){var g=new Xr(s);g.canvasId=this.canvasId,g.canvasIndex=this.canvasIndex,g.index=this.rects.length,this.rects.push(g),this.rects.sort(function(n,c){return n.index-c.index})},_.prototype.addPoint3D=function(s){var g=new Kr(s);g.canvasId=this.canvasId,g.canvasIndex=this.canvasIndex,g.index=this.points3D.length,this.points3D.push(g),this.points3D.sort(function(n,c){return n.index-c.index})},_}(),Hi=it(Jt()),Jr=function(){function _(){this.isEnabled=!1,this.ranges=[],this.canvases=[]}return _.prototype.allCanvasesSelected=function(){return this.canvases.length>0&&this.getAllSelectedCanvases().length===this.canvases.length},_.prototype.allRangesSelected=function(){return this.ranges.length>0&&this.getAllSelectedRanges().length===this.ranges.length},_.prototype.allSelected=function(){return this.allRangesSelected()&&this.allCanvasesSelected()},_.prototype.getAll=function(){return this.canvases.concat(this.ranges)},_.prototype.getAllSelectedCanvases=function(){return this.canvases.filter(function(s){return s.multiSelected})},_.prototype.getAllSelectedRanges=function(){return this.ranges.filter(function(s){return s.multiSelected})},_.prototype.getCanvasById=function(s){return this.canvases.filter(function(g){return Hi.Utils.normaliseUrl(g.id)===Hi.Utils.normaliseUrl(s)})[0]},_.prototype.getCanvasesByIds=function(s){for(var g=[],n=0;n<s.length;n++){var c=s[n];g.push(this.getCanvasById(c))}return g},_.prototype.getRangeCanvases=function(s){var g=s.getCanvasIds();return this.getCanvasesByIds(g)},_.prototype.selectAll=function(s){this.selectRanges(this.ranges,s),this.selectCanvases(this.canvases,s)},_.prototype.selectCanvas=function(s,g){var n=this.canvases.filter(function(c){return c.id===s.id})[0];n.multiSelected=g},_.prototype.selectAllCanvases=function(s){this.selectCanvases(this.canvases,s)},_.prototype.selectCanvases=function(s,g){for(var n=0;n<s.length;n++){var c=s[n];c.multiSelected=g}},_.prototype.selectRange=function(s,g){var n=this.ranges.filter(function(o){return o.id===s.id})[0];n.multiSelected=g;var c=this.getRangeCanvases(n);this.selectCanvases(c,g)},_.prototype.selectAllRanges=function(s){this.selectRanges(this.ranges,s)},_.prototype.selectRanges=function(s,g){for(var n=0;n<s.length;n++){var c=s[n];c.multiSelected=g;var o=this.getCanvasesByIds(c.getCanvasIds());this.selectCanvases(o,g)}},_.prototype.setEnabled=function(s){this.isEnabled=s;for(var g=this.getAll(),n=0;n<g.length;n++){var c=g[n];c.multiSelectEnabled=this.isEnabled,s||(c.multiSelected=!1)}},_}(),Pt=function(){function _(s,g){this.items=[],this.resource=s,this.label=g}return _.prototype.addItem=function(s){this.items.push(s)},_.prototype.addMetadata=function(s,g){g===void 0&&(g=!1);for(var n=0;n<s.length;n++){var c=s[n];c.isRootLevel=g,this.addItem(c)}},_}(),Wt;(function(_){_.DATE="date",_.NONE="none"})(Wt||(Wt={}));var Be=it(Xt()),_e=function(){function _(){}return _.manifestNotLoaded="Manifest has not loaded yet",_}(),Le=it(Jt()),lt=function(){return lt=Object.assign||function(_){for(var s,g=1,n=arguments.length;g<n;g++){s=arguments[g];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(_[c]=s[c])}return _},lt.apply(this,arguments)},wn=function(){function _(s){if(this.options=s,this.iiifResource=this.options.iiifResource,this.manifestUri=this.options.manifestUri,this.manifest=this.options.manifest,this.collectionIndex=this.options.collectionIndex||0,this.manifestIndex=this.options.manifestIndex||0,this.sequenceIndex=this.options.sequenceIndex||0,this.canvasIndex=this.options.canvasIndex||0,this.options.canvasId){var g=this.getCanvasIndexById(this.options.canvasId);g!==null&&(this.canvasIndex=g)}}return _.prototype.getAutoCompleteService=function(){var s=this.getSearchService(),g=null;return s&&(g=s.getService(Be.ServiceProfile.SEARCH_0_AUTO_COMPLETE),g||(g=s.getService(Be.ServiceProfile.SEARCH_1_AUTO_COMPLETE))),g},_.prototype.getAttribution=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.manifest.getAttribution();return s?s.getValue(this.options.locale):null},_.prototype.getCanvases=function(){return this.getCurrentSequence().getCanvases()},_.prototype.getCanvasById=function(s){return this.getCurrentSequence().getCanvasById(s)},_.prototype.getCanvasesById=function(s){for(var g=[],n=0;n<s.length;n++){var c=s[n],o=this.getCanvasById(c);o&&g.push(o)}return g},_.prototype.getCanvasByIndex=function(s){return this.getCurrentSequence().getCanvasByIndex(s)},_.prototype.getCanvasIndexById=function(s){return this.getCurrentSequence().getCanvasIndexById(s)},_.prototype.getCanvasIndexByLabel=function(s){var g=this.getManifestType()===Le.ManifestType.MANUSCRIPT;return this.getCurrentSequence().getCanvasIndexByLabel(s,g)},_.prototype.getCanvasRange=function(s,g){var n=this.getCanvasRanges(s);if(g){for(var c=0;c<n.length;c++){var o=n[c];if(o.path===g)return o}return null}else return n[0]},_.prototype.getCanvasRanges=function(s){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return s.ranges||(s.ranges=this.manifest.getAllRanges().filter(function(g){return g.getCanvasIds().some(function(n){return Le.Utils.normaliseUrl(n)===Le.Utils.normaliseUrl(s.id)})})),s.ranges},_.prototype.getCollectionIndex=function(s){if(!(s.parentCollection&&!s.parentCollection.parentCollection)&&s.parentCollection)return s.parentCollection.index},_.prototype.getCurrentCanvas=function(){return this.getCurrentSequence().getCanvasByIndex(this.canvasIndex)},_.prototype.getCurrentSequence=function(){return this.getSequenceByIndex(this.sequenceIndex)},_.prototype.getDescription=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.manifest.getDescription();return s?s.getValue(this.options.locale):null},_.prototype.getLabel=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.manifest.getLabel();return s?s.getValue(this.options.locale):null},_.prototype.getLastCanvasLabel=function(s){return this.getCurrentSequence().getLastCanvasLabel(s)},_.prototype.getFirstPageIndex=function(){return 0},_.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},_.prototype.getLicense=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getLicense()},_.prototype.getLogo=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getLogo()},_.prototype.getManifestType=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.manifest.getManifestType();return s===Le.ManifestType.EMPTY&&(s=Le.ManifestType.MONOGRAPH),s},_.prototype.getMetadata=function(s){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var g=[],n=this.manifest.getMetadata(),c=new Pt(this.manifest),o=this.options.locale;if(n&&n.length&&c.addMetadata(n,!0),this.manifest.getDescription().length){var A=new Le.LabelValuePair(o);A.label=new Le.PropertyValue([new Le.LocalizedValue("description",o)]),A.value=this.manifest.getDescription(),A.isRootLevel=!0,c.addItem(A)}if(this.manifest.getAttribution().length){var A=new Le.LabelValuePair(o);A.label=new Le.PropertyValue([new Le.LocalizedValue("attribution",o)]),A.value=this.manifest.getAttribution(),A.isRootLevel=!0,c.addItem(A)}var y=this.manifest.getLicense();if(y){var h={label:"license",value:s&&s.licenseFormatter?s.licenseFormatter.format(y):y},A=new Le.LabelValuePair(o);A.parse(h),A.isRootLevel=!0,c.addItem(A)}if(this.manifest.getLogo()){var h={label:"logo",value:'<img alt="logo" src="'+this.manifest.getLogo()+'"/>'},A=new Le.LabelValuePair(o);A.parse(h),A.isRootLevel=!0,c.addItem(A)}return g.push(c),s?this._parseMetadataOptions(s,g):g},_.prototype.getAllRequiredStatements=function(){var s=[],g=this.getCurrentRange();if(g){var n=g.getRequiredStatement?g.getRequiredStatement():null;n&&s.push(lt(lt({},this.parseStatement(n)),{source:"Range"}))}var c=this.getCurrentCanvas();if(c){var o=c.getRequiredStatement?c.getRequiredStatement():null;o&&s.push(lt(lt({},this.parseStatement(o)),{source:"Canvas"}))}if(this.manifest){var A=this.manifest.getRequiredStatement();A&&A&&s.push(lt(lt({},this.parseStatement(A)),{source:"Manifest"}))}return s},_.prototype.getMostSpecificRequiredStatement=function(){var s=this.getAllRequiredStatements(),g=s.find(function(o){return o.source==="Range"});if(g)return g;var n=s.find(function(o){return o.source==="Canvas"});if(n)return n;var c=s.find(function(o){return o.source==="Manifest"});return c||null},_.prototype.getRequiredStatement=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.manifest.getRequiredStatement();return s?this.parseStatement(s):null},_.prototype.parseStatement=function(s){return{label:s.label?s.getLabel():"",value:s.value&&s.value.length?s.getValue():""}},_.prototype._parseMetadataOptions=function(s,g){var n=this.getCurrentSequence(),c=n.getMetadata();if(c&&c.length){var o=new Pt(n);o.addMetadata(c),g.push(o)}if(s.range){var A=this._getRangeMetadata([],s.range);A=A.reverse(),g=g.concat(A)}if(s.canvases&&s.canvases.length)for(var y=0;y<s.canvases.length;y++){var h=s.canvases[y],m=h.getMetadata();if(m&&m.length){var I=new Pt(h);I.addMetadata(h.getMetadata()),g.push(I)}for(var a=h.getImages(),t=0;t<a.length;t++){var f=a[t],d=f.getMetadata();if(d&&d.length){var E=new Pt(f);E.addMetadata(d),g.push(E)}}}return g},_.prototype._getRangeMetadata=function(s,g){var n=g.getMetadata();if(n&&n.length){var c=new Pt(g);c.addMetadata(n),s.push(c)}else if(g.parentRange)return this._getRangeMetadata(s,g.parentRange);return s},_.prototype.getMultiSelectState=function(){return this._multiSelectState||(this._multiSelectState=new Jr,this._multiSelectState.ranges=this.getRanges().slice(0),this._multiSelectState.canvases=this.getCurrentSequence().getCanvases().slice(0)),this._multiSelectState},_.prototype.getCurrentRange=function(){return this.rangeId?this.getRangeById(this.rangeId):null},_.prototype.getPosterCanvas=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getPosterCanvas()},_.prototype.getAccompanyingCanvas=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getAccompanyingCanvas()},_.prototype.getPosterImage=function(){var s=this.getPosterCanvas();if(s){var g=s.getContent();if(g&&g.length){var n=g[0],c=n.getBody();return c[0].id}}return null},_.prototype.getAccompanyingCanvasImage=function(){var s=this.getAccompanyingCanvas();if(s){var g=s.getContent();if(g&&g.length){var n=g[0],c=n.getBody();return c[0].id}}return null},_.prototype.getPreviousRange=function(s){var g=null;if(s?g=s:g=this.getCurrentRange(),g){var n=this.getFlattenedTree();if(n)for(var c=0;c<n.length;c++){var o=n[c];if(o&&o.data.id===g.id){for(;c>0;){c--;var A=n[c];return A.data}break}}}return null},_.prototype.getNextRange=function(s){var g=null;if(s?g=s:g=this.getCurrentRange(),g){var n=this.getFlattenedTree();if(n)for(var c=0;c<n.length;c++){var o=n[c];if(o&&o.data.id===g.id){for(;c<n.length-1;){c++;var A=n[c];if(A.data.canvases&&A.data.canvases.length)return A.data}break}}}return null},_.prototype.getFlattenedTree=function(s){var g=null;return s?g=s:g=this.getTree(),g?this._flattenTree(g,"nodes"):null},_.prototype._flattenTree=function(s,g){var n=this,c=[s];return s[g]&&s[g].length>0?c.concat(s[g].map(function(o){return n._flattenTree(o,g)}).reduce(function(o,A){return o.concat(A)},[])):c},_.prototype.getRanges=function(){return this.manifest.getAllRanges()},_.prototype.getRangeByPath=function(s){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getRangeByPath(s)},_.prototype.getRangeById=function(s){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getRangeById(s)},_.prototype.getRangeCanvases=function(s){var g=s.getCanvasIds();return this.getCanvasesById(g)},_.prototype.getRelated=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getRelated()},_.prototype.getSearchService=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.manifest.getService(Be.ServiceProfile.SEARCH_0);return s||(s=this.manifest.getService(Be.ServiceProfile.SEARCH_1)),s},_.prototype.getSeeAlso=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getSeeAlso()},_.prototype.getSequenceByIndex=function(s){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getSequenceByIndex(s)},_.prototype.getShareServiceUrl=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=null,g=this.manifest.getService(Be.ServiceProfile.SHARE_EXTENSIONS);return g&&(g.length&&(g=g[0]),s=g.__jsonld.shareUrl),s},_.prototype._getSortedTreeNodesByDate=function(s,g){var n=this.getFlattenedTree(g);if(n){var c=n.filter(function(o){return o.data.type===Le.TreeNodeType.MANIFEST});this.createDecadeNodes(s,n),this.sortDecadeNodes(s),this.createYearNodes(s,n),this.sortYearNodes(s),this.createMonthNodes(s,c),this.sortMonthNodes(s),this.createDateNodes(s,c),this.pruneDecadeNodes(s)}},_.prototype.getStartCanvasIndex=function(){return this.getCurrentSequence().getStartCanvasIndex()},_.prototype.getThumbs=function(s,g){return this.getCurrentSequence().getThumbs(s,g)},_.prototype.getTopRanges=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getTopRanges()},_.prototype.getTotalCanvases=function(){return this.getCurrentSequence().getTotalCanvases()},_.prototype.getTrackingLabel=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.getTrackingLabel()},_.prototype._getTopRanges=function(){return this.iiifResource.getTopRanges()},_.prototype.getTree=function(s,g){if(s===void 0&&(s=0),g===void 0&&(g=Wt.NONE),!this.iiifResource)return null;var n;if(this.iiifResource.isCollection())n=this.iiifResource.getDefaultTree();else{var c=this._getTopRanges(),o=new Le.TreeNode;if(o.label="root",o.data=this.iiifResource,c.length){var A=c[s];n=A.getTree(o)}else return o}var y=new Le.TreeNode;switch(g.toString()){case Wt.DATE.toString():if(this.treeHasNavDates(n))return this._getSortedTreeNodesByDate(y,n),y;break}return n},_.prototype.treeHasNavDates=function(s){var g=this.getFlattenedTree(s);return g?g.some(function(n){return!isNaN(n.navDate)}):!1},_.prototype.getViewingDirection=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.getCurrentSequence().getViewingDirection();return s||(s=this.manifest.getViewingDirection()),s},_.prototype.getViewingHint=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.getCurrentSequence().getViewingHint();return s||(s=this.manifest.getViewingHint()),s},_.prototype.hasParentCollection=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return!!this.manifest.parentCollection},_.prototype.hasRelatedPage=function(){var s=this.getRelated();return s?(s.length&&(s=s[0]),s.format==="text/html"):!1},_.prototype.hasResources=function(){var s=this.getCurrentCanvas();return s.getResources().length>0},_.prototype.isBottomToTop=function(){var s=this.getViewingDirection();return s?s===Be.ViewingDirection.BOTTOM_TO_TOP:!1},_.prototype.isCanvasIndexOutOfRange=function(s){return this.getCurrentSequence().isCanvasIndexOutOfRange(s)},_.prototype.isContinuous=function(){var s=this.getViewingHint();return s?s===Be.ViewingHint.CONTINUOUS:!1},_.prototype.isFirstCanvas=function(s){return typeof s<"u"?this.getCurrentSequence().isFirstCanvas(s):this.getCurrentSequence().isFirstCanvas(this.canvasIndex)},_.prototype.isHorizontallyAligned=function(){return this.isLeftToRight()||this.isRightToLeft()},_.prototype.isLastCanvas=function(s){return typeof s<"u"?this.getCurrentSequence().isLastCanvas(s):this.getCurrentSequence().isLastCanvas(this.canvasIndex)},_.prototype.isLeftToRight=function(){var s=this.getViewingDirection();return s?s===Be.ViewingDirection.LEFT_TO_RIGHT:!1},_.prototype.isMultiCanvas=function(){return this.getCurrentSequence().isMultiCanvas()},_.prototype.isMultiSequence=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.isMultiSequence()},_.prototype.isPaged=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var s=this.getViewingHint();return s?s===Be.ViewingHint.PAGED:this.manifest.isPagingEnabled()},_.prototype.isPagingAvailable=function(){return this.isPagingEnabled()&&this.getTotalCanvases()>2},_.prototype.isPagingEnabled=function(){if(!this.manifest)throw new Error(_e.manifestNotLoaded);return this.manifest.isPagingEnabled()||this.getCurrentSequence().isPagingEnabled()},_.prototype.isRightToLeft=function(){var s=this.getViewingDirection();return s?s===Be.ViewingDirection.RIGHT_TO_LEFT:!1},_.prototype.isTopToBottom=function(){var s=this.getViewingDirection();return s?s===Be.ViewingDirection.TOP_TO_BOTTOM:!1},_.prototype.isTotalCanvasesEven=function(){return this.getCurrentSequence().isTotalCanvasesEven()},_.prototype.isUIEnabled=function(s){if(!this.manifest)throw new Error(_e.manifestNotLoaded);var g=this.manifest.getService(Be.ServiceProfile.UI_EXTENSIONS);if(g){var n=g.getProperty("disableUI");if(n&&(n.indexOf(s)!==-1||n.indexOf(s.toLowerCase())!==-1))return!1}return!0},_.prototype.isVerticallyAligned=function(){return this.isTopToBottom()||this.isBottomToTop()},_.prototype.createDateNodes=function(s,g){for(var n=0;n<g.length;n++){var c=g[n],o=this.getNodeYear(c),A=this.getNodeMonth(c),y=new Le.TreeNode;y.id=c.id,y.label=this.getNodeDisplayDate(c),y.data=c.data,y.data.type=Le.TreeNodeType.MANIFEST,y.data.year=o,y.data.month=A;var h=this.getDecadeNode(s,o);if(h){var m=this.getYearNode(h,o);if(m){var I=this.getMonthNode(m,A);I&&I.addNode(y)}}}},_.prototype.createDecadeNodes=function(s,g){for(var n=0;n<g.length;n++){var c=g[n];if(c.navDate){var o=this.getNodeYear(c),A=Number(o.toString().substr(0,3)+"9");if(!this.getDecadeNode(s,o)){var y=new Le.TreeNode;y.label=o+" - "+A,y.navDate=c.navDate,y.data.startYear=o,y.data.endYear=A,s.addNode(y)}}}},_.prototype.createMonthNodes=function(s,g){for(var n=0;n<g.length;n++){var c=g[n];if(c.navDate){var o=this.getNodeYear(c),A=this.getNodeMonth(c),y=this.getDecadeNode(s,o),h=null;if(y&&(h=this.getYearNode(y,o)),y&&h&&!this.getMonthNode(h,A)){var m=new Le.TreeNode;m.label=this.getNodeDisplayMonth(c),m.navDate=c.navDate,m.data.year=o,m.data.month=A,h.addNode(m)}}}},_.prototype.createYearNodes=function(s,g){for(var n=0;n<g.length;n++){var c=g[n];if(c.navDate){var o=this.getNodeYear(c),A=this.getDecadeNode(s,o);if(A&&!this.getYearNode(A,o)){var y=new Le.TreeNode;y.label=o.toString(),y.navDate=c.navDate,y.data.year=o,A.addNode(y)}}}},_.prototype.getDecadeNode=function(s,g){for(var n=0;n<s.nodes.length;n++){var c=s.nodes[n];if(g>=c.data.startYear&&g<=c.data.endYear)return c}return null},_.prototype.getMonthNode=function(s,g){for(var n=0;n<s.nodes.length;n++){var c=s.nodes[n];if(g===this.getNodeMonth(c))return c}return null},_.prototype.getNodeDisplayDate=function(s){return s.navDate.toDateString()},_.prototype.getNodeDisplayMonth=function(s){var g=["January","February","March","April","May","June","July","August","September","October","November","December"];return g[s.navDate.getMonth()]},_.prototype.getNodeMonth=function(s){return s.navDate.getMonth()},_.prototype.getNodeYear=function(s){return s.navDate.getFullYear()},_.prototype.getYearNode=function(s,g){for(var n=0;n<s.nodes.length;n++){var c=s.nodes[n];if(g===this.getNodeYear(c))return c}return null},_.prototype.pruneDecadeNodes=function(s){for(var g=[],n=0;n<s.nodes.length;n++){var c=s.nodes[n];c.nodes.length||g.push(c)}for(var o=0;o<g.length;o++){var A=g[o],y=s.nodes.indexOf(A);y>-1&&s.nodes.splice(y,1)}},_.prototype.sortDecadeNodes=function(s){s.nodes=s.nodes.sort(function(g,n){return g.data.startYear-n.data.startYear})},_.prototype.sortMonthNodes=function(s){for(var g=this,n=0;n<s.nodes.length;n++)for(var c=s.nodes[n],o=0;o<c.nodes.length;o++){var A=c.nodes[o];A.nodes=A.nodes.sort(function(y,h){return g.getNodeMonth(y)-g.getNodeMonth(h)})}},_.prototype.sortYearNodes=function(s){for(var g=this,n=0;n<s.nodes.length;n++){var c=s.nodes[n];c.nodes=c.nodes.sort(function(o,A){return g.getNodeYear(o)-g.getNodeYear(A)})}},_}(),Qr=it(Xt()),Bi=it(Jt()),$r=function(){function _(s){this._options=s,this._options.locale=this._options.locale||"en-GB"}return _.prototype.bootstrap=function(s,g){var n=this;return new Promise(function(c,o){s&&g&&(c=s,o=g),Bi.Utils.loadManifest(n._options.manifestUri).then(function(A){n._loaded(n,A,c,o)})})},_.prototype._loaded=function(s,g,n,c){var o=Bi.Utils.parseManifest(g,{locale:s._options.locale});if(o){s._options.iiifResource||(s._options.iiifResource=o);var A=s._options.collectionIndex,y=s._options.manifestIndex;if(o.getIIIFResourceType()===Qr.IIIFResourceType.COLLECTION){var h=o.getManifests(),m=o.getCollections();!h.length&&A===void 0&&(A=0),A!==void 0&&m&&m.length?o.getCollectionByIndex(A).then(function(a){a||c("Collection index not found"),a.getTotalManifests()===0&&y===0&&a.getTotalCollections()>0?(s._options.collectionIndex=0,s._options.manifestUri=a.id,s.bootstrap(n,c)):y!==void 0&&a.getManifestByIndex(y).then(function(t){s._options.manifest=t;var f=new wn(s._options);n(f)})}):o.getManifestByIndex(s._options.manifestIndex).then(function(a){s._options.manifest=a;var t=new wn(s._options);n(t)})}else{s._options.manifest=o;var I=new wn(s._options);n(I)}}else console.error("Unable to load IIIF resource")},_}(),he=it(Xt()),It=it(Wr()),Ye=it(Jt()),oo=function(){function _(s,g){this.authHoldingPage=null,this.clickThroughService=null,this.externalService=null,this.isProbed=!1,this.isResponseHandled=!1,this.kioskService=null,this.loginService=null,this.logoutService=null,this.probeService=null,this.restrictedService=null,this.tokenService=null,s.externalResource=this,this.dataUri=this._getDataUri(s),this.index=s.index,this.authAPIVersion=g.authApiVersion,this._parseAuthServices(s),this._parseCanvasDimensions(s)}return _.prototype._getImageServiceDescriptor=function(s){for(var g=null,n=0;n<s.length;n++){var c=s[n],o=c.id;o.endsWith("/")||(o+="/"),c.getProfile()&&Ye.Utils.isImageProfile(c.getProfile())&&(g=o+"info.json")}return g},_.prototype._getDataUri=function(s){var g=s.getContent(),n=s.getImages(),c=null;if(g&&g.length){var o=g[0],A=o.getBody();if(A.length){var y=A[0],h=y.getServices();return h.length&&(c=this._getImageServiceDescriptor(h),c)?c:A[0].id}return null}else if(n&&n.length){var m=n[0],I=m.getResource(),h=I.getServices();return h.length&&(c=this._getImageServiceDescriptor(h),c)?c:I.id}else{var a=s.getService(he.ServiceProfile.IXIF);return a?a.getInfoUri():s.id}},_.prototype._parseAuthServices=function(s){if(this.authAPIVersion===.9)this.clickThroughService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_0_CLICK_THROUGH),this.loginService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_0_LOGIN),this.restrictedService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_0_RESTRICTED),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(he.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.clickThroughService.getService(he.ServiceProfile.AUTH_0_TOKEN)):this.loginService?(this.logoutService=this.loginService.getService(he.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.loginService.getService(he.ServiceProfile.AUTH_0_TOKEN)):this.restrictedService&&(this.logoutService=this.restrictedService.getService(he.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.restrictedService.getService(he.ServiceProfile.AUTH_0_TOKEN));else{if(s.isCanvas!==void 0&&s.isCanvas()){var g=s.getContent();if(g&&g.length){var n=g[0].getBody();if(n&&n.length){var c=n[0];s=c}}}this.clickThroughService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_CLICK_THROUGH),this.loginService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_LOGIN),this.externalService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_EXTERNAL),this.kioskService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_KIOSK),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(he.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.clickThroughService.getService(he.ServiceProfile.AUTH_1_TOKEN),this.probeService=this.clickThroughService.getService(he.ServiceProfile.AUTH_1_PROBE)):this.loginService?(this.logoutService=this.loginService.getService(he.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.loginService.getService(he.ServiceProfile.AUTH_1_TOKEN),this.probeService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.loginService.getService(he.ServiceProfile.AUTH_1_PROBE))):this.externalService?(this.logoutService=this.externalService.getService(he.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.externalService.getService(he.ServiceProfile.AUTH_1_TOKEN),this.probeService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.externalService.getService(he.ServiceProfile.AUTH_1_PROBE))):this.kioskService&&(this.logoutService=this.kioskService.getService(he.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.kioskService.getService(he.ServiceProfile.AUTH_1_TOKEN),this.probeService=Ye.Utils.getService(s,he.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.kioskService.getService(he.ServiceProfile.AUTH_1_PROBE)))}},_.prototype._parseCanvasDimensions=function(s){var g=s.getImages();if(g&&g.length){var n=g[0],c=n.getResource();this.width=c.getWidth(),this.height=c.getHeight()}else if(g=s.getContent(),g.length){var o=g[0],A=o.getBody();A.length&&(this.width=A[0].getWidth(),this.height=A[0].getHeight())}},_.prototype._parseDescriptorDimensions=function(s){s.width!==void 0&&(this.width=s.width),s.height!==void 0&&(this.height=s.height)},_.prototype.isAccessControlled=function(){return!!(this.clickThroughService||this.loginService||this.externalService||this.kioskService||this.probeService)},_.prototype.hasServiceDescriptor=function(){return this.dataUri?this.dataUri.endsWith("info.json"):!1},_.prototype.getData=function(s){var g=this;return g.data={},new Promise(function(n,c){if(!g.dataUri){c("There is no dataUri to fetch");return}if(g.probeService){g.isProbed=!0;var o=new XMLHttpRequest;o.open("GET",g.probeService.id,!0),o.withCredentials=!0,o.onload=function(){var h=JSON.parse(o.responseText),m=unescape(h.contentLocation);m!==g.dataUri?g.status=It.MOVED_TEMPORARILY:g.status=It.OK,n(g)},o.onerror=function(){g.status=o.status,n(g)},o.send()}else{var A="GET";if(!g.hasServiceDescriptor()){if(!g.isAccessControlled()){g.status=It.OK,n(g);return}A="HEAD"}var y=new XMLHttpRequest;y.open(A,g.dataUri,!0),s&&y.setRequestHeader("Authorization","Bearer "+s.accessToken),y.onload=function(){if(!y.responseText)g.status=It.OK,n(g);else{var h=JSON.parse(y.responseText),m=unescape(h["@id"]);g.data=h,g._parseAuthServices(g.data),g._parseDescriptorDimensions(g.data),m.endsWith("/info.json")&&(m=m.substr(0,m.lastIndexOf("/")));var I=g.dataUri;I&&I.endsWith("/info.json")&&(I=I.substr(0,I.lastIndexOf("/"))),m!==I&&g.loginService?g.status=It.MOVED_TEMPORARILY:g.status=It.OK,n(g)}},y.onerror=function(){g.status=y.status,y.responseText&&g._parseAuthServices(JSON.parse(y.responseText)),n(g)},y.send()}})},_}(),ao=function(){function _(s){this.labels=s}return _.prototype.format=function(s){if(s.indexOf("<a")!=-1)return s;var g=this.labels[s]?this.labels[s]:s;return'<a href="'+s+'">'+g+"</a>"},_}(),Zr=function(_){return new $r(_).bootstrap()},zr=Kt((_,s)=>{(function(g,n){var c=n.jQuery;typeof _=="object"?s.exports=c?g(n,c):function(o){return g(n,o)}:typeof define=="function"&&define.amd?define(["jquery"],function(o){return g(n,o)}):g(n,!1)})(function(g,n){var c=n===!1;if(n=n||g.jQuery,!n||!n.fn)throw"JsViews requires jQuery";var o="v0.9.83",A,y,h,m,I,a,t,f,d,E,R,P,j,D,G,V,K,Y,W,oe,Pe,Oe,$e,qi=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,Yi=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*[.^]|\s*$|[^([])|[)\]])([([]?))|(\s+)/g,Mt,Qt=/[ \t]*(\r\n|\n|\r)/g,Mn=/\\(['"])/g,Dn=/['"\\]/g,Wi=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$_\.]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,Ki=/^if\s/,$t=/<(\w+)[>\s]/,Xi=/[\x00`><"'&=]/g,Ji=/[\x00`><\"'&=]/,Un=/^on[A-Z]|^convert(Back)?$/,Qi=/^\#\d+_`[\s\S]*\/\d+_`$/,$i=Xi,Zi=0,Vn={"&":"&amp;","<":"&lt;",">":"&gt;","\0":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;","=":"&#61;"},Ve="html",We="object",Zt="data-jsv-tmpl",ut="jsvTmpl",jn="For #index in nested block use #getIndex().",kn={},Dt=g.jsrender,zi=Dt&&n&&!n.render,zt={template:{compile:qn},tag:{compile:ur},viewModel:{compile:fr},helper:{},converter:{}};m={jsviews:o,sub:{View:dt,Err:nn,tmplFn:on,parse:zn,extend:me,extendCtx:ct,syntaxErr:Re,onStore:{},addSetting:Kn,settings:{allowCode:!1},advSet:tn,_ths:en,_tg:function(){},_cnvt:rr,_tag:sr,_er:Ke,_err:Qn,_html:ln,_cp:Ut,_sq:function(e){return e==="constructor"&&Re(""),e}},settings:{delimiters:Vt,advanced:function(e){return e?(me(V,e),D.advSet(),K):V}},getCtx:Ut,map:Xn};function Fn(e,i){return function(){var r,l=this,u=l.base;return l.base=e,r=i.apply(l,arguments),l.base=u,r}}function Gn(e,i){return f(i)&&(i=Fn(e?e._d?e:Fn(tn,e):tn,i),i._d=1),i}function en(e,i){for(var r in i.props)Un.test(r)&&(e[r]=Gn(e[r],i.props[r]))}function Ut(e){return e}function tn(){return""}function er(e){try{throw console.log("JsRender dbg breakpoint: "+e),"dbg breakpoint"}catch{}return this.base?this.baseApply(arguments):e}function nn(e){this.name=(n.link?"JsViews":"JsRender")+" Error",this.message=e||this.name}function me(e,i){for(var r in i)e[r]=i[r];return e}(nn.prototype=new Error).constructor=nn;function Vt(e,i,r){return e?d(e)?Vt.apply(m,e):(G.delimiters=[e,i,Oe=r?r.charAt(0):Oe],Y=e.charAt(0),W=e.charAt(1),oe=i.charAt(0),Pe=i.charAt(1),e="\\"+Y+"(\\"+Oe+")?\\"+W,i="\\"+oe+"\\"+Pe,y="(?:(\\w+(?=[\\/\\s\\"+oe+"]))|(\\w+)?(:)|(>)|(\\*))\\s*((?:[^\\"+oe+"]|\\"+oe+"(?!\\"+Pe+"))*?)",D.rTag="(?:"+y+")",y=new RegExp("(?:"+e+y+"(\\/)?|\\"+Y+"(\\"+Oe+")?\\"+W+"(?:(?:\\/(\\w+))\\s*|!--[\\s\\S]*?--))"+i,"g"),D.rTmpl=new RegExp("<.*>|([^\\\\]|^)[{}]|"+e+".*"+i),K):G.delimiters}function tr(e,i){!i&&e!==!0&&(i=e,e=void 0);var r,l,u,p,v=this,T=!i||i==="root";if(e){if(p=i&&v.type===i&&v,!p)if(r=v.views,v._.useKey){for(l in r)if(p=i?r[l].get(e,i):r[l])break}else for(l=0,u=r.length;!p&&l<u;l++)p=i?r[l].get(e,i):r[l]}else if(T)for(;v.parent;)p=v,v=v.parent;else for(;v&&!p;)p=v.type===i?v:void 0,v=v.parent;return p}function Hn(){var e=this.get("item");return e?e.index:void 0}Hn.depends=function(){return[this.get("item"),"index"]};function Bn(){return this.index}Bn.depends="index";function nr(e,i){var r,l,u=this,p=u.ctx;if(p&&(p=p[e]),p===void 0&&(p=P[e]),p&&p._cp){if(i)return l=D._ceo(p[1].deps),l.unshift(p[0]),l._cp=!0,l;p=m.getCtx(p)}return p&&f(p)&&!p._wrp&&(r=function(){return p.apply(!this||this===g?u:this,arguments)},r._wrp=u,me(r,p)),r||p}function ir(e){return e&&(e.fn?e:this.getRsc("templates",e)||E(e))}function rr(e,i,r,l){var u,p,v=typeof r=="number"&&i.tmpl.bnds[r-1],T=i.linkCtx;return l!==void 0?r=l={props:{},args:[l]}:v&&(r=v(i.data,i,D)),p=r.args[0],(e||v)&&(u=T&&T.tag,u||(u=me(new D._tg,{_:{inline:!T,bnd:v,unlinked:!0},tagName:":",cvt:e,flow:!0,tagCtx:r}),T&&(T.tag=u,u.linkCtx=T),r.ctx=ct(r.ctx,(T?T.view:i).ctx)),u._er=l&&p,en(u,r),r.view=i,u.ctx=r.ctx||u.ctx||{},r.ctx=void 0,p=u.cvtArgs(e!=="true"&&e)[0],p=v&&i._.onRender?i._.onRender(p,i,u):p),p!=null?p:""}function or(e){var i=this,r=i.tagCtx,l=r.view,u=r.args;return e=e||i.convert,e=e&&(""+e===e?l.getRsc("converters",e)||Ke("Unknown converter: '"+e+"'"):e),u=!u.length&&!r.index?[l.data]:e?u.slice():u,e&&(e.depends&&(i.depends=D.getDeps(i.depends,i,e.depends,e)),u[0]=e.apply(i,u)),u}function ar(e,i){for(var r,l,u=this;r===void 0&&u;)l=u.tmpl&&u.tmpl[e],r=l&&l[i],u=u.parent;return r||m[e][i]}function sr(e,i,r,l,u,p){i=i||h;var v,T,b,L,N,C,w,x,O,M,k,q,H,B,S,U,F,Q,z="",X=i.linkCtx||0,J=i.ctx,ee=r||i.tmpl,ue=typeof l=="number"&&i.tmpl.bnds[l-1];for(e._is==="tag"?(v=e,e=v.tagName,l=v.tagCtxs,v.template):(T=i.getRsc("tags",e)||Ke("Unknown tag: {{"+e+"}} "),T.template),p!==void 0?(z+=p,l=p=[{props:{},args:[]}]):ue&&(l=ue(i.data,i,D)),w=l.length,C=0;C<w;C++)O=l[C],(!X||!X.tag||C&&!X.tag._.inline||v._er)&&((k=ee.tmpls&&O.tmpl)&&(k=O.content=ee.tmpls[k-1]),O.index=C,O.tmpl=k,O.render=rn,O.view=i,O.ctx=ct(O.ctx,J)),(r=O.props.tmpl)&&(O.tmpl=i.getTmpl(r)),v||(v=new T._ctr,q=!!v.init,v.parent=N=J&&J.tag,v.tagCtxs=l,F=v.dataMap,X&&(v._.inline=!1,X.tag=v,v.linkCtx=X),(v._.bnd=ue||X.fn)?v._.arrVws={}:v.dataBoundOnly&&Ke("{^{"+e+"}} tag must be data-bound")),l=v.tagCtxs,F=v.dataMap,O.tag=v,F&&l&&(O.map=l[C].map),v.flow||(M=O.ctx=O.ctx||{},b=v.parents=M.parentTags=J&&ct(M.parentTags,J.parentTags)||{},N&&(b[N.tagName]=N),b[v.tagName]=M.tag=v);if(!(v._er=p)){for(en(v,l[0]),v.rendering={},C=0;C<w;C++)O=v.tagCtx=l[C],U=O.props,S=v.cvtArgs(),(H=U.dataMap||F)&&(S.length||U.dataMap)&&(B=O.map,(!B||B.src!==S[0]||u)&&(B&&B.src&&B.unmap(),B=O.map=H.map(S[0],U,void 0,!v._.bnd)),S=[B.tgt]),v.ctx=O.ctx,C||(q&&(v.template,v.init(O,X,v.ctx),q=void 0),X&&(X.attr=v.attr=X.attr||v.attr),L=v.attr,v._.noVws=L&&L!==Ve),x=void 0,v.render&&(x=v.render.apply(v,S),i.linked&&x&&v.linkedElem&&!Qi.test(x)&&(x=Jn(n.templates(x),S[0],void 0,void 0,i,void 0,void 0,v))),S.length||(S=[i]),x===void 0&&(Q=S[0],v.contentCtx&&(Q=v.contentCtx(Q)),x=O.render(Q,!0)||(u?void 0:"")),z=z?z+(x||""):x;v.rendering=void 0}return v.tagCtx=l[0],v.ctx=v.tagCtx.ctx,v._.noVws&&v._.inline&&(z=L==="text"?R.html(z):""),ue&&i._.onRender?i._.onRender(z,i,v):z}function dt(e,i,r,l,u,p,v,T){var b,L,N,C=this,w=i==="array";C.content=T,C.views=w?[]:{},C.parent=r,C.type=i||"top",C.data=l,C.tmpl=u,N=C._={key:0,useKey:w?0:1,id:""+Zi++,onRender:v,bnds:{}},C.linked=!!v,r?(b=r.views,L=r._,L.useKey?(b[N.key="_"+L.useKey++]=C,C.index=jn,C.getIndex=Hn):b.length===(N.key=C.index=p)?b.push(C):b.splice(p,0,C),C.ctx=e||r.ctx):C.ctx=e}dt.prototype={get:tr,getIndex:Bn,getRsc:ar,getTmpl:ir,hlp:nr,_is:"view"};function lr(e){var i,r,l;for(i in zt)r=i+"s",e[r]&&(l=e[r],e[r]={},m[r](l,e))}function ur(e,i,r){var l,u,p,v=new D._tg;function T(){var b=this;b._={inline:!0,unlinked:!0},b.tagName=e}if(f(i)?i={depends:i.depends,render:i}:""+i===i&&(i={template:i}),u=i.baseTag){i.flow=!!i.flow,i.baseTag=u=""+u===u?r&&r.tags[u]||j[u]:u,v=me(v,u);for(p in i)v[p]=Gn(u[p],i[p])}else v=me(v,i);return(l=v.template)!==void 0&&(v.template=""+l===l?E[l]||E(l):l),v.init!==!1&&((T.prototype=v).constructor=v._ctr=T),r&&(v._parentTmpl=r),v}function cr(e){return this.base.apply(this,e)}function qn(e,i,r,l){function u(b){var L,N;if(""+b===b||b.nodeType>0&&(p=b)){if(!p){if(/^\.\/[^\\:*?"<>]*$/.test(b))(N=E[e=e||b])?b=N:p=document.getElementById(b);else if(n.fn&&!D.rTmpl.test(b))try{p=n(document).find(b)[0]}catch{}}p&&(l?b=p.innerHTML:(L=p.getAttribute(Zt),L?L!==ut?(b=E[L],delete E[L]):n.fn&&(b=n.data(p)[ut]):(e=e||(n.fn?ut:b),b=qn(e,p.innerHTML,r,l)),b.tmplName=e=e||L,e!==ut&&(E[e]=b),p.setAttribute(Zt,e),n.fn&&n.data(p,ut,b))),p=void 0}else b.fn||(b=void 0);return b}var p,v,T=i=i||"";if(l===0&&(l=void 0,T=u(T)),l=l||(i.markup?i:{}),l.tmplName=e,r&&(l._parentTmpl=r),!T&&i.markup&&(T=u(i.markup))&&T.fn&&(T=T.markup),T!==void 0)return T.fn||i.fn?T.fn&&(v=T):(i=Wn(T,l),on(T.replace(Dn,"\\$&"),i)),v||(v=me(function(){return v.render.apply(v,arguments)},i),lr(v)),e&&!r&&e!==ut&&(kn[e]=v),v}function pr(e,i){return n.isFunction(e)?e.call(i):e}function Yn(e){var i,r=[],l=e.length;for(i=0;i<l;i++)r.push(e[i].unmap());return r}function fr(e,i){var r,l,u=this,p=i.getters,v=i.extend,T=i.id,b=n.extend({_is:e||"unnamed",unmap:B,merge:H},v),L="",N="",C=p?p.length:0,w=n.observable,x={};function O(S){l.apply(this,S)}function M(){return new O(arguments)}function k(S,U){var F,Q,z,X,J,ee=p.length;for(F=0;F<ee;F++)X=p[F],Q=void 0,X+""!==X&&(Q=X,X=Q.getter),(J=S[X])===void 0&&Q&&(z=Q.defaultVal)!==void 0&&(J=pr(z,S)),U(J,Q&&u[Q.type],X)}function q(S){S=S+""===S?JSON.parse(S):S;var U,F,Q,z=S,X=[];if(d(S)){for(S=S||[],F=S.length,U=0;U<F;U++)X.push(this.map(S[U]));return X._is=e,X.unmap=B,X.merge=H,X}if(S){k(S,function(J,ee){ee&&(J=ee.map(J)),X.push(J)}),z=this.apply(this,X);for(Q in S)Q!==t&&!x[Q]&&(z[Q]=S[Q])}return z}function H(S){S=S+""===S?JSON.parse(S):S;var U,F,Q,z,X,J,ee,ue,ae,Ee,ce=this;if(d(ce)){for(ue={},Ee=[],Q=S.length,z=ce.length,U=0;U<Q;U++){for(ae=S[U],ee=!1,F=0;F<z&&!ee;F++)ue[F]||(J=ce[F],T&&(ue[F]=ee=T+""===T?ae[T]&&(x[T]?J[T]():J[T])===ae[T]:T(J,ae)));ee?(J.merge(ae),Ee.push(J)):Ee.push(M.map(ae))}w?w(ce).refresh(Ee,!0):ce.splice.apply(ce,[0,ce.length].concat(Ee));return}k(S,function(de,se,$){se?ce[$]().merge(de):ce[$](de)});for(X in S)X!==t&&!x[X]&&(ce[X]=S[X])}function B(){var S,U,F,Q,z,X,J=this;if(d(J))return Yn(J);for(S={},Q=p.length,F=0;F<Q;F++)U=p[F],z=void 0,U+""!==U&&(z=U,U=z.getter),X=J[U](),S[U]=z&&X&&u[z.type]?d(X)?Yn(X):X.unmap():X;for(U in J)U!=="_is"&&!x[U]&&U!==t&&(U.charAt(0)!=="_"||!x[U.slice(1)])&&!n.isFunction(J[U])&&(S[U]=J[U]);return S}for(O.prototype=b,r=0;r<C;r++)(function(S){S=S.getter||S,x[S]=r+1;var U="_"+S;L+=(L?",":"")+S,N+="this."+U+" = "+S+`;
`,b[S]=b[S]||function(F){if(!arguments.length)return this[U];w?w(this).setProperty(S,F):this[U]=F},w&&(b[S].set=b[S].set||function(F){this[U]=F})})(p[r]);return l=new Function(L,N.slice(0,-1)),l.prototype=b,b.constructor=l,M.map=q,M.getters=p,M.extend=v,M.id=T,M}function Wn(e,i){var r,l=V._wm||{},u=me({tmpls:[],links:{},bnds:[],_is:"template",render:rn},i);return u.markup=e,i.htmlTag||(r=$t.exec(e),u.htmlTag=r?r[1].toLowerCase():""),r=l[u.htmlTag],r&&r!==l.div&&(u.markup=n.trim(u.markup)),u}function hr(e,i){function r(u,p,v){var T,b,L,N;if(u&&typeof u===We&&!u.nodeType&&!u.markup&&!u.getTgt&&!(e==="viewModel"&&u.getters||u.extend)){for(L in u)r(L,u[L],p);return p||m}return p===void 0&&(p=u,u=void 0),u&&""+u!==u&&(v=p,p=u,u=void 0),N=v?e==="viewModel"?v:v[l]=v[l]||{}:r,b=i.compile,p===null?u&&delete N[u]:(p=b?b.call(N,u,p,v,0):p,u&&(N[u]=p)),b&&p&&(p._is=e),p&&(T=D.onStore[e])&&T(u,p,b),p}var l=e+"s";m[l]=r}function Kn(e){K[e]=function(i){return arguments.length?(G[e]=i,K):G[e]}}function Xn(e){function i(r,l){this.tgt=e.getTgt(r,l)}return f(e)&&(e={getTgt:e}),e.baseMap&&(e=me(me({},e.baseMap),e)),e.map=function(r,l){return new i(r,l)},e}function rn(e,i,r,l,u,p){var v,T,b,L,N,C,w,x,O=l,M="";if(i===!0?(r=i,i=void 0):typeof i!==We&&(i=void 0),(b=this.tag)?(N=this,O=O||N.view,L=O.getTmpl(b.template||N.tmpl),arguments.length||(e=O)):L=this,L){if(!l&&e&&e._is==="view"&&(O=e),O&&e===O&&(e=O.data),C=!O,Mt=Mt||C,O||((i=i||{}).root=e),!Mt||V.useViews||L.useViews||O&&O!==h)M=Jn(L,e,i,r,O,u,p,b);else{if(O?(w=O.data,x=O.index,O.index=jn):(O=h,O.data=e,O.ctx=i),d(e)&&!r)for(v=0,T=e.length;v<T;v++)O.index=v,O.data=e[v],M+=L.fn(e[v],O,D);else O.data=e,M+=L.fn(e,O,D);O.data=w,O.index=x}C&&(Mt=void 0)}return M}function Jn(e,i,r,l,u,p,v,T){function b(F){B=me({},r),B[H]=F}var L,N,C,w,x,O,M,k,q,H,B,S,U="";if(T&&(q=T.tagName,S=T.tagCtx,r=r?ct(r,T.ctx):T.ctx,e===u.content?M=e!==u.ctx._wrp?u.ctx._wrp:void 0:e!==S.content?e===T.template?(M=S.tmpl,r._wrp=S.content):M=S.content||u.content:M=u.content,S.props.link===!1&&(r=r||{},r.link=!1),(H=S.props.itemVar)&&(H.charAt(0)!=="~"&&Re("Use itemVar='~myItem'"),H=H.slice(1))),u&&(v=v||u._.onRender,r=ct(r,u.ctx)),p===!0&&(O=!0,p=0),v&&(r&&r.link===!1||T&&T._.noVws)&&(v=void 0),k=v,v===!0&&(k=void 0,v=u._.onRender),r=e.helpers?ct(e.helpers,r):r,B=r,d(i)&&!l)for(C=O?u:p!==void 0&&u||new dt(r,"array",u,i,e,p,v,M),u&&u._.useKey&&(C._.bnd=!T||T._.bnd&&T),H&&(C.it=H),H=C.it,L=0,N=i.length;L<N;L++)H&&b(i[L]),w=new dt(B,"item",C,i[L],e,(p||0)+L,v,C.content),x=e.fn(i[L],w,D),U+=C._.onRender?C._.onRender(x,w):x;else H&&b(i),C=O?u:new dt(B,q||"data",u,i,e,p,v,M),T&&!T.flow&&(C.tag=T,T.view=C),U+=e.fn(i,C,D);return k?k(U,C):U}function Qn(e,i,r){var l=r!==void 0?f(r)?r.call(i.data,e,i):r||"":"{Error: "+e.message+"}";return G.onError&&(r=G.onError.call(i.data,e,r&&l,i))!==void 0&&(l=r),i&&!i.linkCtx?R.html(l):l}function Ke(e){throw new D.Err(e)}function Re(e){Ke(`Syntax error
`+e)}function on(e,i,r,l,u){function p(B){B-=M,B&&q.push(e.substr(M,B).replace(Qt,"\\n"))}function v(B,S){B&&(B+="}}",Re((S?"{{"+S+"}} block has {{/"+B+" without {{"+B:"Unmatched or missing {{/"+B)+`, in template:
`+e))}function T(B,S,U,F,Q,z,X,J,ee,ue,ae,Ee){(X&&S||ee&&!U||J&&J.slice(-1)===":"||ue)&&Re(B),z&&(Q=":",F=Ve),ee=ee||r&&!u;var ce=(S||r)&&[[]],de="",se="",$="",ge="",pe="",Z="",Se="",te="",Ie=!ee&&!Q;U=U||(J=J||"#data",Q),p(Ee),M=Ee+B.length,X?x&&q.push(["*",`
`+J.replace(/^:/,"ret+= ").replace(Mn,"$1")+`;
`]):U?(U==="else"&&(Ki.test(J)&&Re('for "{{else if expr}}" use "{{else expr}}"'),ce=H[7]&&[[]],H[8]=e.substring(H[8],Ee),H=k.pop(),q=H[2],Ie=!0),J&&zn(J.replace(Qt," "),ce,i).replace(Wi,function(Te,ne,le,re,ve,Ne,Ae,we){return re="'"+ve+"':",Ae?(se+=Ne+",",ge+="'"+we+"',"):le?($+=re+"j._cp("+Ne+',"'+we+'",view),',Z+=re+"'"+we+"',"):ne?Se+=Ne:(ve==="trigger"&&(te+=Ne),de+=re+Ne+",",pe+=re+"'"+we+"',",C=C||Un.test(ve)),""}).slice(0,-1),ce&&ce[0]&&ce.pop(),N=[U,F||!!l||C||"",Ie&&[],$n(ge||(U===":"?"'#data',":""),pe,Z),$n(se||(U===":"?"data,":""),de,$),Se,te,ce||0],q.push(N),Ie&&(k.push(H),H=N,H[8]=M)):ae&&(v(ae!==H[0]&&H[0]!=="else"&&ae,H[0]),H[8]=e.substring(H[8],Ee),H=k.pop()),v(!H&&ae),q=H[2]}var b,L,N,C,w,x=G.allowCode||i&&i.allowCode||K.allowCode===!0,O=[],M=0,k=[],q=O,H=[,,O];if(x&&i._is&&(i.allowCode=x),r&&(l!==void 0&&(e=e.slice(0,-l.length-2)+oe),e=Y+e+Pe),v(k[0]&&k[0][2].pop()[0]),e.replace(y,T),p(e.length),(M=O[O.length-1])&&v(""+M!==M&&+M[8]===M[8]&&M[0]),r){for(L=sn(O,e,r),w=[],b=O.length;b--;)w.unshift(O[b][7]);an(L,w)}else L=sn(O,i);return L}function an(e,i){var r,l,u=0,p=i.length;for(e.deps=[],e.paths=[];u<p;u++){e.paths.push(l=i[u]);for(r in l)r!=="_jsvto"&&l.hasOwnProperty(r)&&l[r].length&&!l[r].skp&&(e.deps=e.deps.concat(l[r]))}}function $n(e,i,r){return[e.slice(0,-1),i.slice(0,-1),r.slice(0,-1)]}function Zn(e,i){return`
	`+(i?i+":{":"")+"args:["+e[0]+"]"+(e[1]||!i?`,
	props:{`+e[1]+"}":"")+(e[2]?`,
	ctx:{`+e[2]+"}":"")}function zn(e,i,r){function l(H,B,S,U,F,Q,z,X,J,ee,ue,ae,Ee,ce,de,se,$,ge,pe,Z){function Se(ve,Ne,Ae,we,st,ze,Je,et){var Me=Ae===".";if(Ae&&(F=F.slice(Ne.length),/^\.?constructor$/.test(et||F)&&Re(ve),Me||(ve=(we?'view.hlp("'+we+'")':st?"view":"data")+(et?(ze?"."+ze:we||st?"":"."+Ae)+(Je||""):(et=we?"":st?ze||"":Ae,"")),ve=ve+(et?"."+et:""),ve=Ne+(ve.slice(0,9)==="view.data"?ve.slice(5):ve)),L)){if(Te=u==="linkTo"?p=i._jsvto=i._jsvto||[]:N.bd,ne=Me&&Te[Te.length-1]){if(ne._jsv){for(;ne.sb;)ne=ne.sb;ne.bnd&&(F="^"+F.slice(1)),ne.sb=F,ne.bnd=ne.bnd||F.charAt(0)==="^"}}else Te.push(F);k[O]=pe+(Me?1:0)}return ve}U&&!X&&(F=U+F),Q=Q||"",S=S||B||ae,F=F||J,ee=ee||$||"";var te,Ie,Te,ne,le,re=")";if(ee==="["&&(ee="[j._sq(",re=")]"),z&&!b&&!T)Re(e);else{if(L&&se&&!b&&!T&&(!u||v||p)&&(te=k[O-1],Z.length-1>pe-(te||0))){if(te=Z.slice(te,pe+H.length),Ie!==!0)if(Te=p||C[O-1].bd,ne=Te[Te.length-1],ne&&ne.prm){for(;ne.sb&&ne.sb.prm;)ne=ne.sb;le=ne.sb={path:ne.sb,bnd:ne.bnd}}else Te.push(le={path:Te.pop()});se=W+":"+te+" onerror=''"+oe,Ie=x[se],Ie||(x[se]=!0,x[se]=Ie=on(se,r,!0)),Ie!==!0&&le&&(le._jsv=Ie,le.prm=N.bd,le.bnd=le.bnd||le.path&&le.path.indexOf("^")>=0)}return b?(b=!Ee,b?H:ae+'"'):T?(T=!ce,T?H:ae+'"'):(S?(k[O]=pe++,N=C[++O]={bd:[]},S):"")+(ge?O?"":(w=Z.slice(w,pe),(u?(u=v=p=!1,"\b"):"\b,")+w+(w=pe+H.length,L&&i.push(N.bd=[]),"\b")):X?(O&&Re(e),L&&i.pop(),u=F,v=U,w=pe+H.length,L&&(L=N.bd=i[u]=[],L.skp=!U),F+":"):F?F.split("^").join(".").replace(qi,Se)+(ee?(N=C[++O]={bd:[]},M[O]=re,ee):Q):Q||(de?(de=M[O]||de,M[O]=!1,N=C[--O],de+(ee?(N=C[++O],M[O]=re,ee):"")):ue?(M[O]||Re(e),","):B?"":(b=Ee,T=ce,'"')))}}var u,p,v,T,b,L=i&&i[0],N={bd:L},C={0:N},w=0,x=(r?r.links:L&&(L.links=L.links||{}))||h.tmpl.links,O=0,M={},k={},q=(e+(r?" ":"")).replace(Yi,l);return!O&&q||Re(e)}function sn(e,i,r){var l,u,p,v,T,b,L,N,C,w,x,O,M,k,q,H,B,S,U,F,Q,z,X,J,ee,ue,ae,Ee,ce,de=0,se=V.useViews||i.useViews||i.tags||i.templates||i.helpers||i.converters,$="",ge={},pe=e.length;for(""+i===i?(B=r?'data-link="'+i.replace(Qt," ").slice(1,-1)+'"':i,i=0):(B=i.tmplName||"unnamed",i.allowCode&&(ge.allowCode=!0),i.debug&&(ge.debug=!0),w=i.bnds,H=i.tmpls),l=0;l<pe;l++)if(u=e[l],""+u===u)$+=`
+"`+u+'"';else if(p=u[0],p==="*")$+=`;
`+u[1]+`
ret=ret`;else{if(v=u[1],F=!r&&u[2],T=Zn(u[3],"params")+"},"+Zn(O=u[4]),ae=u[5],ce=u[6],Q=u[8]&&u[8].replace(Mn,"$1"),(J=p==="else")?x&&x.push(u[7]):(de=0,w&&(x=u[7])&&(x=[x],de=w.push(1))),se=se||O[1]||O[2]||x||/view.(?!index)/.test(O[0]),(ee=p===":")?v&&(p=v===Ve?">":v+p):(F&&(S=Wn(Q,ge),S.tmplName=B+"/"+p,S.useViews=S.useViews||se,sn(F,S),se=S.useViews,H.push(S)),J||(U=p,se=se||p&&(!j[p]||!j[p].flow),X=$,$=""),z=e[l+1],z=z&&z[0]==="else"),Ee=ae?`;
try{
ret+=`:`
+`,M="",k="",ee&&(x||ce||v&&v!==Ve)){if(ue=new Function("data,view,j,u"," // "+B+" "+de+" "+p+`
return {`+T+"};"),ue._er=ae,ue._tag=p,r)return ue;an(ue,x),q='c("'+v+'",view,',C=!0,M=q+de+",",k=")"}if($+=ee?(r?(ae?`try{
`:"")+"return ":Ee)+(C?(C=void 0,se=N=!0,q+(x?(w[de-1]=ue,de):"{"+T+"}")+")"):p===">"?(L=!0,"h("+O[0]+")"):"((v="+O[0]+")!=null?v:"+(r?"null)":'"")')):(b=!0,`
{view:view,tmpl:`+(F?H.length:"0")+","+T+"},"),U&&!z){if($="["+$.slice(0,-1)+"]",q='t("'+U+'",view,this,',r||x){if($=new Function("data,view,j,u"," // "+B+" "+de+" "+U+`
return `+$+";"),$._er=ae,$._tag=U,x&&an(w[de-1]=$,x),r)return $;M=q+de+",undefined,",k=")"}$=X+Ee+q+(de||$)+")",x=0,U=0}ae&&(se=!0,$+=`;
}catch(e){ret`+(r?"urn ":"+=")+M+"j._err(e,view,"+ae+")"+k+";}"+(r?"":"ret=ret"))}$="// "+B+`
var v`+(b?",t=j._tag":"")+(N?",c=j._cnvt":"")+(L?",h=j._html":"")+(r?`;
`:`,ret=""
`)+(ge.debug?"debugger;":"")+$+(r?`
`:`;
return ret;`),G.debugMode!==!1&&($=`try {
`+$+`
}catch(e){
return j._err(e, view);
}`);try{$=new Function("data,view,j,u",$)}catch(Z){Re(`Compiled template code:

`+$+`
: "`+Z.message+'"')}return i&&(i.fn=$,i.useViews=!!se),$}function ct(e,i){return e&&e!==i?i?me(me({},i),e):e:i&&me({},i)}function dr(e){return Vn[e]||(Vn[e]="&#"+e.charCodeAt(0)+";")}function gr(e){var i,r,l=[];if(typeof e===We)for(i in e)r=e[i],i!==t&&e.hasOwnProperty(i)&&!f(r)&&l.push({key:i,prop:r});return l}function ei(e,i,r){var l=this.jquery&&(this[0]||Ke("Unknown template")),u=l.getAttribute(Zt);return rn.call(u?n.data(l)[ut]:E(l),e,i,r)}function ln(e){return e!=null?Ji.test(e)&&(""+e).replace($i,dr)||e:""}if(D=m.sub,K=m.settings,!(Dt||n&&n.render)){for(A in zt)hr(A,zt[A]);R=m.converters,P=m.helpers,j=m.tags,D._tg.prototype={baseApply:cr,cvtArgs:or},h=D.topView=new dt,n?(n.fn.render=ei,t=n.expando,n.observable&&(me(D,n.views.sub),m.map=n.views.map)):(n={},c&&(g.jsrender=n),n.renderFile=n.__express=n.compile=function(){throw"Node.js: use npm jsrender, or jsrender-node.js"},n.isFunction=function(e){return typeof e=="function"},n.isArray=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},D._jq=function(e){e!==n&&(me(e,n),n=e,n.fn.render=ei,delete n.jsrender,t=n.expando)},n.jsrender=o),G=D.settings,G.allowCode=!1,f=n.isFunction,n.render=kn,n.views=m,n.templates=E=m.templates;for($e in G)Kn($e);(K.debugMode=function(e){return e===void 0?G.debugMode:(G.debugMode=e,G.onError=e+""===e?new Function("","return '"+e+"';"):f(e)?e:void 0,K)})(!1),V=G.advanced={useViews:!1,_jsv:!1},j({if:{render:function(e){var i=this,r=i.tagCtx,l=i.rendering.done||!e&&(arguments.length||!r.index)?"":(i.rendering.done=!0,i.selected=r.index,r.render(r.view,!0));return l},flow:!0},for:{render:function(e){var i=!arguments.length,r,l=this,u=l.tagCtx,p="",v=0;return l.rendering.done||(r=i?u.view.data:e,r!==void 0&&(p+=u.render(r,i),v+=d(r)?r.length:1),(l.rendering.done=v)&&(l.selected=u.index)),p},flow:!0},props:{baseTag:"for",dataMap:Xn(gr),flow:!0},include:{flow:!0},"*":{render:Ut,flow:!0},":*":{render:Ut,flow:!0},dbg:P.dbg=R.dbg=er}),R({html:ln,attr:ln,url:function(e){return e!=null?encodeURI(""+e):e===null?e:""}})}if(G=D.settings,d=(n||Dt).isArray,K.delimiters("{{","}}","^"),zi&&Dt.views.sub._jq(n),m=n.views,D=m.sub,f=n.isFunction,d=n.isArray,t=n.expando,!n.observe){var ti=n.event.special,ni=[].slice,un=[].splice,ii=[].concat,gt=parseInt,vr=/\S+/g,rt=D.propChng=D.propChng||"propertyChange",ot=D.arrChng=D.arrChng||"arrayChange",at={},_r=rt+".observe",yr=1,mr=1,Er=1,cn=n.hasData,pt=n.data,ri={},pn=function(e){return e._cId=e._cId||".obs"+mr++},fn=function(e,i){return this._data=i,this._ns=e,this},hn=function(e,i){return this._data=i,this._ns=e,this},Ir=function(e){return d(e)?[e]:e},oi=function(e,i,r){e=e?d(e)?e:[e]:[];var l,u,p=i,v=p,T=e&&e.length,b=[];for(l=0;l<T;l++){if(u=e[l],f(u)){b=b.concat(oi(u.call(i,i,r),i));continue}else if(""+u!==u){i=v=u,v!==p&&b.push(p=v);continue}v!==p&&b.push(p=v),b.push(u)}return b},ai=function(e,i){for(var r in e)return;delete at[i]},si=function(e,i){function r(O){return typeof O===We&&(w[0]||C&&d(O))}if(!(e.data&&e.data.off)){var l,u,p,v=i.oldValue,T=i.value,b=e.data,L=b.observeAll,N=b.cb,C=!N.noArray,w=b.paths,x=b.ns;e.type===ot?(N.array||N).call(b,e,i):(b.prop===i.path||b.prop==="*")&&(L?(l=L._path+"."+i.path,u=L.filter,p=[e.target].concat(L.parents()),r(v)&&Tt(C,x,[v],w,N,!0,u,[p],l),r(T)&&Tt(C,x,[T],w,N,void 0,u,[p],l)):(r(v)&&Tt(C,x,[v],w,N,!0),r(T)&&Tt(C,x,[T],w,N)),b.cb(e,i))}},Tt=function(){var e=ii.apply([],arguments);return I.apply(e.shift(),e)},dn=function(e,i,r){ui(this._ns,this._data,e,i,[],"root",r)},li=function(e,i){dn.call(this,e,i,!0)},ui=function(e,i,r,l,u,p,v,T){function b(H,B){for(C=H.length,x=p+"[]";C--;)L(H,C,B,1)}function L(H,B,S,U){var F,Q;B!==t&&(F=a._fltr(x,H[B],O,l))&&(Q=O.slice(),U&&M&&Q[0]!==M&&Q.unshift(M),ui(e,F,r,l||(U?void 0:0),Q,x,S,T))}function N(H,B){switch(p=H.data.observeAll._path,M=H.target,B.change){case"insert":b(B.items);break;case"remove":b(B.items,!0);break;case"set":x=p+"."+B.path,L(B,"oldValue",!0),L(B,"value")}M=void 0,r.apply(this,arguments)}var C,w,x,O,M,k,q=!T||T.un||!v;if(i&&typeof i===We){if(O=[i].concat(u),w=d(i)?"":"*",T&&q&&cn(i)&&T[k=pt(i).obId]){T[k]++;return}if(T||(T={un:v}),r){if(w||l!==0)if(N._cId=pn(r),q)I(e,i,w,N,v,l,O,p),k=pt(i).obId,T[k]=(T[k]||0)+1;else{if(--T[pt(i).obId])return;I(e,i,w,N,v,l,O,p)}}else T&&(T[pt(i).obId]=1),I(e,i,w,void 0,v,l,O,p);if(w)for(C in i)x=p+"."+C,L(i,C,v);else b(i,v)}},ci=function(e){return e.indexOf(".")<0&&e.indexOf("[")<0},Tr=function(){return[].push.call(arguments,!0),I.apply(this,arguments)};I=function(){function e(){function p(te,Ie,Te,ne){var le,re,ve=cn(Z),Ne=Ir(Z),Ae=ue,we=ae;if(te=i?te+"."+i:te,!M&&(ne||Te)){for(U=ve&&n._data(Z),U=U&&U.events,U=U&&U[Te?ot:rt],B=U&&U.length;B--;)if(S=U[B]&&U[B].data,S&&(ne&&S.ns!==i||!ne&&S.ns===i&&S.cb&&S.cb._cId===k._cId))return}M||ne?n(Ne).off(te,si):(re=Te?{}:{fullPath:x,paths:Ie?[Ie]:[],prop:w},re.ns=i,re.cb=k,ae&&(re.observeAll={_path:we,path:function(){return le=Ae.length,we.replace(/[[.]/g,function(st){return le--,st==="["?"["+n.inArray(Ae[le-1],Ae[le]):"."})},parents:function(){return Ae},filter:Ee}),n(Ne).on(te,null,re,si),X&&(X[pt(Z).obId||pt(Z,"obId",yr++)]=Z))}function v(te){var Ie=pe;return te.ob=F(te,Ie),te.cb=function(Te,ne){var le=te.ob,re=te.sb,ve=F(te,Ie);ve!==le&&(typeof le===We&&(T(le,!0),(re||r&&d(le))&&e([le],re,k,F,!0)),te.ob=ve,typeof ve===We&&(T(ve),(re||r&&d(ve))&&e([ve],re,k,F))),k(Te,ne)}}function T(te,Ie,Te,ne){if(r){var le=Z,re=ae;Z=te,ne&&(Z=te[ne],ae+="."+ne),Ee&&Z&&(Z=a._fltr(ae,Z,ne?[te].concat(ue):ue,Ee)),Z&&(Te||d(Z))&&p(ot+".observe"+(k?pn(k):""),void 0,!0,Ie),Z=le,ae=re}}var b,L,N,C,w,x,O,M,k,q,H,B,S,U,F,Q,z,X,J,ee,ue,ae,Ee,ce,de,se=_r,$=this!=1?ii.apply([],arguments):ni.call(arguments),ge=$.pop()||!1,pe=$.shift(),Z=pe,Se=$.length;if(ge+""===ge&&(ae=ge,ue=$.pop(),Ee=$.pop(),ge=!!$.pop(),Se-=3),ge===!!ge&&(M=ge,ge=$[Se-1],ge=Se&&ge+""!==ge&&(!ge||f(ge))?(Se--,$.pop()):void 0,M&&!Se&&f(pe)&&(ge=pe,pe=void 0)),k=ge,Se&&f($[Se-1])&&(Q=F=k,k=$.pop(),Se--),!(M&&k&&!k._cId)){for(se+=k?(H=k._inId||"",M?k._cId+H:(q=pn(k))+H):"",q&&!M&&(X=at[q]=at[q]||{}),ce=i&&i.match(vr)||[""],de=ce.length;de--;){if(i=ce[de],pe&&(x=$[0],!x||x+""!==x)&&(d(pe)?T(pe,M,!0):M&&p(se,"")),M&&!Se&&!pe)for(L in at){L=at[L];for(S in L)Z=L[S],d(Z)?T(Z,M,M):p(se,"")}for(J=0,b=0;b<Se;b++)if(x=$[b],x!==""){if(x&&x._cp&&(F=D._gccb(x[0]),u=pe=x[0].data,x=x[1]),Z=pe,""+x===x){if(C=x.split("^"),C[1]&&(J=C[0].split(".").length,x=C.join("."),J=x.split(".").length-J),F&&(z=F(x,pe,J),F=Q),z){Se+=z.length-1,un.apply($,[b--,1].concat(z));continue}C=x.split(".")}else f(x)||(x&&x._jsv?(ee=M?x.cb:v(x),ee.noArray=!r,ee._cId=k._cId,ee._inId=ee._inId||".obIn"+Er++,(x.bnd||x.prm&&x.prm.length||!x.sb)&&e([Z],x.path,[u],x.prm,ee,F,M),x.sb&&e([x.ob],x.sb,k,F,M),x=u,Z=void 0):Z=x),C=[pe=x];for(;Z&&(w=C.shift())!==void 0;)if(typeof Z===We){if(""+w===w){if(w==="")continue;if(C.length<J+1&&!Z.nodeType){if(!M&&(U=cn(Z)&&n._data(Z))){for(U=U.events,U=U&&U[rt],B=U&&U.length,N=0;B--;)S=U[B].data,S&&S.ns===i&&S.cb._cId===k._cId&&S.cb._inId===k._inId&&(S.prop===w||S.prop==="*"||S.prop==="**")&&((L=C.join("."))&&S.paths.push(L),N++);if(N){Z=Z[w];continue}}if(w==="*"||w==="**"){if(!M&&U&&U.length&&p(se,"",!1,!0),w==="*"){p(se,"");for(L in Z)L!==t&&T(Z,M,void 0,L)}else n.observable(i,Z)[(M?"un":"")+"observeAll"](k);break}else w&&p(se+".p_"+w,C.join("^"))}ae&&(ae+="."+w),w=Z[w]}if(f(w)){(O=w.depends)&&e([Z],oi(O,Z,k),k,F,M);break}Z=w,M&&Z===pe&&(b>Se-2||$[b+1]+""!==$[b+1])&&p(se,"")}T(Z,M)}}return q&&ai(X,q),{cbId:q,bnd:X}}}var i,r=this!=!1,l=ni.call(arguments),u=l[0];return u+""===u&&r&&(i=u,l.shift(),u=l[0]),e.apply(1,l)},a=function(e,i){return arguments.length===1&&(i=e,e=""),d(i)?new hn(e,i):new fn(e,i)},D.getDeps=function(){var e=arguments;return function(){for(var i,r,l=[],u=e.length;u--;)i=e[u--],r=e[u],r&&(l=l.concat(f(r)?r(i,i):r));return l}},n.observable=a,a._fltr=function(e,i,r,l){if(!(l&&f(l))||l(e,i,r))return i=f(i)?i.set&&i.call(r[0]):i,typeof i===We&&i},a.Object=fn,a.Array=hn,n.observe=a.observe=I,n.unobserve=a.unobserve=Tr,a._apply=Tt,fn.prototype={_data:null,observeAll:dn,unobserveAll:li,data:function(){return this._data},setProperty:function(e,i,r){e=e||"";var l,u,p,v=e+""!==e,T=this,b=T._data;if(b){if(v)if(r=i,d(e))for(l=e.length;l--;)u=e[l],T.setProperty(u.name,u.value,r===void 0||r);else for(l in e)T.setProperty(l,e[l],r);else if(e!==t){for(p=e.split(/[.^]/);b&&p.length>1;)b=b[p.shift()];b&&T._setProperty(b,p[0],i,r)}}return T},removeProperty:function(e){return this.setProperty(e,ri),this},_setProperty:function(e,i,r,l){var u,p,v,T=i?e[i]:e;f(T)&&T.set&&(e=e._wrp||e,p=T,u=p.set===!0?p:p.set,T=p.call(e)),(T!==r||l&&T!=r)&&(!(T instanceof Date)||T>r||T<r)&&(u?(u.call(e,r),r=p.call(e)):(v=r===ri)?T!==void 0?(delete e[i],r=void 0):i=void 0:i&&(e[i]=r),i&&this._trigger(e,{change:"set",path:i,value:r,oldValue:T,remove:v}))},_trigger:function(e,i){n(e).triggerHandler(rt+(this._ns?"."+/^\S+/.exec(this._ns)[0]:""),i)}},hn.prototype={_data:null,observeAll:dn,unobserveAll:li,data:function(){return this._data},insert:function(e,i){var r=this._data;return arguments.length===1&&(i=e,e=r.length),e=gt(e),e>-1&&(i=d(i)?i:[i],i.length&&this._insert(e,i)),this},_insert:function(e,i){var r=this._data,l=r.length;e>l&&(e=l),un.apply(r,[e,0].concat(i)),this._trigger({change:"insert",index:e,items:i},l)},remove:function(e,i){var r,l=this._data;return e===void 0&&(e=l.length-1),e=gt(e),i=i?gt(i):i===0?0:1,i>0&&e>-1&&(r=l.slice(e,e+i),(i=r.length)&&this._remove(e,i,r)),this},_remove:function(e,i,r){var l=this._data,u=l.length;l.splice(e,i),this._trigger({change:"remove",index:e,items:r},u)},move:function(e,i,r){return r=r?gt(r):r===0?0:1,e=gt(e),i=gt(i),r>0&&e>-1&&i>-1&&e!==i&&this._move(e,i,r),this},_move:function(e,i,r){var l,u=this._data,p=u.length,v=e+r-p;v>0&&(r-=v),r&&(l=u.splice(e,r),i>u.length&&(i=u.length),un.apply(u,[i,0].concat(l)),this._trigger({change:"move",oldIndex:e,index:i,items:l},p))},refresh:function(e,i){function r(){p&&(b.insert(u-p,L),x+=p,l+=p,p=0,L=[])}var l,u,p,v,T,b=this,L=[],N=b._data,C=N.slice(),w=N.length,x=w,O=e.length;for(b._srt=!0,u=p=0;u<O;u++)if((v=e[u])===N[u-p])r();else{for(l=u-p;l<x&&v!==N[l];l++);if(l<x){for(r(),T=0;T++<O-l&&e[u+T]===N[l+T];);b.move(l,u,T),u+=T-1}else p++,L.push(v)}return r(),x>u&&b.remove(u,x-u),b._srt=void 0,b._trigger({change:"refresh",oldItems:C},w),b},_trigger:function(e,i){var r=this,l=r._data,u=l.length,p=n([l]);r._srt?e.refresh=!0:u!==i&&p.triggerHandler(rt,{change:"set",path:"length",value:u,oldValue:i}),p.triggerHandler(ot+(r._ns?"."+/^\S+/.exec(r._ns)[0]:""),e)}},ti[rt]=ti[ot]={remove:function(e){var i,r,l,u,p,v=e.data;if(v&&(v.off=!0,v=v.cb)&&(i=at[v._cId])){for(l=n._data(this).events[e.type],u=l.length;u--&&!r;)r=(p=l[u].data)&&p.cb&&p.cb._cId===v._cId;r||(delete i[pt(this).obId],ai(i,v._cId))}}},m.map=function(e){function i(r,l,u,p){var v,T=this;this.src&&this.unmap(),typeof r===We&&(T.src=r,T.tgt=u||T.tgt||[],T.options=l||T.options,T.update(),p||(e.obsSrc&&a(T.src).observeAll(T.obs=function(b,L){v||(v=!0,e.obsSrc(T,b,L),v=void 0)},T.srcFlt),e.obsTgt&&a(T.tgt).observeAll(T.obt=function(b,L){v||(v=!0,e.obsTgt(T,b,L),v=void 0)},T.tgtFlt)))}return f(e)&&(e={getTgt:e}),e.baseMap&&(e=n.extend({},e.baseMap,e)),e.map=function(r,l,u,p){return new i(r,l,u,p)},(i.prototype={srcFlt:e.srcFlt||ci,tgtFlt:e.tgtFlt||ci,update:function(r){var l=this;a(l.tgt).refresh(e.getTgt(l.src,l.options=r||l.options))},unmap:function(){var r=this;r.src&&(r.obs&&a(r.src).unobserveAll(r.obs,r.srcFlt),r.obt&&a(r.tgt).unobserveAll(r.obt,r.tgtFlt),r.src=void 0)},map:i,_def:e}).constructor=i,e},D.advSet=function(){D._gccb=this._gccb,g._jsv=G.advanced._jsv?{cbBindings:at}:void 0}}if(K=m.settings,G=D.settings,V=G.advanced,R=m.converters,n.templates=E=m.templates,j=m.tags,$t=/<(?!script)(\w+)[>\s]/,n.link)return n;G.trigger=!0;var vt,_t,At,Ze,pi,Ge,Xe,fi,je="data-jsv",hi="change.jsv",gn="onBeforeChange",vn="onAfterChange",di="onAfterCreate",ft="checked",jt="checkbox",yt="radio",bt="none",kt="SCRIPT",Ot="true",gi='"><\/script>',vi='<script type="jsv',_i=je+"-df",_n="script,["+je+"]",yn={value:"val",input:"val",html:Ve,text:"text"},yi={from:"value",to:"value"},mn=0,Ar=n.cleanData,mi=K.delimiters,Ei=document.createDocumentFragment(),En=document.querySelector,In={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},br={tr:"table"},Tn={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},Ii={},ke={},Ti=1,Or=/^#(view\.?)?/,Cr=/((\/>)|<\/(\w+)>|)(\s*)([#\/]\d+(?:_|(\^)))`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>)|$)/g,Ai=/(#)()(\d+)(_)/g,Lr=/(#)()(\d+)([_^])/g,bi=/(?:(#)|(\/))(\d+)(_)/g,Sr=/(#)()(\d+)(\^)/g,xr=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,Nr=/&(\d+)\+?/g,Oi=g.getComputedStyle;if(a=n.observable,!a)throw requiresStr+"JsObservable";I=a.observe;function ht(e,i,r){for(var l,u,p,v,T,b,L,N,C,w,x,O,M,k,q,H,B,S,U=e.target,F=U._jsvBnd;w=Nr.exec(F);)if((w=ke[w[1]])&&(q=w.to)){if(v=w.linkCtx,C=v.view,k=v.tag||C.tag,N=n(U),O=C.hlp(gn),M=C.hlp(vn),p=Ct(U),l=yn[p],r===void 0&&(r=f(p)?p(U):l?N[l]():N.attr(p)),b=q[1],q=q[0],q=q+""===q?[v.data,q]:q,b&&(f(b)?T=b:T=C.getRsc("converters",b)),v.elem.nodeName==="SELECT"&&(v.elem._jsvSel=r=r||(v.elem.multiple?[]:r)),T&&(r=T.call(k,r)),x=C.linkCtx,C.linkCtx=v,H={change:"change",oldValue:v._val,value:r},(!O||!(u=O.call(v,e,H)===!1))&&(!k||!k.onBeforeChange||!(u=k.onBeforeChange(e,H)===!1))&&r!==void 0&&(L=q[0],r!==void 0&&L)){if(L._jsv)for(S=v._ctxCb,B=L,L=v.data,B._cpCtx&&(L=B.data,S=B._cpCtx);B&&B.sb;)L=S(B,L),B=B.sb;k&&(k._.chging=!0),a(L).setProperty(q[1],r),M&&M.call(v,e,H),k&&(k.onAfterChange&&k.onAfterChange(e,H),k._.chging=void 0),v._val=r}C.linkCtx=x}}function Rr(e,i,r){var l,u,p,v,T,b,L=this,N=L.tag,C=L.data,w=L.elem,x=L.convert,O=w.parentNode,M=L.view,k=M.linkCtx,q=M.hlp(gn);if(M.linkCtx=L,O&&(!q||!(i&&q.call(L,e,i)===!1))&&!(i&&e.data.prop!=="*"&&e.data.prop!==i.path)){if(i&&(L.eventArgs=i),i||L._toLk){if(L._toLk=0,r._er)try{u=r(C,M)}catch(H){T=r._er,b=Qn(H,M,new Function("data,view","return "+T+";")(C,M)),u=[{props:{},args:[b]}]}else u=r(C,M,D);if(l=wr(u,L,N=L.tag,L.attr||Ct(w,!0,x!==void 0)),N){if(v=T||N._er,u=u[0]?u:[u],p=!v&&i&&N.onUpdate&&N.onUpdate(e,i,u)===!1,Mi(N,u,v),p||l===bt){Gt(N,e,i),xi(L,C,w),M.linkCtx=k;return}if(N._.chging)return;N.onUnbind&&N.onUnbind(N.tagCtx,L,N.ctx,e,i),u=N.tagName===":"?D._cnvt(N.cvt,M,u[0]):D._tag(N,M,M.tmpl,u,!0,b)}else r._tag&&(x=x===""?Ot:x,u=x?D._cnvt(x,M,u[0]||u):D._tag(r._tag,M,M.tmpl,u,!0,b),St(N=L.tag,!0),l=L.attr||l);Ci(u,L,l,N)&&i&&(q=M.hlp(vn))&&q.call(L,e,i),L._noUpd=0,N&&(N._er=T,Gt(N,e,i))}xi(L,C,w),M.linkCtx=k}}function wr(e,i,r,l){var u,p,v,T,b=r&&r.parentElem||i.elem;if(e!==void 0){if(T=n(b),l=r&&r.attr||l,f(e)&&Ke(i.expr+": missing parens"),v=/^css-/.test(l)&&l.slice(4))u=n.style(b,v),+e===e&&(u=parseInt(u));else if(l!=="link"){if(l==="value")b.type===jt&&(u=T.prop(l=ft));else if(l===yt)if(b.value===""+e)u=T.prop(ft);else return l;u===void 0&&(p=yn[l],u=p?T[p]():T.attr(l))}i._val=u}return l}function qe(e,i){e._df=i,e[(i?"set":"remove")+"Attribute"](_i,"")}function Ci(e,i,r,l){var u,p,v,T,b,L,N,C,w,x,O,M,k,q,H=r!==bt&&e!==void 0&&!i._noUpd,B=i.data,S=l&&l.parentElem||i.elem,U=S.parentNode,F=n(S),Q=i.view,z=i._val,X=Q.linkCtx,J=l;if(l&&(l._.unlinked=!0,l.parentElem=l.parentElem||i.expr||l._elCnt?S:U,p=l._prv,v=l._nxt),!!H)return r==="visible"&&(r="css-display"),/^css-/.test(r)?(i.attr==="visible"&&(k=(S.currentStyle||Oi.call(g,S,"")).display,e?(e=S._jsvd||k,e===bt&&!(e=Ii[M=S.nodeName])&&(O=document.createElement(M),document.body.appendChild(O),e=Ii[M]=(O.currentStyle||Oi.call(g,O,"")).display,document.body.removeChild(O))):(S._jsvd=k,e=bt)),(J=J||z!==e)&&n.style(S,r.slice(4),e)):r!=="link"&&(/^data-/.test(r)&&n.data(S,r.slice(5),e),r===ft?(L=!0,e=e&&e!=="false"):r===yt?(L=!0,r=ft,e=S.value===""+e):r==="selected"||r==="disabled"||r==="multiple"||r==="readonly"?e=e&&e!=="false"?r:null:r==="value"&&S.nodeName==="SELECT"&&(S._jsvSel=d(e)?e:""+e),(u=yn[r])?r===Ve?(Q.linkCtx=i,l&&l._.inline?(b=l.nodes(!0),l._elCnt&&(p&&p!==v?Sn(p,v,S,l._tgId,"^",!0):(N=S._df)&&(C=l._tgId+"^",w=N.indexOf("#"+C)+1,x=N.indexOf("/"+C),w&&x>0&&(w+=C.length,x>w&&(qe(S,N.slice(0,w)+N.slice(x)),Ui(N.slice(w,x))))),p=p?p.previousSibling:v?v.previousSibling:S.lastChild),n(b).remove(),T=Q.link(Q.data,S,p,v,e,l&&{tag:l._tgId,lazyLink:l.tagCtx.props.lazyLink})):(H=H&&z!==e,H&&F.empty(),H&&(T=Q.link(B,S,p,v,e,l&&{tag:l._tgId}))),Q.linkCtx=X):((J=J||z!==e)&&(r==="text"&&S.children&&!S.children[0]?S.textContent!==void 0?S.textContent=e:S.innerText=e===null?"":e:F[u](e)),(q=U._jsvSel)&&(r==="value"||!F.attr("value"))&&(S.selected=n.inArray(""+e,d(q)?q:[q])>-1)):(J=J||z!==e)&&F[L?"prop":"attr"](r,e===void 0&&!L?null:e),i._val=e),T||J}function Li(e,i){var r=this,l=r.hlp(gn),u=r.hlp(vn);if(!l||l.call(this,e,i)!==!1){if(i){var p=i.change,v=i.index,T=i.items;switch(r._.srt=i.refresh,p){case"insert":r.addViews(v,T);break;case"remove":r.removeViews(v,T.length);break;case"move":r.removeViews(i.oldIndex,T.length,void 0,!0),r.addViews(v,T);break;case"refresh":r._.srt=void 0,r.fixIndex(0)}}u&&u.call(this,e,i)}}function An(e){var i,r,l=e.type,u=e.data,p=e._.bnd;!e._.useKey&&p&&((r=e._.bndArr)&&(n([r[1]]).off(ot,r[0]),e._.bndArr=void 0),p!==!!p?l?p._.arrVws[e._.id]=e:delete p._.arrVws[e._.id]:l&&u&&(i=function(v){v.data&&v.data.off||Li.apply(e,arguments)},n([u]).on(ot,i),e._.bndArr=[i,u]))}function Ct(e,i,r){var l=e.nodeName.toLowerCase(),u=V._fe[l]||e.contentEditable===Ot&&{to:Ve,from:Ve};return u?i?l==="input"&&e.type===yt?yt:u.to:u.from:i?r?"text":Ve:""}function Si(e,i,r,l,u,p,v){var T,b,L,N,C,w=e.parentElem,x=e._prv,O=e._nxt,M=e._elCnt;if(x&&x.parentNode!==w&&Ke("Missing parentNode"),v){N=e.nodes(),M&&x&&x!==O&&Sn(x,O,w,e._.id,"_",!0),e.removeViews(void 0,void 0,!0),b=O,M&&(x=x?x.previousSibling:O?O.previousSibling:w.lastChild),n(N).remove();for(C in e._.bnds)qt(C)}else{if(i){if(L=l[i-1],!L)return!1;x=L._nxt}M?(b=x,x=b?b.previousSibling:w.lastChild):b=x.nextSibling}T=r.render(u,p,e._.useKey&&v,e,v||i,!0),e.link(u,w,x,b,T,L)}function bn(e,i,r){var l,u;return r?(u="^`",St(r,!0),l=r._tgId,l||(ke[l=Ti++]=r,r._tgId=""+l)):(u="_`",St(Xe[l=i._.id]=i)),"#"+l+u+(e!=null?e:"")+"/"+l+u}function xi(e,i,r){var l,u,p,v,T,b,L,N,C=e.tag,w=e.convertBack,x=[],O=e._bndId||""+Ti++,M=e._hdl;if(e._bndId=void 0,C&&(x=C.depends||x,x=f(x)?C.depends(C):x,v=C.linkedElem),!e._depends||""+e._depends!=""+x){if(e._depends&&a._apply(!1,[i],e._depends,M,!0),T=e.fn.deps.slice(),C&&C.boundProps)for(u=C.boundProps.length;u--;)for(L=C.boundProps[u],p=C._.bnd.paths.length;p--;)N=C._.bnd.paths[p][L],N&&N.skp&&(T=T.concat(N));for(u=T.length;u--;)b=T[u],b._jsv&&(T[u]=me({},b));if(l=a._apply(!1,[i],T,x,M,e._ctxCb),l.elem=r,l.linkCtx=e,l._tgId=O,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+O,e._depends=x,e.view._.bnds[O]=O,ke[O]=l,v)for(u=v.length;u--;)v[u]._jsvLkEl=C,Ht(l,C,v[u]),v[u]._jsvBnd="&"+l._tgId+"+";else w!==void 0&&Ht(l,C,r,w);C&&!C.flow&&!C._.inline&&(r.setAttribute(je,(r.getAttribute(je)||"")+"#"+O+"^/"+O+"^"),C._tgId=""+O)}}function Ni(e,i,r,l,u,p,v){return On(this,e,i,r,l,u,p,v)}function On(e,i,r,l,u,p,v,T){if(l===!0?(u=l,l=void 0):typeof l!="object"?l=void 0:l=me({},l),e&&i){i=i.jquery?i:n(i),vt||(vt=document.body,n(vt).on(hi,ht).on("blur","[contenteditable]",ht));for(var b,L,N,C,w,x,O,M,k,q=bn,H=l&&l.target==="replace",B=i.length;B--;){if(O=i[B],p=p||At(O),(k=p===h)&&(h.data=(h.ctx=l||{}).root=r),""+e===e)Cn(e,O,p,void 0,!0,r,l);else{if(e.markup!==void 0)H&&(x=O.parentNode),N=e.render(r,l,u,p,void 0,q),x?(v=O.previousSibling,T=O.nextSibling,n.cleanData([O],!0),x.removeChild(O),O=x):(v=T=void 0,n(O).empty());else if(e===!0&&p===h)M={lnk:1};else break;if(O._df&&!T){for(C=Fe(O._df,!0,Ai),b=0,L=C.length;b<L;b++)w=C[b],(w=Xe[w.id])&&w.data!==void 0&&w.parent.removeViews(w._.key,void 0,!0);qe(O)}p.link(r,O,v,T,N,M,l)}k&&(h.data=h.ctx=void 0)}}return i}function Pr(e,i,r,l,u,p,v,T){function b(xe,ie,fe,Ce,De,Ue,tt,Yt,mt,Nt,Et,Gr,Nn,Hr){var Rt,Gi,Rn="";return Hr?(w=0,xe):(O=mt||Nt||"",Ce=Ce||Et,fe=fe||Nn,Ie&&!fe&&(!xe||Ce||O||Ue&&!w)&&(Ie=void 0,te=Qe.shift()),Ce=Ce||fe,Ce&&(w=0,Ie=void 0,se&&(fe||Nn?!Tn[te]&&!/;svg;|;math;/.test(";"+Qe.join(";")+";")&&(Rt="'<"+te+".../"):Tn[Ce]?Rt="'</"+Ce:(!Qe.length||Ce!==te)&&(Rt="Mismatch: '</"+Ce),Rt&&Re(Rt+`>' in:
`+u)),ve=re,te=Qe.shift(),re=In[te],Et=Et?"</"+Et+">":"",ve&&(He+=Ae,Ae="",re?He+="-":(Rn=Et+vi+"@"+He+gi+(Gr||""),He=ki.shift()))),re?(Ue?Ae+=Ue:ie=Et||Nn||"",O&&(ie+=O,Ae&&(ie+=" "+je+'="'+Ae+'"',Ae=""))):ie=Ue?ie+Rn+De+(w?"":vi+Ue+gi)+Yt+O:Rn||xe,se&&tt&&(w&&Re("{^{ within elem markup ("+w+' ). Use data-link="..."'),Ue.charAt(0)==="#"?Qe.unshift(Ue.slice(1)):Ue.slice(1)!==(Gi=Qe.shift())&&Re("Closing tag for {^{...}} under different elem: <"+Gi+">")),O&&(w=O,Qe.unshift(te),te=O.slice(1),se&&Qe[0]&&Qe[0]===br[te]&&Ke("Parent of <tr> must be <tbody>"),Ie=Tn[te],(re=In[te])&&!ve&&(ki.unshift(He),He=""),ve=re,He&&re&&(He+="+")),ie)}function L(xe,ie){var fe,Ce,De,Ue,tt,Yt,mt,Nt=[];if(xe){for(xe._tkns.charAt(0)==="@"&&(ie=S.previousSibling,S.parentNode.removeChild(S),S=void 0),H=xe.length;H--;){if(F=xe[H],De=F.ch,fe=F.path)for(q=fe.length-1;Ce=fe.charAt(q--);)Ce==="+"?fe.charAt(q)==="-"?(q--,ie=ie.previousSibling):ie=ie.parentNode:ie=ie.lastChild;De==="^"?(O=ke[tt=F.id])&&(mt=ie&&(!S||S.parentNode!==ie),(!S||mt)&&(O.parentElem=ie),F.elCnt&&mt&&qe(ie,(F.open?"#":"/")+tt+De+(ie._df||"")),Nt.push([mt?null:S,F])):(U=Xe[tt=F.id])&&(U.parentElem||(U.parentElem=ie||S&&S.parentNode||i,U._.onRender=bn,U._.onArrayChange=Li,An(U)),Ue=U.parentElem,F.open?(U._elCnt=F.elCnt,ie&&!S?qe(ie,"#"+tt+De+(ie._df||"")):(U._prv||qe(Ue,Ft(Ue._df,"#"+tt+De)),U._prv=S)):(ie&&(!S||S.parentNode!==ie)?(qe(ie,"/"+tt+De+(ie._df||"")),U._nxt=void 0):S&&(U._nxt||qe(Ue,Ft(Ue._df,"/"+tt+De)),U._nxt=S),(Yt=U.ctx&&U.ctx[di]||Fr)&&Yt.call(U.ctx.tag,U)))}for(H=Nt.length;H--;)xt.push(Nt[H])}return!xe||xe.elCnt}function N(xe){var ie,fe,Ce;if(xe){for(H=xe.length,q=0;q<H;q++)if(F=xe[q],fe=O=ke[F.id].linkCtx.tag,Ce=O.tagName===ce,!O.flow||Ce){if(!Ee){for(ie=1;fe=fe.parent;)ie++;$=$||ie}(Ee||ie===$)&&(!ce||Ce)&&ae.push(O)}}}function C(){var xe,ie,fe="",Ce={},De=pi+(Me?",["+_i+"]":"");for(B=En?i.querySelectorAll(De):n(De,i).get(),k=B.length,r&&r.innerHTML&&(z=En?r.querySelectorAll(De):n(De,r).get(),r=z.length?z[z.length-1]:r),$=0,M=0;M<k;M++)if(S=B[M],r&&!st)st=S===r;else if(l&&S===l){Me&&(fe+=Lt(S));break}else if(S.parentNode)if(Me){if(fe+=Lt(S),S._df){for(xe=M+1;xe<k&&S.contains(B[xe]);)xe++;Ce[xe-1]=S._df}Ce[M]&&(fe+=Ce[M]||"")}else et&&(F=Fe(S,void 0,bi))&&(F=F[0])&&(ze=ze?F.id!==ze&&ze:F.open&&F.id),!ze&&Fi(Fe(S))&&S.getAttribute(Ze)&&xt.push([S]);if(Me&&(fe+=i._df||"",(ie=fe.indexOf("#"+Me.id)+1)&&(fe=fe.slice(ie+Me.id.length)),ie=fe.indexOf("/"+Me.id),ie+1&&(fe=fe.slice(0,ie)),N(Fe(fe,void 0,Sr))),u===void 0&&i.getAttribute(Ze)&&xt.push([i]),wi(r,re),wi(l,re),Me){Je&&Je.resolve();return}for(re&&He+Ae&&(S=l,He&&(l?L(Fe(He+"+",!0),l):L(Fe(He,!0),i)),L(Fe(Ae,!0),i),l&&(fe=l.getAttribute(je),(k=fe.indexOf(we)+1)&&(fe=fe.slice(k+we.length-1)),l.setAttribute(je,Ae+fe))),k=xt.length,M=0;M<k;M++)S=xt[M],Q=S[1],S=S[0],Q?(O=ke[Q.id])&&((x=O.linkCtx)&&(O=x.tag,O.linkCtx=x),Q.open?(S&&(O.parentElem=S.parentNode,O._prv=S),O._elCnt=Q.elCnt,U=O.tagCtx.view,Cn(void 0,O._prv,U,Q.id)):(O._nxt=S,O._.unlinked&&(de=O.tagCtx,U=de.view,Gt(O)))):Cn(S.getAttribute(Ze),S,At(S),void 0,et,e,v);Je&&Je.resolve()}var w,x,O,M,k,q,H,B,S,U,F,Q,z,X,J,ee,ue,ae,Ee,ce,de,se,$,ge,pe,Z,Se,te,Ie,Te,ne,le,re,ve,Ne,Ae,we,st,ze,Je,et,Me,xn=this,ji=xn._.id+"_",He="",xt=[],Qe=[],ki=[],Fr=xn.hlp(di),Fi=L;if(p&&(Je=p.lazyLink&&n.Deferred(),p.tmpl?J="/"+p._.id+"_":(et=p.lnk,p.tag&&(ji=p.tag+"^",p=!0),(Me=p.get)&&(Fi=N,ae=Me.tags,Ee=Me.deep,ce=Me.name)),p=p===!0),i=i?""+i===i?n(i)[0]:i.jquery?i[0]:i:xn.parentElem||document.body,se=!V.noValidate&&i.contentEditable!==Ot,te=i.tagName.toLowerCase(),re=!!In[te],r=r&&Pi(r,re),l=l&&Pi(l,re)||null,u!=null){if(ne=document.createElement("div"),Te=ne,we=Ae="",Ne=i.namespaceURI==="http://www.w3.org/2000/svg"?"svg_ns":(Se=$t.exec(u))&&Se[1]||"",re){for(ue=l;ue&&!(ee=Fe(ue));)ue=ue.nextSibling;(le=ee?ee._tkns:i._df)&&(X=J||"",(p||!J)&&(X+="#"+ji),q=le.indexOf(X),q+1&&(q+=X.length,we=Ae=le.slice(0,q),le=le.slice(q),ee?ue.setAttribute(je,le):qe(i,le)))}if(Ie=void 0,u=(""+u).replace(Cr,b),se&&Qe.length&&Re("Mismatched '<"+te+`...>' in:
`+u),T)return;for(Ei.appendChild(ne),Ne=Ge[Ne]||Ge.div,ge=Ne[0],Te.innerHTML=Ne[1]+u+Ne[2];ge--;)Te=Te.lastChild;for(Ei.removeChild(ne),pe=document.createDocumentFragment();Z=Te.firstChild;)pe.appendChild(Z);i.insertBefore(pe,l)}return Je?setTimeout(C,0):C(),Je&&Je.promise()}function Cn(e,i,r,l,u,p,v){var T,b,L,N,C,w,x,O,M,k,q,H=[];if(l)O=ke[l],O=O.linkCtx?O.linkCtx.tag:O,x=O.linkCtx||{type:"inline",data:r.data,elem:O._elCnt?O.parentElem:i,view:r,ctx:r.ctx,attr:Ve,fn:O._.bnd,tag:O,_bndId:l},Ri(x,x.fn);else if(e&&i){for(p=u?p:r.data,T=r.tmpl,e=Mr(e,Ct(i)),q=_t.lastIndex=0;b=_t.exec(e);)H.push(b),q=_t.lastIndex;for(q<e.length&&Re(e);b=H.shift();){for(M=_t.lastIndex,L=b[1],C=b[3];H[0]&&H[0][4]==="else";)C+=Pe+Y+H.shift()[3],k=!0;k&&(C+=Pe+Y+W+"/"+b[4]+oe),x={type:u?"top":"link",data:p,elem:i,view:r,ctx:v,attr:L,isLk:u,_toLk:1,_noUpd:b[2]},N=void 0,b[6]&&(N=b[10]||void 0,x.convert=b[5]||"",!L&&N!==void 0&&Ct(i)&&(x.convertBack=N=N.slice(1))),x.expr=L+C,w=T.links[C],w||(T.links[C]=w=D.tmplFn(C,T,!0,N,k)),x.fn=w,Ri(x,w),_t.lastIndex=M}}}function Ri(e,i){function r(l,u){Rr.call(e,l,u,i)}r.noArray=!0,e.isLk&&St(e.view=new D.View(D.extendCtx(e.ctx,e.view.ctx),"link",e.view,e.data,e.expr,void 0,bn)),e._ctxCb=D._gccb(e.view),e._hdl=r,r(!0)}function Ft(e,i){var r;return e?(r=e.indexOf(i),r+1?e.slice(0,r)+e.slice(r+i.length):e):""}function Lt(e){return e&&(""+e===e?e:e.tagName===kt?e.type.slice(3):e.nodeType===1&&e.getAttribute(je)||"")}function Fe(e,i,r){function l(T,b,L,N,C,w){v.push({elCnt:u,id:N,ch:C,open:b,close:L,path:w,token:T})}var u,p,v=[];if(p=i?e:Lt(e))return u=v.elCnt=e.tagName!==kt,u=p.charAt(0)==="@"||u,v._tkns=p,p.replace(r||xr,l),v}function wi(e,i){e&&(e.type==="jsv"?e.parentNode.removeChild(e):i&&e.getAttribute(Ze)===""&&e.removeAttribute(Ze))}function Pi(e,i){for(var r=e;i&&r&&r.nodeType!==1;)r=r.previousSibling;return r&&(r.nodeType!==1?(r=document.createElement(kt),r.type="jsv",e.parentNode.insertBefore(r,e)):!Lt(r)&&!r.getAttribute(Ze)&&r.setAttribute(Ze,"")),r}function Mr(e,i){return e=n.trim(e).replace(Dn,"\\$&"),e.slice(-1)!==oe?e=W+":"+e+(i?":":"")+oe:e}function Gt(e,i,r){var l,u,p,v,T,b,L=e.tagCtx;L.view;var N=L.props,C=e.linkCtx;if(e._.unlinked&&(e.linkedElement!==void 0&&(e.linkedElem=e._.inline?e.contents(!0,e.linkedElement||"*").first():n(C.elem)),e.onBind&&e.onBind(L,C,e.ctx,i,r)),e.onAfterLink&&e.onAfterLink(L,C,e.ctx,i,r),l=e.targetTag?e.targetTag.linkedElem:e.linkedElem,u=e.displayElem||l,l&&l[0]){if(v=e.cvtArgs()[0],v!==void 0&&!e._.chging)for(T=l.length;T--;)p=l[T],e._.unlinked&&p!==C.elem&&(b=p._jsvLkEl,e._.inline&&(!b||b!==e&&b.targetTag!==e)&&(p._jsvLkEl=e,Ht(ke[e._tgId],e,p),p._jsvBnd="&"+e._tgId+"+")),v!==void 0&&(p.value!==void 0?p.type===jt?p[ft]=v&&v!=="false":p.type===yt?p[ft]=p.value===v:n(p).val(v):p.contentEditable===Ot&&(p.innerHTML=v),C._val=v),N.name&&(p.name=p.name||N.name);e.setSize&&(N.height&&u.height(N.height),N.width&&u.width(N.width)),N.title!==void 0&&u.attr("title",N.title),N.class&&(r&&u.hasClass(r.oldValue)&&u.removeClass(r.oldValue),u.addClass(N.class)),N.id&&(l[0].id=N.id)}e._.unlinked=void 0}function Dr(e){setTimeout(function(){ht(e)},0)}function Ln(e,i,r){i&&(i=""+i===i?i:"keydown",e[r](i,i==="keydown"?Dr:ht))}function Ht(e,i,r,l){var u,p,v,T,b,L,N,C,w,x=e.linkCtx,O=x._ctxCb,M=x.data,k=x.fn.paths[0];if(i=i||r._jsvLkEl,e&&k&&!e.to){if(N=r._jsvTr||!1,i&&(l=i.convertBack||l,L=i.tagCtx.props.trigger),L=L===void 0?G.trigger:L,L=L&&(r.tagName==="INPUT"&&r.type!==jt&&r.type!==yt||r.type==="textarea"||r.contentEditable===Ot)&&L||!1,N!==L&&(b=n(r),Ln(b,N,"off"),Ln(b,r._jsvTr=L,"on")),k=k._jsvto||k[0],u=k&&k.length){if(v=k[u-1],v._jsv){for(T=v;v.sb&&v.sb._jsv;)p=v=v.sb;p=v.sb||p&&p.path,v=p?p.slice(1):T.path}if(p)C=[T,v];else{for(;(C=O(p=v.split("^").join("."),M))&&(w=C.length);){if(C[0]._cp){if(C=C[0],O=D._gccb(C[0]),v=C[1],C=[C[0].data,C[1]],v._jsv){for(T=v,T.data=C[0],T._cpCtx=O;v.sb&&v.sb._jsv;)p=v=v.sb;p=v.sb||p&&p.path,v=p?p.slice(1):T.path,C=[T,v]}}else C=w>2?[C[w-3],C[w-2]]:[C[w-2]];M=C[0],v=C[1]}C=C||[M,p]}}else C=[];e.to=[C,l]}}function Mi(e,i,r){var l,u,p=e.tagCtx.view,v=e.tagCtxs||[e.tagCtx],T=v.length,b=!i;if(i=i||e._.bnd.call(p.tmpl,(e.linkCtx||p).data,p,D),r)v=e.tagCtxs=i,e.tagCtx=v[0];else for(;T--;)l=v[T],u=i[T],a(l.props).setProperty(u.props),me(l.ctx,u.ctx),l.args=u.args,b&&(l.tmpl=u.tmpl);return D._ths(e,v[0]),v}function Bt(e){for(var i,r,l,u=[],p=e.length,v=p;v--;)u.push(e[v]);for(v=p;v--;)if(r=u[v],r.parentNode){if(l=r._jsvBnd)for(l=l.slice(1).split("&"),r._jsvBnd="",i=l.length;i--;)qt(l[i],r._jsvLkEl,r);Ui(Lt(r)+(r._df||""))}}function qt(e,i,r){var l,u,p,v,T,b,L,N,C,w,x,O,M=ke[e];if(i)i=i.targetTag||i,r._jsvLkEl=void 0;else if(M){delete ke[e];for(l in M.bnd)v=M.bnd[l],T=M.cbId,d(v)?n([v]).off(ot+T).off(rt+T):n(v).off(rt+T),delete M.bnd[l];if(u=M.linkCtx){if(p=u.tag){if(b=p.tagCtxs)for(L=b.length;L--;)(N=b[L].map)&&N.unmap();C=p.linkedElem,p.onUnbind&&p.onUnbind(p.tagCtx,u,p.ctx,!0),p.onDispose&&p.onDispose(),p._elCnt||(p._prv&&p._prv.parentNode.removeChild(p._prv),p._nxt&&p._nxt.parentNode.removeChild(p._nxt))}w=C&&C[0]||u.elem,(x=w&&w._jsvTr)&&(Ln(C||n(w),x,"off"),w._jsvTr=void 0),O=u.view,O.type==="link"?O.parent.removeViews(O._.key,void 0,!0):delete O._.bnds[e]}delete at[M.cbId]}}function Di(e){e?(e=e.jquery?e:n(e),e.each(function(){for(var i;(i=At(this,!0))&&i.parent;)i.parent.removeViews(i._.key,void 0,!0);Bt(this.getElementsByTagName("*"))}),Bt(e)):(vt&&(n(vt).off(hi,ht).off("blur","[contenteditable]",ht),vt=void 0),h.removeViews(),Bt(document.body.getElementsByTagName("*")))}function Ur(e){return e.type===jt?e[ft]:e.value}D.onStore.template=function(e,i){i.link=Ni,e&&(n.link[e]=function(){return Ni.apply(i,arguments)})},D.viewInfos=Fe,(K.delimiters=function(){var e=mi.apply(0,arguments);return mi!==Vt&&(e=Vt.apply(0,arguments)),_t=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+Oe+")?(\\"+W+D.rTag+"(:\\w*)?\\"+oe+")","g"),e})(),D.addSetting("trigger");function Sn(e,i,r,l,u,p){var v,T,b,L,N,C,w,x=0,O=e===i;if(e){for(b=Fe(e)||[],v=0,T=b.length;v<T;v++){if(L=b[v],C=L.id,C===l&&L.ch===u)if(p)T=0;else break;O||(N=L.ch==="_"?Xe[C]:ke[C].linkCtx.tag,L.open?N._prv=i:L.close&&(N._nxt=i)),x+=C.length+2}x&&e.setAttribute(je,e.getAttribute(je).slice(x)),w=i?i.getAttribute(je):r._df,(T=w.indexOf("/"+l+u)+1)&&(w=b._tkns.slice(0,x)+w.slice(T+(p?-1:l.length+1))),w&&(i?i.setAttribute(je,w):qe(r,w))}else qe(r,Ft(r._df,"#"+l+u)),!p&&!i&&qe(r,Ft(r._df,"/"+l+u))}function Ui(e){var i,r,l,u;if(u=Fe(e,!0,Lr))for(i=0,r=u.length;i<r;i++)l=u[i],l.ch==="_"?(l=Xe[l.id])&&l.type&&l.parent.removeViews(l._.key,void 0,!0):qt(l.id)}function St(e,i){e.contents=function(r,l){r!==!!r&&(l=r,r=void 0);var u,p=n(this.nodes());return p[0]&&(u=l?p.filter(l):p,p=r&&l?u.add(p.find(l)):u),p},e.nodes=function(r,l,u){var p,v=this,T=v._elCnt,b=!l&&T,L=[];for(l=l||v._prv,u=u||v._nxt,p=b?l===v._nxt?v.parentElem.lastSibling:l:v._.inline===!1?l||v.linkCtx.elem.firstChild:l&&l.nextSibling;p&&(!u||p!==u);)(r||T||p.tagName!==kt)&&L.push(p),p=p.nextSibling;return L},e.childTags=function(r,l){r!==!!r&&(l=r,r=void 0);var u=this,p=u.link?u:u.tagCtx.view,v=u._prv,T=u._elCnt,b=[];return p.link(void 0,u.parentElem,T?v&&v.previousSibling:v,u._nxt,void 0,{get:{tags:b,deep:r,name:l,id:u.link?u._.id+"_":u._tgId+"^"}}),b},e.refresh=function(r){var l,u,p=this,v=p.linkCtx,T=p.tagCtx.view;return p.disposed&&Ke("Removed tag"),r===void 0&&(r=D._tag(p,T,T.tmpl,Mi(p),!0)),r+""===r&&(p.onUnbind&&p.onUnbind(p.tagCtx,v,p.ctx),u=p._.inline?Ve:v.attr||Ct(p.parentElem,!0),l=Ci(r,v,u,p)),Gt(p),l||p},e.update=function(r){var l=this.linkedElem;l&&ht({target:l[0]},void 0,r)},i?e.domChange=function(){var r=this.parentElem,l=n.hasData(r)&&n._data(r).events,u="jsv-domchange";l&&l[u]&&n(r).triggerHandler(u,arguments)}:(e.addViews=function(r,l){var u,p=this,v=l.length,T=p.views;!p._.useKey&&v&&(u=T.length+v,u===p.data.length&&Si(p,r,p.tmpl,T,l,p.ctx)!==!1&&(p._.srt||p.fixIndex(r+v)))},e.removeViews=function(r,l,u,p){function v(x){var O,M,k,q,H,B,S=w[x];if(S&&S.link){if(O=S._.id,u||(B=S.nodes()),S.removeViews(void 0,void 0,!0),S.type=void 0,q=S._prv,H=S._nxt,k=S.parentElem,u||(S._elCnt&&Sn(q,H,k,O,"_"),n(B).remove()),!S._elCnt)try{q.parentNode.removeChild(q),H.parentNode.removeChild(H)}catch{}An(S);for(M in S._.bnds)qt(M);delete Xe[O]}}var T,b,L,N=this,C=!N._.useKey,w=N.views;if(C&&(L=w.length),r===void 0)if(C){for(T=L;T--;)v(T);N.views=[]}else{for(b in w)v(b);N.views={}}else if(l===void 0&&(C?l=1:(v(r),delete w[r])),C&&l&&(p||L-l===N.data.length)){for(T=r+l;T-- >r;)v(T);w.splice(r,l),N._.sort||N.fixIndex(r)}},e.refresh=function(){var r=this,l=r.parent;l&&(Si(r,r.index,r.tmpl,l.views,r.data,void 0,!0),An(r))},e.fixIndex=function(r){for(var l=this.views,u=l.length;r<u--;)l[u].index!==u&&a(l[u]).setProperty("index",u)},e.link=Pr)}R.merge=function(e){var i,r=this.linkCtx._val||"",l=this.tagCtx.props.toggle;return l&&(i=l.replace(/[\\^$.|?*+()[{]/g,"\\$&"),i="(\\s(?="+i+"$)|(\\s)|^)("+i+"(\\s|$))",r=r.replace(new RegExp(i),"$2"),e=r+(e?(r&&" ")+l:"")),e};function Vi(e){return this.tagCtx.view}j({on:{attr:bt,init:function(e){for(var i,r=this,l=0,u=e.args,p=u.length;l<p&&!f(u[l]);l++);r._hi=p>l&&l+1,r._.inline&&(D.rTmpl.exec(i=e.tmpl.markup)||(r.template="<button>"+(n.trim(i)||e.params.args[l]||"noop")+"</button>"),r.attr=Ve)},onAfterLink:function(e,i){var r,l,u,p=this,v=p._hi,T=e.args,b=T.length,L=e.props,N=L.data,C=e.view,w=L.context;v&&(r=T[v-1],l=T.slice(v),T=T.slice(0,v-1),p._sel=T[1],u=p.activeElem=p.activeElem||n(p._.inline?(p._sel=T[1]||"*",p.parentElem):i.elem),w||(w=/^(.*)[\.^][\w$]+$/.exec(e.params.args.slice(-l.length-1)[0]),w=w&&D.tmplFn(W+":"+w[1]+oe,C.tmpl,!0)(i.data,C)),p._evs&&p.onUnbind(),u.on(p._evs=T[0]||"click",p._sel,N!=null?N:null,p._hlr=function(x){var O,M=!p._.inline;if(!M)for(O=p.contents("*"),b=O.length;!M&&b--;)O[b].contains(x.target)&&(M=!0);if(M)return r.apply(w||i.data,[].concat(l,x,{change:x.type,view:C,linkCtx:i},l.slice.call(arguments,1)))}))},onUpdate:function(){return!1},onUnbind:function(){var e=this;e.activeElem&&e.activeElem.off(e._evs,e._sel,e._hlr)},flow:!0,contentCtx:Vi,dataBoundOnly:!0},radiogroup:{init:function(e){this.name=e.props.name||"jsv"+Math.random()},onBind:function(e,i){var r,l=this,u=l.linkedElem=l._.inline?l.contents(!0,"input[type=radio]"):n(i.elem).find("input[type=radio]"),p=u.length;for(l._.inline?(r=l.contents("*")[0],r=r&&n.view(r).ctx.tag===l.parent?r:l.parentElem):r=i.elem;p--;)u[p].name=u[p].name||l.name;n(r).on("jsv-domchange",function(v,T){var b,L=T.ctx.parentTags;if(!l._.inline||r!==l.parentElem||L&&L[l.tagName]===l)for(u=l.linkedElem=l.contents(!0,"input[type=radio]"),p=u.length;p--;)b=u[p],b._jsvLkEl=l,b.name=b.name||l.name,Ht(ke[l._tgId],l,b),b._jsvBnd="&"+l._tgId+"+",b.checked=l.cvtArgs()[0]===b.value})},onUpdate:function(e,i,r){return!1},contentCtx:Vi,dataBoundOnly:!0}}),me(j.for,{onArrayChange:function(e,i,r,l){var u,p=e.target,v=p.length,T=this,b=i.change;if(T._.noVws||T.tagCtxs[1]&&(b==="insert"&&v===i.items.length||b==="remove"&&!v))T.refresh();else for(u in T._.arrVws)u=T._.arrVws[u],u.data===p&&u._.onArrayChange.apply(u,arguments);T.domChange(r,l,i),e.done=!0},onAfterLink:function(e,i){var r,l,u,p,v=this,T=v._ars||{},b=v.tagCtxs,L=b.length,N=v.selected||0;for(r=0;r<=N;r++)e=b[r],p=e.map?e.map.tgt:e.args.length?e.args[0]:e.view.data,(u=T[r])&&p!==u[0]&&(I(u[0],u[1],!0),delete T[r]),!T[r]&&d(p)&&(I(p,l=function(C,w){var x=e;v.onArrayChange(C,w,x,i)}),T[r]=[p,l]);for(r=N+1;r<L;r++)(u=T[r])&&(I(u[0],u[1],!0),delete T[r]);v._ars=T},onDispose:function(){var e,i=this;for(e in i._ars)I(i._ars[e][0],i._ars[e][1],!0)}}),me(j.if,{onUpdate:function(e,i,r){var l,u,p;for(l=0;u=this.tagCtxs[l];l++)if(p=u.props.tmpl!==r[l].props.tmpl||u.args.length&&!(u=u.args[0])!=!r[l].args[0],!this.convert&&!!u||p)return p;return!1},onAfterLink:function(e,i,r,l,u){u&&this.domChange(e,i,u)}});function Vr(e,i,r){if(r.change==="set"){for(var l=e.tgt,u=l.length;u--&&l[u].key!==r.path;);u===-1?r.path&&!r.remove&&a(l).insert({key:r.path,prop:r.value}):r.remove?a(l).remove(u):a(l[u]).setProperty("prop",r.value)}}function jr(e,i,r){var l,u=e.src,p=r.change;p==="set"?r.path==="prop"?a(u).setProperty(i.target.key,r.value):(a(u).removeProperty(r.oldValue),a(u).setProperty(r.value,i.target.prop)):p==="remove"?(l=r.items[0],a(u).removeProperty(l.key),delete u[l.key]):p==="insert"&&(l=r.items[0],l.key&&a(u).setProperty(l.key,l.prop))}function kr(e){return e.indexOf(".")<0}return j("props",{baseTag:"for",dataMap:m.map({getTgt:j.props.dataMap.getTgt,obsSrc:Vr,obsTgt:jr,tgtFlt:kr}),flow:!0}),me(n,{view:At=function(e,i,r){function l(x,O){if(x)for(p=Fe(x,O,Ai),T=0,b=p.length;T<b&&!((u=Xe[p[T].id])&&(u=u&&r?u.get(!0,r):u));T++);}i!==!!i&&(r=i,i=void 0);var u,p,v,T,b,L,N,C=0,w=document.body;if(e&&e!==w&&h._.useKey>1&&(e=""+e===e?n(e)[0]:e.jquery?e[0]:e,e)){if(i){if(l(e._df,!0),!u)for(N=En?e.querySelectorAll(_n):n(_n,e).get(),L=N.length,v=0;!u&&v<L;v++)l(N[v]);return u}for(;e;){if(p=Fe(e,void 0,bi))for(L=p.length;L--;)if(u=p[L],u.open){if(C<1)return u=Xe[u.id],u&&r?u.get(r):u||h;C--}else C++;e=e.previousSibling||e.parentNode}}return h},link:On,unlink:Di,cleanData:function(e){e.length&&mn&&Bt(e),Ar.apply(n,arguments)}}),me(n.fn,{link:function(e,i,r,l,u,p,v){return On(e,this,i,r,l,u,p,v)},unlink:function(){return Di(this)},view:function(e,i){return At(this[0],e,i)}}),n.each([Ve,"replaceWith","empty","remove"],function(e,i){var r=n.fn[i];n.fn[i]=function(){var l;mn=1;try{l=r.apply(this,arguments)}finally{mn=0}return l}}),St(me(h=D.topView,{tmpl:{links:{}}})),Xe={0:h},m.getCtx=function(e){return e&&e._cp&&(e=e[1](e[0].data,e[0],D)),e},D._cp=function(e,i,r){if(r.linked){i=W+":"+i+oe;var l=r.tmpl,u=h.tmpl.links,p=u[i];p||(u[i]=p=D.tmplFn(i,l,!0)),e=[r,p],e._cp=!0}return e},D._ceo=function e(i){var r,l=i,u=i.length;if(u)for(l=[];u--;)r=i[u],r._jsv&&(r=me({},r),r.prm=e(r.prm)),l.unshift(r);return l},D._gccb=function(e){return function(i,r,l){var u,p,v,T,b,L,N;if(e&&i){if(i._jsv)return i._jsv.call(e.tmpl,r,e,D);if(i.charAt(0)==="~")return i.slice(0,4)==="~tag"&&(p=e.ctx,i.charAt(4)==="."&&(u=i.slice(5).split("."),p=p.tag),u)?p?[p,u.join("."),r]:[]:(i=i.slice(1).split("."),(T=e.hlp(b=i.shift(),!0))&&(T._cp?(i.length&&(L="."+i.join("."),b=T[N=T.length-1],b._jsv?(b.sb=L,b.bnd=!!l):(T[N]=(b+L).replace("#data.",""),b.slice(0,5)==="#view"&&(T[N]=T[N].slice(6),T.splice(N,0,e)))),v=[T]):(i.length||f(T))&&(v=[T,i.join("."),r])),v||[]);if(i.charAt(0)==="#")return i==="#data"?[]:[e,i.replace(Or,""),r]}}},fi=D.advSet,D.advSet=function(){fi.call(D),g._jsv=V._jsv?me(g._jsv||{},{views:Xe,bindings:ke}):void 0,Ze=V.linkAttr,pi=_n+",["+Ze+"]",Ge=V._wm,Ge.optgroup=Ge.option,Ge.tbody=Ge.tfoot=Ge.colgroup=Ge.caption=Ge.thead,Ge.th=Ge.td},K.advanced({linkAttr:"data-link",useViews:!1,noValidate:!1,_wm:{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],svg_ns:[1,"<svg>","</svg>"],div:n.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},_fe:{input:{from:Ur,to:"value"},textarea:yi,select:yi,optgroup:{to:"label"}}}),n},window)});function eo(_){_.fn.checkboxButton=function(c){return this.each(function(){_(this).on("click",function(o){let A=o.target.tagName,y=_(this).find(":checkbox");A!=="INPUT"&&(o.preventDefault(),y.prop("checked",!y.prop("checked")));let h=y.is(":checked");c.call(this,h)},0)})},_.fn.disable=function(){return this.each(function(){let c=_(this);c.addClass("disabled"),c.data("tabindex",c.attr("tabindex")),c.removeAttr("tabindex")})},_.fn.ellipsis=function(c){return this.each(function(){let o=_(this),A=o.text();if(A.length>c){let y=A.substr(0,c);y=y.substr(0,Math.min(y.length,y.lastIndexOf(" "))),o.empty().html(y+"&hellip;")}})},_.fn.ellipsisFill=function(c){let o=!0;return c||(o=!1),this.each(function(){let A=_(this);o||(c=A.text()),A.empty();let y=_('<span title="'+c+'"></span>');if(A.append(y),A.css("overflow","hidden"),y.css("white-space","nowrap"),y.html(c),y.width()>A.width()){let h=null;for(;y.width()>A.width();){let m=y.html();if(m=m.substring(0,m.lastIndexOf(" "))+"&hellip;",m===h)break;y.html(m),h=m}}})},_.fn.ellipsisHtmlFixed=function(c,o){return this.each(function(){let A=_(this),y=A.html(),h=_("<span></span>");if(h.html(A.html().replace(/\s[\s]*/g," ").trim()),h.text().trim().length<=c)return;for(;h.text().trim().length>c;)h.removeLastWord(c);let m=h.html(),I=!1;A.toggle=function(){A.empty();let a=_('<a href="#" class="toggle"></a>');I?(A.html(y+" "),a.text("less"),a.switchClass("less","more")):(A.html(m+"&hellip; "),a.text("more"),a.switchClass("more","less")),a.one("click",function(t){t.preventDefault(),A.toggle()}),I=!I,A.append(a),o&&o()},A.toggle()})},_.fn.enable=function(){return this.each(function(){let c=_(this);c.removeClass("disabled"),c.attr("tabindex",c.data("tabindex"))})},_.fn.equaliseHeight=function(c,o){let A=-1,y=[];c&&this.each(function(){_(this).height("auto")}),this.each(function(){let m=_(this).height();y.push(m),A=A>m?A:m});let h=A;if(o){y.sort(function(I,a){return I-a});let m=Math.floor(y.length/2);y.length%2?h=y[m]:h=(y[m-1]+y[m])/2}return this.each(function(){_(this).height(h)}),this},_.fn.getVisibleElementWithGreatestTabIndex=function(){let c=_(this),o=0,A=null;return c.find("*:visible[tabindex]").each(function(y,h){let m=_(h),I=parseInt(m.attr("tabindex"));I>o&&(o=I,A=m)}),A},_.fn.horizontalMargins=function(){let c=_(this);return parseInt(c.css("marginLeft"))+parseInt(c.css("marginRight"))},_.fn.leftMargin=function(){let c=_(this);return parseInt(c.css("marginLeft"))},_.fn.rightMargin=function(){let c=_(this);return parseInt(c.css("marginRight"))},_.fn.horizontalPadding=function(){let c=_(this);return parseInt(c.css("paddingLeft"))+parseInt(c.css("paddingRight"))},_.fn.leftPadding=function(){let c=_(this);return parseInt(c.css("paddingLeft"))},_.fn.rightPadding=function(){let c=_(this);return parseInt(c.css("paddingRight"))},_.mlp={x:0,y:0};function s(){let c=this===document?_(this):_(this).contents();c.mousemove(function(o){_.mlp={x:o.pageX,y:o.pageY}}),c.find("iframe").on("load",s)}_(s),_.fn.ismouseover=function(){let c=!1;return this.eq(0).each(function(){let o=_(this).is("iframe")?_(this).contents().find("body"):_(this),A=o.offset();c=A.left<=_.mlp.x&&A.left+o.outerWidth()>_.mlp.x&&A.top<=_.mlp.y&&A.top+o.outerHeight()>_.mlp.y}),c};let g=_.fn.on,n;_.fn.on=function(){let c=Array.apply(null,arguments),o=c[c.length-1];if(isNaN(o)||o===1&&c.pop())return g.apply(this,c);let A=c.pop(),y=c.pop();return c.push(function(){let h=this,m=arguments;clearTimeout(n),n=setTimeout(function(){y.apply(h,m)},A)}),g.apply(this,c)},_.fn.onEnter=function(c){return this.each(function(){_(this).on("keyup",function(o){o.keyCode===13&&(o.preventDefault(),c())},0)})},_.fn.onPressed=function(c){return this.each(function(){let o=_(this);o.on("click",function(A){A.preventDefault(),c(A)},0),o.on("keydown",function(A){A.keyCode===13&&(A.preventDefault(),c(A))},0)})},_.fn.removeLastWord=function(c=8,o=0){return this.each(function(){let A=_(this);if(A.contents().length>0){let y=A.contents().last();if(y[0].nodeType===3){let h=y.text().trim().split(" ");if(h.length>1){h.splice(h.length-1,1),y[0].data=h.join(" ");return}else if(typeof c<"u"&&h.length===1&&h[0].length>c){y[0].data=h.join(" ").substring(0,c);return}}y.removeLastWord(c,o+1)}else o>0&&A.remove()})},_.fn.switchClass=function(c,o){return this.each(function(){_(this).removeClass(c).addClass(o)})},_.fn.targetBlank=function(){return this.each(function(){_(this).find("a").prop("target","_blank")})},_.fn.toggleExpandText=function(c,o,A,y){return this.each(function(){let h=_(this),m=h.html();if(c>m.length)return;let I=!1,a=m.substr(0,c);a=a.substr(0,Math.min(a.length,a.lastIndexOf(" "))),h.toggle=function(){h.empty();let t=_('<a href="#" class="toggle"></a>');I?(h.html(m+"&nbsp;"),t.text(o),t.switchClass("less","more")):(h.html(a+"&nbsp;"),t.text(A),t.switchClass("more","less")),t.one("click",function(f){f.preventDefault(),h.toggle()}),I=!I,h.append(t),y&&y()},h.toggle()})},_.fn.toggleExpandTextByLines=function(c,o,A,y){return this.each(function(){let h=_(this),m=h.html(),I=_('<span>&hellip; <a href="#" class="toggle more">morepad</a></span>'),a=[m],t=h.height();for(;h.text().length>0;){h.removeLastWord();let E=h.html();h.append(I),t>h.height()&&(a.unshift(E),t=h.height()),I.remove()}if(a.length<=c){h.html(m);return}let f=a[c-1],d=!1;h.toggle=function(){h.empty();let E=_('<a href="#" class="toggle"></a>');d?(h.html(m+" "),E.text(o),E.switchClass("less","more")):(h.html(f+"&hellip; "),E.text(A),E.switchClass("more","less")),E.one("click",function(R){R.preventDefault(),h.toggle()}),d=!d,h.append(E),y&&y()},h.toggle()})},_.fn.toggleText=function(c,o){return this.each(function(){_(this).text()===c?_(this).text(o):_(this).text(c)})},_.fn.updateAttr=function(c,o,A){return this.each(function(){let y=_(this),h=y.attr(c);h&&h.indexOf(o)===0&&(h=h.replace(o,A),y.attr(c,h))})},_.fn.verticalMargins=function(){let c=_(this);return parseInt(c.css("marginTop"))+parseInt(c.css("marginBottom"))},_.fn.verticalPadding=function(){let c=_(this);return parseInt(c.css("paddingTop"))+parseInt(c.css("paddingBottom"))}}var to=class{constructor(){this.events={},this.onPublishHandler=()=>{}}publish(_,s,g){let n=this.events[_];n&&n.forEach(c=>{c.call(this,s,g)}),this.onPublishHandler.call(this,_,s)}subscribe(_,s){let g=this.events[_];g===void 0&&(g=this.events[_]=[]),g.push(s)}subscribeAll(_){this.onPublishHandler=_}unsubscribe(_,s){let g=this.events[_];if(g===void 0)return;let n=g.indexOf(s);g.splice(n)}unsubscribeAll(){this.onPublishHandler=()=>{}}dispose(){this.events={}}},be=it(Xt()),Pn=Br();zr()(Pn);eo(Pn);var ye={AV:{name:"uv-av-extension",loader:()=>nt(()=>import("./Extension-KDKADH2Y.257a8fb7.mjs"),["_nuxt/Extension-KDKADH2Y.257a8fb7.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-6K2XYBUM.dc3647c3.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-BL47YR37.8a10a117.mjs","_nuxt/chunk-RQD6ZDXZ.f7b64d36.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},ALEPH:{name:"uv-aleph-extension",loader:()=>nt(()=>import("./Extension-2ZFGAGBN.1f9cc141.mjs"),["_nuxt/Extension-2ZFGAGBN.1f9cc141.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-BL47YR37.8a10a117.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-RQD6ZDXZ.f7b64d36.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},DEFAULT:{name:"uv-default-extension",loader:()=>nt(()=>import("./Extension-OBSB2GXO.fc785cf6.mjs"),["_nuxt/Extension-OBSB2GXO.fc785cf6.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-3KBBTTEN.ae32ee6e.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-PFNWY3RH.a21c9813.mjs"])},EBOOK:{name:"uv-ebook-extension",loader:()=>nt(()=>import("./Extension-BD6AV5HO.447c3cb5.mjs"),["_nuxt/Extension-BD6AV5HO.447c3cb5.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-CWH7BDTG.62c8833d.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-RQD6ZDXZ.f7b64d36.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},MEDIAELEMENT:{name:"uv-mediaelement-extension",loader:()=>nt(()=>import("./Extension-RV63KPHD.23cb2480.mjs"),["_nuxt/Extension-RV63KPHD.23cb2480.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-CHPN5XCG.c959e8fd.mjs","_nuxt/chunk-3KBBTTEN.ae32ee6e.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-PFNWY3RH.a21c9813.mjs","_nuxt/chunk-RQD6ZDXZ.f7b64d36.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},MODELVIEWER:{name:"uv-model-viewer-extension",loader:()=>nt(()=>import("./Extension-6AHW5GLD.9a4a9198.mjs"),["_nuxt/Extension-6AHW5GLD.9a4a9198.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-3UUJB7QR.fd324b08.mjs","_nuxt/chunk-CWH7BDTG.62c8833d.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-CHPN5XCG.c959e8fd.mjs","_nuxt/chunk-6K2XYBUM.dc3647c3.mjs","_nuxt/chunk-RQD6ZDXZ.f7b64d36.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},OSD:{name:"uv-openseadragon-extension",loader:()=>nt(()=>import("./Extension-M4PXC4HY.62f5994c.mjs"),["_nuxt/Extension-M4PXC4HY.62f5994c.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-3UUJB7QR.fd324b08.mjs","_nuxt/chunk-CWH7BDTG.62c8833d.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-CHPN5XCG.c959e8fd.mjs","_nuxt/chunk-3KBBTTEN.ae32ee6e.mjs","_nuxt/chunk-6K2XYBUM.dc3647c3.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},PDF:{name:"uv-pdf-extension",loader:()=>nt(()=>import("./Extension-TWKG5BE3.17432b33.mjs"),["_nuxt/Extension-TWKG5BE3.17432b33.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-CHPN5XCG.c959e8fd.mjs","_nuxt/chunk-PFNWY3RH.a21c9813.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-RQD6ZDXZ.f7b64d36.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])},SLIDEATLAS:{name:"uv-openseadragon-extension",loader:()=>nt(()=>import("./Extension-M4PXC4HY.62f5994c.mjs"),["_nuxt/Extension-M4PXC4HY.62f5994c.mjs","_nuxt/entry.cc194de1.mjs","_nuxt/entry.a877e1a1.css","_nuxt/chunk-3UUJB7QR.fd324b08.mjs","_nuxt/chunk-CWH7BDTG.62c8833d.mjs","_nuxt/chunk-7YKIH5A2.1bf302a1.mjs","_nuxt/chunk-CHPN5XCG.c959e8fd.mjs","_nuxt/chunk-3KBBTTEN.ae32ee6e.mjs","_nuxt/chunk-6K2XYBUM.dc3647c3.mjs","_nuxt/chunk-2SUYJOML.5227eb76.mjs"])}},no=class extends qr{constructor(_,s,g){super(_,s,g),this.options=_,this.adapter=s,this.isFullScreen=!1,this.disposed=!1,this.extra={initial:!1},this.extra.initial=!0,this._pubsub=new to,this._init(),this.resize(),this.extra.initial=!1}_init(){return this._extensionRegistry={},this._extensionRegistry[be.ExternalResourceType.CANVAS]=ye.OSD,this._extensionRegistry[be.ExternalResourceType.DOCUMENT]=ye.PDF,this._extensionRegistry[be.ExternalResourceType.IMAGE]=ye.OSD,this._extensionRegistry[be.ExternalResourceType.MOVING_IMAGE]=ye.MEDIAELEMENT,this._extensionRegistry[be.ExternalResourceType.PHYSICAL_OBJECT]=ye.MODELVIEWER,this._extensionRegistry[be.ExternalResourceType.SOUND]=ye.MEDIAELEMENT,this._extensionRegistry[be.MediaType.AUDIO_MP4]=ye.AV,this._extensionRegistry[be.MediaType.DICOM]=ye.ALEPH,this._extensionRegistry[be.MediaType.DRACO]=ye.MODELVIEWER,this._extensionRegistry[be.MediaType.EPUB]=ye.EBOOK,this._extensionRegistry[be.MediaType.GIRDER]=ye.SLIDEATLAS,this._extensionRegistry[be.MediaType.GLB]=ye.MODELVIEWER,this._extensionRegistry[be.MediaType.GLTF]=ye.MODELVIEWER,this._extensionRegistry[be.MediaType.JPG]=ye.OSD,this._extensionRegistry[be.MediaType.MP3]=ye.AV,this._extensionRegistry[be.MediaType.MPEG_DASH]=ye.AV,this._extensionRegistry[be.MediaType.OPF]=ye.EBOOK,this._extensionRegistry[be.MediaType.PDF]=ye.PDF,this._extensionRegistry[be.MediaType.USDZ]=ye.MODELVIEWER,this._extensionRegistry[be.MediaType.VIDEO_MP4]=ye.AV,this._extensionRegistry[be.MediaType.WAV]=ye.AV,this._extensionRegistry[be.MediaType.WEBM]=ye.AV,this._extensionRegistry[be.RenderingFormat.PDF]=ye.PDF,this.on(wt.CREATED,_=>{this.hideSpinner()},!1),this.on(wt.RELOAD,_=>{_.isReload=!0,this.set(_)},!1),this.extra.initial=!0,this.set(this.options.data),this.extra.initial=!1,!0}async _getExtensionByType(_,s){let g=await _.loader(),n=new g.default;return n.format=s,n.type=_,n}_getExtensionByFormat(_){return this._extensionRegistry[_]?this._getExtensionByType(this._extensionRegistry[_],_):this._getExtensionByType(ye.DEFAULT,_)}set(_,s){if(s&&(this.extra.initial=!0),this.extension){let g=Object.assign({},this.extension.data,_);g.isReload||g.iiifManifestId!==this.extension.data.iiifManifestId||g.manifestIndex!==this.extension.data.manifestIndex||g.collectionIndex!==this.extension.data.collectionIndex?(this.extension.data=g,this.showSpinner(),this._reload(this.extension.data)):(this.extension.data=g,this.extension.render())}else{if(!_.iiifManifestId){console.warn("iiifManifestId is required.");return}this._reload(_)}this.extra.initial=!1}publish(_,s,g){this._pubsub.publish(_,s,{...this.extra,...g})}subscribe(_,s){return this._pubsub.subscribe(_,s),()=>{this._pubsub.unsubscribe(_,s)}}subscribeAll(_){return this._pubsub.subscribeAll(_),()=>{this._pubsub.unsubscribeAll()}}dispose(){var _;super.dispose(),this._pubsub.dispose(),(_=this.extension)==null||_.dispose(),this.disposed=!0}async _reload(_){this._pubsub.dispose(),_.target="",this.subscribe(wt.RELOAD,I=>{this.fire(wt.RELOAD,I)}),Pn(this.options.target).empty();let s=this,g=await Zr({manifestUri:_.iiifManifestId,collectionIndex:_.collectionIndex,manifestIndex:_.manifestIndex||0,canvasId:_.canvasId,canvasIndex:_.canvasIndex||0,rangeId:_.rangeId,locale:_.locales?_.locales[0].name:void 0}),n=g.getTrackingLabel();n&&(n+=", URI: "+(window.location!==window.parent.location)?document.referrer:document.location,window.trackingLabel=n);let c;if(c=g.getCurrentCanvas(),!c){s._error(`Canvas ${_.canvasIndex} not found.`);return}let o,A=c.getContent(),y;if(A.length){let I=A[0].getBody();if(I&&I.length)if(y=I[0].getFormat(),y){if(o=await s._getExtensionByFormat(y),!o){let a=I[0].getType();a&&(o=await s._getExtensionByFormat(a))}}else{let a=I[0].getType();a&&(o=await s._getExtensionByFormat(a))}}else{let I=c.getType();if(I&&(o=await s._getExtensionByFormat(I)),!o){let a=c.getProperty("format");o=await s._getExtensionByFormat(a)}}let h=g.getRanges().length>0;o.type===ye.AV&&!h&&(o=await s._getExtensionByType(ye.MEDIAELEMENT,y)),o||(o=await s._getExtensionByFormat(ye.DEFAULT.name)),_.locales||(_.locales=[],_.locales.push(Yr));let m=await o.loadConfig(_.locales[0].name);_.config=await s.configure(m),s._createExtension(o,_,g)}_error(_){this.fire(wt.ERROR,_)}_createExtension(_,s,g){this.extension=_,this.extension&&(this.extension.extensionHost=this,this.extension.data=s,this.extension.helper=g,this.extension.create())}exitFullScreen(){this.extension&&this.extension.exitFullScreen()}resize(){this.extension&&!this.disposed&&this.extension.resize()}};/*! includes JsRender, JsObservable and JsViews - see: http://jsviews.com/#download *//*! jsviews.js v0.9.83 (Beta) single-file version: http://jsviews.com/ */const so=Object.freeze(Object.defineProperty({__proto__:null,default:no},Symbol.toStringTag,{value:"Module"}));export{Wr as $,Jt as G,Xt as H,so as I,oo as R,ao as U,ro as g,Wt as j};
