import{I as ge,M as v,O as R,P as be,a2 as k,K as W}from"./entry-5e54c123.mjs";import{m as ve}from"./chunk-6AUGIHTP-34408fed.mjs";import{_ as Ee}from"./chunk-RSUYDEOQ-b01e74be.mjs";import{Y as we,Z as ye,t as _e,X as te,i as Pe,e as Ce,s as Re,n as Se,a as Le}from"./chunk-P2U3GQ3L-ae62dc84.mjs";import"./IIIFContentHandler-2D2CUZM6-df4ed86b.mjs";var y=class{},p=y;p.namespace="ebookExtension.",p.CFI_FRAGMENT_CHANGE=y.namespace+"cfiFragmentChange",p.ITEM_CLICKED=y.namespace+"itemClicked",p.LOADED_NAVIGATION=y.namespace+"loadedNavigation",p.RELOCATED=y.namespace+"relocated",p.RENDITION_ATTACHED=y.namespace+"renditionAttached",p.TOC_READY=y.namespace+"tocReady";function ne(){var e=window,t=[];(!e.customElements||e.Element&&(!e.Element.prototype.closest||!e.Element.prototype.matches||!e.Element.prototype.remove))&&t.push(v(()=>import("./dom-ITI5BMGR-532e76c0.mjs"),["dom-ITI5BMGR-532e76c0.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"]));function n(){try{var o=new URL("b","http://a");return o.pathname="c%20d",o.href==="http://a/c%20d"&&o.searchParams}catch{return!1}}return(typeof Object.assign!="function"||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||e.NodeList&&!e.NodeList.prototype.forEach||!e.fetch||!n()||typeof WeakMap=="undefined")&&t.push(v(()=>import("./core-js-66EU3Z5G-37450270.mjs"),["core-js-66EU3Z5G-37450270.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"])),Promise.all(t)}var xe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var a in i)i.hasOwnProperty(a)&&(o[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function o(){this.constructor=t}t.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}(),Te=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(r){r(a)})}return new(n||(n=Promise))(function(a,r){function s(c){try{l(o.next(c))}catch(h){r(h)}}function u(c){try{l(o.throw(c))}catch(h){r(h)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((o=o.apply(e,t||[])).next())})},Ae=function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,i,a,r;return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(l){return function(c){return u([l,c])}}function u(l){if(o)throw new TypeError("Generator is already executing.");for(;n;)try{if(o=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{o=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},ke=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],r=0,s=a.length;r<s;r++,i++)o[i]=a[r];return o},F=0,I=!1,oe=!1,_=window,g=document,d={$flags$:0,$resourcesUrl$:"",jmp:function(e){return e()},raf:function(e){return requestAnimationFrame(e)},ael:function(e,t,n,o){return e.addEventListener(t,n,o)},rel:function(e,t,n,o){return e.removeEventListener(t,n,o)}},De=function(){var e=!1;try{g.addEventListener("e",null,Object.defineProperty({},"passive",{get:function(){e=!0}}))}catch{}return e}(),Oe=function(){try{return new CSSStyleSheet,!0}catch{}return!1}(),ie=new WeakMap,P=function(e){return ie.get(e)},Fe=function(e){var t={$flags$:0,$hostElement$:e,$instanceValues$:new Map};return t.$onInstancePromise$=new Promise(function(n){return t.$onInstanceResolve$=n}),t.$onReadyPromise$=new Promise(function(n){return t.$onReadyResolve$=n}),e["s-p"]=[],e["s-rc"]=[],ie.set(e,t)},U=function(e,t){return t in e},S=function(e){return console.error(e)},B=new Map,Ie=function(e,t,n){var o=e.$tagName$.replace(/-/g,"_"),i=e.$lazyBundleIds$,a=B.get(i);return a?a[o]:v(()=>import("./"+i+".entry.js"),[]).then(function(r){return B.set(i,r),r[o]},S)},D=new Map,q=[],C=[],T=[],Ne=function(e,t){return function(n){e.push(n),I||(I=!0,t&&d.$flags$&4?M(N):d.raf(N))}},He=function(e){for(var t=0;t<e.length;t++)try{e[t](performance.now())}catch(n){S(n)}e.length=0},Y=function(e,t){for(var n=0,o=0;n<e.length&&(o=performance.now())<t;)try{e[n++](o)}catch(i){S(i)}n===e.length?e.length=0:n!==0&&e.splice(0,n)},N=function(){F++,He(q);var e=(d.$flags$&6)==2?performance.now()+10*Math.ceil(F*(1/22)):1/0;Y(C,e),Y(T,e),C.length>0&&(T.push.apply(T,C),C.length=0),(I=q.length+C.length+T.length>0)?d.raf(N):F=0},M=function(e){return Promise.resolve().then(e)},Me=Ne(C,!0),K={},G=function(e){return e=typeof e,e==="object"||e==="function"},Ge=function(){return _.CSS&&_.CSS.supports&&_.CSS.supports("color","var(--c)")?Promise.resolve():v(()=>import("./css-shim-978387b1-1e75855f-O4PYI7RC-94109737.mjs"),["css-shim-978387b1-1e75855f-O4PYI7RC-94109737.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"]).then(function(){if(d.$cssShim$=_.__stencil_cssshim,d.$cssShim$)return d.$cssShim$.initShim()})},Ve=function(e,t){return e!=null&&!G(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e},ae="hydrated",E=function(e,t){return function(){}},je=function(e,t){return function(){}},X=new WeakMap,ze=function(e,t,n){var o=D.get(e);Oe&&n?(o=o||new CSSStyleSheet,o.replace(t)):o=t,D.set(e,o)},We=function(e,t,n,o){var i=re(t.$tagName$),a=D.get(i);if(e=e.nodeType===11?e:g,a)if(typeof a=="string"){e=e.head||e;var r=X.get(e),s=void 0;if(r||X.set(e,r=new Set),!r.has(i)){{if(d.$cssShim$){s=d.$cssShim$.createHostStyle(o,i,a,!!(t.$flags$&10));var u=s["s-sc"];u&&(i=u,r=null)}else s=g.createElement("style"),s.innerHTML=a;e.insertBefore(s,e.querySelector("link"))}r&&r.add(i)}}else e.adoptedStyleSheets.includes(a)||(e.adoptedStyleSheets=ke(e.adoptedStyleSheets,[a]));return i},Ue=function(e,t,n){E("attachStyles",t.$tagName$),We(e.getRootNode(),t,n,e)},re=function(e,t){return"sc-"+e},Be=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=null,a=!1,r=!1,s=[],u=function(h){for(var f=0;f<h.length;f++)i=h[f],Array.isArray(i)?u(i):i!=null&&typeof i!="boolean"&&((a=typeof e!="function"&&!G(i))&&(i=String(i)),a&&r?s[s.length-1].$text$+=i:s.push(a?H(null,i):i),r=a)};if(u(n),t){var l=t.className||t.class;l&&(t.class=typeof l!="object"?l:Object.keys(l).filter(function(h){return l[h]}).join(" "))}var c=H(e,null);return c.$attrs$=t,s.length>0&&(c.$children$=s),c},H=function(e,t){var n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return n.$attrs$=null,n},qe={},Ye=function(e){return e&&e.$tag$===qe},Z=function(e,t,n,o,i,a){if(n!==o){var r=U(e,t),s=t.toLowerCase();if(t==="class"){var u=e.classList,l=J(n),c=J(o);u.remove.apply(u,l.filter(function(m){return m&&!c.includes(m)})),u.add.apply(u,c.filter(function(m){return m&&!l.includes(m)}))}else if(t==="ref")o&&o(e);else if(!r&&t[0]==="o"&&t[1]==="n")t[2]==="-"?t=t.slice(3):U(_,s)?t=s.slice(2):t=s[2]+t.slice(3),n&&d.rel(e,t,n,!1),o&&d.ael(e,t,o,!1);else{var h=G(o);if((r||h&&o!==null)&&!i)try{if(e.tagName.includes("-"))e[t]=o;else{var f=o!=null?o:"";t==="list"?r=!1:(n==null||e[t]!=f)&&(e[t]=f)}}catch{}o==null||o===!1?e.removeAttribute(t):(!r||a&4||i)&&!h&&(o=o===!0?"":o,e.setAttribute(t,o))}}},Ke=/\s/,J=function(e){return e?e.split(Ke):[]},se=function(e,t,n,o){var i=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,a=e&&e.$attrs$||K,r=t.$attrs$||K;for(o in a)o in r||Z(i,o,a[o],void 0,n,t.$flags$);for(o in r)Z(i,o,a[o],r[o],n,t.$flags$)},V=function(e,t,n,o){var i=t.$children$[n],a=0,r,s;if(i.$text$!==null)r=i.$elm$=g.createTextNode(i.$text$);else if(r=i.$elm$=g.createElement(i.$tag$),se(null,i,oe),i.$children$)for(a=0;a<i.$children$.length;++a)s=V(e,i,a),s&&r.appendChild(s);return r},le=function(e,t,n,o,i,a){for(var r=e,s;i<=a;++i)o[i]&&(s=V(null,n,i),s&&(o[i].$elm$=s,r.insertBefore(s,t)))},ue=function(e,t,n,o,i){for(;t<=n;++t)(o=e[t])&&(i=o.$elm$,ce(o),i.remove())},Xe=function(e,t,n,o){for(var i=0,a=0,r=t.length-1,s=t[0],u=t[r],l=o.length-1,c=o[0],h=o[l],f;i<=r&&a<=l;)s==null?s=t[++i]:u==null?u=t[--r]:c==null?c=o[++a]:h==null?h=o[--l]:A(s,c)?(L(s,c),s=t[++i],c=o[++a]):A(u,h)?(L(u,h),u=t[--r],h=o[--l]):A(s,h)?(L(s,h),e.insertBefore(s.$elm$,u.$elm$.nextSibling),s=t[++i],h=o[--l]):A(u,c)?(L(u,c),e.insertBefore(u.$elm$,s.$elm$),u=t[--r],c=o[++a]):(f=V(t&&t[a],n,a),c=o[++a],f&&s.$elm$.parentNode.insertBefore(f,s.$elm$));i>r?le(e,o[l+1]==null?null:o[l+1].$elm$,n,o,a,l):a>l&&ue(t,i,r)},A=function(e,t){return e.$tag$===t.$tag$},L=function(e,t){var n=t.$elm$=e.$elm$,o=e.$children$,i=t.$children$;t.$text$===null?(se(e,t,oe),o!==null&&i!==null?Xe(n,o,t,i):i!==null?(e.$text$!==null&&(n.textContent=""),le(n,null,t,i,0,i.length-1)):o!==null&&ue(o,0,o.length-1)):e.$text$!==t.$text$&&(n.data=t.$text$)},ce=function(e){e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.forEach(ce)},Ze=function(e,t,n,o){var i=t.$vnode$||H(null,null),a=Ye(o)?o:Be(null,null,o);a.$tag$=null,a.$flags$|=4,t.$vnode$=a,a.$elm$=i.$elm$=e,L(i,a)},he=function(e,t){t&&!e.$onRenderResolve$&&t["s-p"].push(new Promise(function(n){return e.$onRenderResolve$=n}))},O=function(e,t,n,o){if(t.$flags$|=16,t.$flags$&4){t.$flags$|=512;return}E("scheduleUpdate",n.$tagName$);var i=t.$ancestorComponent$,a=t.$lazyInstance$,r=function(){return Je(e,t,n,a,o)};he(t,i);var s;return o&&(t.$flags$|=256,t.$queuedListeners$&&(t.$queuedListeners$.forEach(function(u){var l=u[0],c=u[1];return fe(a,l,c)}),t.$queuedListeners$=null)),tt(s,function(){return Me(r)})},Je=function(e,t,n,o,i){E("update",n.$tagName$);var a=e["s-rc"];i&&Ue(e,n,t.$modeName$),E("render",n.$tagName$);try{Ze(e,t,n,o.render())}catch(u){S(u)}d.$cssShim$&&d.$cssShim$.updateHost(e),t.$flags$&=-17,t.$flags$|=2,a&&(a.forEach(function(u){return u()}),e["s-rc"]=void 0);{var r=e["s-p"],s=function(){return Qe(e,t,n)};r.length===0?s():(Promise.all(r).then(s),t.$flags$|=4,r.length=0)}},Qe=function(e,t,n){var o=E("postUpdate",n.$tagName$),i=t.$lazyInstance$,a=t.$ancestorComponent$;t.$flags$&64?(fe(i,"componentDidUpdate"),o()):(t.$flags$|=64,e.classList.add(ae),t.$onReadyResolve$(e),a||de()),t.$onInstanceResolve$(e),t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),t.$flags$&512&&M(function(){return O(e,t,n,!1)}),t.$flags$&=-517},et=function(e,t){{var n=P(e);(n.$flags$&18)==2&&O(e,n,t,!1)}},de=function(e){g.documentElement.classList.add(ae),d.$flags$|=2},fe=function(e,t,n){if(e&&e[t])try{return e[t](n)}catch(o){S(o)}},tt=function(e,t){return e&&e.then?e.then(t):t()},nt=function(e,t){return P(e).$instanceValues$.get(t)},ot=function(e,t,n,o){var i=P(e),a=i.$hostElement$,r=i.$instanceValues$.get(t),s=i.$flags$,u=i.$lazyInstance$;n=Ve(n,o.$members$[t][0]),n!==r&&(!(s&8)||r===void 0)&&(i.$instanceValues$.set(t,n),u&&(s&18)==2&&O(a,i,o,!1))},pe=function(e,t,n){if(t.$members$){var o=Object.entries(t.$members$),i=e.prototype;if(o.forEach(function(r){var s=r[0],u=r[1][0];u&31||n&2&&u&32?Object.defineProperty(i,s,{get:function(){return nt(this,s)},set:function(l){ot(this,s,l,t)},configurable:!0,enumerable:!0}):n&1&&u&64&&Object.defineProperty(i,s,{value:function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];var h=P(this);return h.$onInstancePromise$.then(function(){var f;return(f=h.$lazyInstance$)[s].apply(f,l)})}})}),n&1){var a=new Map;i.attributeChangedCallback=function(r,s,u){var l=this;d.jmp(function(){var c=a.get(r);l[c]=u===null&&typeof l[c]=="boolean"?!1:u})},e.observedAttributes=o.filter(function(r){r[0];var s=r[1];return s[0]&15}).map(function(r){var s=r[0],u=r[1],l=u[1]||s;return a.set(l,s),l})}}return e},it=function(e,t,n){t.$queuedListeners$=t.$queuedListeners$||[];var o=n.map(function(i){var a=i[0],r=i[1],s=i[2],u=rt(e,a),l=at(t,s),c=st(a);return d.ael(u,r,l,c),function(){return d.rel(u,r,l,c)}});return function(){return o.forEach(function(i){return i()})}},at=function(e,t){return function(n){e.$flags$&256?e.$lazyInstance$[t](n):e.$queuedListeners$.push([t,n])}},rt=function(e,t){return t&8?_:e},st=function(e){return De?{passive:(e&1)!=0,capture:(e&2)!=0}:(e&2)!=0},lt=function(e,t,n,o,i){return Te(void 0,void 0,void 0,function(){var a,r,s,u,l,c,h;return Ae(this,function(f){switch(f.label){case 0:return(t.$flags$&32)!=0?[3,3]:(t.$flags$|=32,i=Ie(n),i.then?(a=je(),[4,i]):[3,2]);case 1:i=f.sent(),a(),f.label=2;case 2:i.isProxied||(pe(i,n,2),i.isProxied=!0),r=E("createInstance",n.$tagName$),t.$flags$|=8;try{new i(t)}catch(m){S(m)}t.$flags$&=-9,r(),s=re(n.$tagName$),!D.has(s)&&i.style&&(u=E("registerStyles",n.$tagName$),l=i.style,ze(s,l,!!(n.$flags$&1)),u()),f.label=3;case 3:return c=t.$ancestorComponent$,h=function(){return O(e,t,n,!0)},c&&c["s-rc"]?c["s-rc"].push(h):h(),[2]}})})},ut=function(e,t){if((d.$flags$&1)==0){var n=E("connectedCallback",t.$tagName$),o=P(e);if(t.$listeners$&&(o.$rmListeners$=it(e,o,t.$listeners$)),!(o.$flags$&1)){o.$flags$|=1;for(var i=e;i=i.parentNode||i.host;)if(i["s-p"]){he(o,o.$ancestorComponent$=i);break}t.$members$&&Object.entries(t.$members$).forEach(function(a){var r=a[0],s=a[1][0];if(s&31&&e.hasOwnProperty(r)){var u=e[r];delete e[r],e[r]=u}}),M(function(){return lt(e,o,t)})}n()}},ct=function(e){if((d.$flags$&1)==0){var t=P(e);t.$rmListeners$&&(t.$rmListeners$(),t.$rmListeners$=void 0),d.$cssShim$&&d.$cssShim$.removeHost(e)}},ht=function(e,t){t===void 0&&(t={});var n=[],o=t.exclude||[],i=g.head,a=_.customElements,r=i.querySelector("meta[charset]"),s=g.createElement("style"),u=[],l,c=!0;Object.assign(d,t),d.$resourcesUrl$=new URL(t.resourcesUrl||"./",g.baseURI).href,t.syncQueue&&(d.$flags$|=4),e.forEach(function(h){return h[1].forEach(function(f){var m={$flags$:f[0],$tagName$:f[1],$members$:f[2],$listeners$:f[3]};m.$members$=f[2],m.$listeners$=f[3];var x=m.$tagName$,me=function(j){xe(w,j);function w(b){var z=j.call(this,b)||this;return b=z,Fe(b),z}return w.prototype.connectedCallback=function(){var b=this;l&&(clearTimeout(l),l=null),c?u.push(this):d.jmp(function(){return ut(b,m)})},w.prototype.disconnectedCallback=function(){var b=this;d.jmp(function(){return ct(b)})},w.prototype["s-hmr"]=function(b){},w.prototype.forceUpdate=function(){et(this,m)},w.prototype.componentOnReady=function(){return P(this).$onReadyPromise$},w}(HTMLElement);m.$lazyBundleIds$=h[0],!o.includes(x)&&!a.get(x)&&(n.push(x),a.define(x,pe(me,m,1)))})}),s.innerHTML=n+"{visibility:hidden}.hydrated{visibility:inherit}",s.setAttribute("data-styles",""),i.insertBefore(s,r?r.nextSibling:i.firstChild),c=!1,u.length>0?u.forEach(function(h){return h.connectedCallback()}):d.jmp(function(){return l=setTimeout(de,30,"timeout")})},$e=function(e,t){return Ge().then(function(){ht([["uv-ebook-reader_2",[[0,"uv-ebook-reader",{width:[1],height:[1],mobileWidth:[2,"mobile-width"],minSpreadWidth:[2,"min-spread-width"],_bookPath:[32],_bookReady:[32],_prevEnabled:[32],_mobile:[32],_nextEnabled:[32],_showDivider:[32],load:[64],resize:[64],display:[64],getBook:[64]},[[8,"keydown","handleKeyDown"]]],[0,"uv-ebook-toc",{toc:[16],selected:[1025],disabled:[4]}]]]],t)})};(function(){if(!(window.Reflect===void 0||window.customElements===void 0)){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}})();var Q=ge(),dt=class extends Pe{constructor(e){super(e)}async create(){this.setConfig("ebookLeftPanel"),super.create(),this._$container=Q('<div class="container"></div>'),await ne(),$e(),this._ebookTOC=document.createElement("uv-ebook-toc"),this._$ebookTOC=Q(this._ebookTOC),this.$main.addClass("disabled"),this.$main.append(this._$container),this._$container.append(this._$ebookTOC),this.setTitle(this.content.title),this.extensionHost.subscribe(p.LOADED_NAVIGATION,e=>{this.$main.removeClass("disabled"),this._ebookTOC.toc=e.toc}),this.extensionHost.subscribe(p.RELOCATED,e=>{this._ebookTOC.selected=e.start.href}),this._ebookTOC.addEventListener("itemClicked",e=>{this.extensionHost.publish(p.ITEM_CLICKED,e.detail)},!1),k.waitFor(()=>window.customElements!==void 0,()=>{customElements.whenDefined("uv-ebook-toc").then(()=>{this.extensionHost.publish(p.TOC_READY)})})}expandFullStart(){super.expandFullStart(),this.extensionHost.publish(R.LEFTPANEL_EXPAND_FULL_START)}expandFullFinish(){super.expandFullFinish(),this.extensionHost.publish(R.LEFTPANEL_EXPAND_FULL_FINISH)}collapseFullStart(){super.collapseFullStart(),this.extensionHost.publish(R.LEFTPANEL_COLLAPSE_FULL_START)}collapseFullFinish(){super.collapseFullFinish(),this.extensionHost.publish(R.LEFTPANEL_COLLAPSE_FULL_FINISH)}resize(){super.resize(),this._$container.height(this.$main.height()-this._$container.verticalPadding())}},ft=class extends Ee{constructor(e){super(e)}create(){this.setConfig("downloadDialogue"),super.create()}open(e){super.open(e),this.addEntireFileDownloadOptions(),this.updateNoneAvailable(),this.resize()}isDownloadOptionAvailable(e){return super.isDownloadOptionAvailable(e)}},pt=class extends Ce{constructor(e){super(e),this._ebookReaderReady=!1,this._state={},this._prevState={},this.attributionPosition=Re.BOTTOM_RIGHT}async create(){this.setConfig("ebookCenterPanel"),super.create(),await ne(),$e(),this._ebookReader=document.createElement("uv-ebook-reader"),this.$content.prepend(this._ebookReader),this._ebookReader.setAttribute("width","100%"),this._ebookReader.setAttribute("height","100%"),this._ebookReader.addEventListener("loadedNavigation",t=>{this.extensionHost.publish(p.LOADED_NAVIGATION,t.detail)},!1),this._ebookReader.addEventListener("relocated",t=>{this.extensionHost.publish(p.RELOCATED,t.detail),this._cfi=t.detail.start.cfi,this.extensionHost.publish(p.CFI_FRAGMENT_CHANGE,this._cfi)},!1),k.waitFor(()=>window.customElements!==void 0,()=>{customElements.whenDefined("uv-ebook-reader").then(()=>{this._ebookReaderReady=!0})});let e=this;this.extensionHost.subscribe(R.OPEN_EXTERNAL_RESOURCE,t=>{e.openMedia(t)}),this.extensionHost.subscribe(p.ITEM_CLICKED,t=>{this._nextState({cfi:t})}),this.extensionHost.subscribe(p.CFI_FRAGMENT_CHANGE,t=>{k.waitFor(()=>this._ebookReaderReady,()=>{t!==this._cfi&&this._nextState({cfi:t})})})}openMedia(e){this.extension.getExternalResources(e).then(()=>{let t=this.extension.helper.getCurrentCanvas().getContent();if(t.length){let n=t[0].getBody();if(n.length){let o=n[0];this._nextState({bookPath:o.id})}}this.extensionHost.publish(W.EXTERNAL_RESOURCE_OPENED),this.extensionHost.publish(W.LOAD)})}_nextState(e){this._state=Object.assign({},this._state,e),k.waitFor(()=>this._ebookReaderReady,()=>{this._state.bookPath&&this._state.bookPath!==this._prevState.bookPath&&this._ebookReader.load(this._state.bookPath),this._state.cfi&&this._state.cfi!==this._prevState.cfi&&this._ebookReader.display(this._state.cfi),this._prevState=Object.assign({},this._state)})}resize(){super.resize(),this._ebookReaderReady&&setTimeout(()=>{this._ebookReader.resize()},10)}},$t=class extends te{constructor(e){super(e)}create(){this.setConfig("mobileFooterPanel"),super.create()}resize(){super.resize(),this.$options.css("left",Math.floor(this.$element.width()/2-this.$options.width()/2))}},mt=class extends Se{constructor(e){super(e)}create(){this.setConfig("settingsDialogue"),super.create()}},gt=class extends Le{constructor(e){super(e)}create(){this.setConfig("shareDialogue"),super.create()}update(){super.update(),this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight),this.$code.val(this.code)}resize(){super.resize()}},bt={allowStealFocus:!1,authAPIVersion:1,bookmarkThumbHeight:150,bookmarkThumbWidth:90,dropEnabled:!0,footerPanelEnabled:!0,headerPanelEnabled:!0,leftPanelEnabled:!0,limitLocales:!1,metrics:[{type:"sm",minWidth:0},{type:"md",minWidth:768},{type:"lg",minWidth:1024},{type:"xl",minWidth:1280}],multiSelectionMimeType:"application/zip",navigatorEnabled:!0,openTemplate:"http://universalviewer.io?manifest={0}",overrideFullScreen:!1,pagingEnabled:!0,pagingOptionEnabled:!0,pessimisticAccessControl:!1,preserveViewport:!1,rightPanelEnabled:!0,saveUserSettings:!1,clickToZoomEnabled:!0,searchWithinEnabled:!0,termsOfUseEnabled:!1,theme:"uv-en-GB-theme",tokenStorage:"session",useArrowKeysToNavigate:!1,zoomToSearchResultEnabled:!0},vt={ebookLeftPanel:{options:{expandFullEnabled:!1,panelAnimationDuration:250,panelCollapsedWidth:30,panelExpandedWidth:255},content:{title:"Contents"}},dialogue:{topCloseButtonEnabled:!1,content:{close:"Close"}},footerPanel:{options:{bookmarkEnabled:!1,downloadEnabled:!0,embedEnabled:!1,feedbackEnabled:!1,fullscreenEnabled:!0,minimiseButtons:!0,moreInfoEnabled:!0,openEnabled:!1,printEnabled:!1,shareEnabled:!0},content:{bookmark:"Add to bookmarks",download:"Download",embed:"Embed",exitFullScreen:"Exit Full Screen",feedback:"Feedback",fullScreen:"Full Screen",moreInfo:"More Information",open:"Open",share:"Share"}},genericDialogue:{content:{emptyValue:"please enter a value.",invalidNumber:"Please enter a valid number.",noMatches:"No matches were found.",ok:"OK",pageNotFound:"This item does not contain a page with the number you entered. Try switching the numbering mode to 'image'.",refresh:"Refresh"}},headerPanel:{options:{localeToggleEnabled:!1,settingsButtonEnabled:!0},content:{settings:"Settings"}},helpDialogue:{content:{text:"placeholder text",title:"Help"}},moreInfoRightPanel:{options:{canvasDisplayOrder:"",canvasExclude:"",copyToClipboardEnabled:!1,manifestDisplayOrder:"",manifestExclude:"",panelAnimationDuration:250,panelCollapsedWidth:30,panelExpandedWidth:255,panelOpen:!1,rtlLanguageCodes:"ar, ara, dv, div, he, heb, ur, urd",showAllLanguages:!1,textLimit:4,textLimitType:"lines",limitToRange:!1},content:{attribution:"Attribution",collapse:"Collapse Information",collapseFull:"Collapse Gallery",description:"Description",expand:"Expand Information",expandFull:"Expand Gallery",holdingText:"Your module goes here!",less:"less",license:"License",logo:"Logo",more:"more",noData:"No data to display",page:"Page",title:"More Information",manifestHeader:"About the item",canvasHeader:"About the image",copyToClipboard:"Copy to clipboard",copiedToClipboard:"Copied to clipboard"}},ebookCenterPanel:{options:{}},settingsDialogue:{content:{locale:"Locale",navigatorEnabled:"Navigator Enabled",clickToZoomEnabled:"Mouse Click To Zoom",pagingEnabled:"Two Page View",reducedMotion:"Reduce motion (disables animations)",preserveViewport:"Preserve Zoom",title:"Settings",website:"<a href='https://github.com/universalviewer/universalviewer#contributors'>more info</a>"}},shareDialogue:{options:{embedTemplate:'<iframe src="{0}" width="{1}" height="{2}" allowfullscreen frameborder="0"></iframe>',instructionsEnabled:!1,shareFrameEnabled:!0},content:{customSize:"custom",embed:"Embed",embedInstructions:"To embed this item in your own website, copy and paste the code below.",height:"Height",iiif:"IIIF Manifest",share:"Share",shareInstructions:"To share this item, copy the URL below.",size:"Size:",width:"Width"}},authDialogue:{content:{cancel:"Cancel",confirm:"Confirm"}},clickThroughDialogue:{content:{viewTerms:"Read Full Terms and Conditions"}},downloadDialogue:{content:{currentViewAsJpg:"Current view {0} x {1}px (jpg)",currentViewAsJpgExplanation:"Opens in a new window",download:"Download",downloadSelection:"Download Selection",downloadSelectionExplanation:"Opens a dialogue to select which pages to download.",editSettings:"Edit Settings",entireDocument:"Entire document ({0})",entireFileAsOriginal:"Entire file",entireFileAsOriginalWithFormat:"Entire file ({0})",noneAvailable:"No download options are available.",pagingNote:"Please turn off Two Page View for additional options.",preview:"Preview",title:"Download",wholeImageHighRes:"Whole image {0} x {1}px ({2})",wholeImageHighResExplanation:"Opens in a new window.",wholeImagesHighRes:"Whole images ({0})",wholeImagesHighResExplanation:"Opens in two new windows.",wholeImageLowResAsJpg:"Whole image {0} x {1}px (jpg)",wholeImageLowResAsJpgExplanation:"Opens in a new window."}},loginDialogue:{content:{login:"Login",logout:"Logout",cancel:"Cancel"}},avCenterPanel:{content:{attribution:"Attribution"}},restrictedDialogue:{content:{cancel:"Cancel"}}},Et={label:"English (GB)",locales:[{name:"cy-GB",label:"Cymraeg"},{name:"en-GB",label:"English (GB)"},{name:"fr-FR",label:"Fran\xE7ais (FR)"},{name:"pl-PL",label:"Polski"},{name:"sv-SE",label:"Svenska"}]},wt={authCORSError:"Your browser does not support CORS, please upgrade to view this content.",authorisationFailedMessage:"Your log-in attempt did not appear to be successful. Please try again.",canvasIndexOutOfRange:"Canvas index out of range.",fallbackDegradedLabel:"Login",fallbackDegradedMessage:"Please log in to view this content at full resolution.",forbiddenResourceMessage:"Your current access rights are insufficient to view this image",termsOfUse:"Terms of Use",mediaViewer:"Media Viewer",skipToDownload:"Skip to downloads and alternative formats"},ee={options:bt,modules:vt,localisation:Et,content:wt},St=class extends we{constructor(){super(...arguments),this.defaultConfig=ee,this.locales={"en-GB":ee,"cy-GB":()=>v(()=>import("./cy-GB-LTUUSXSY-07b66728.mjs"),["cy-GB-LTUUSXSY-07b66728.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"]),"fr-FR":()=>v(()=>import("./fr-FR-DKL5MCZE-6a760a70.mjs"),["fr-FR-DKL5MCZE-6a760a70.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"]),"pl-PL":()=>v(()=>import("./pl-PL-7Q76AJED-c3ab0e45.mjs"),["pl-PL-7Q76AJED-c3ab0e45.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"]),"sv-SE":()=>v(()=>import("./sv-SE-PBF7APYM-f3eb12d2.mjs"),["sv-SE-PBF7APYM-f3eb12d2.mjs","entry-5e54c123.mjs","entry.20e32d7f.css"])}}create(){super.create(),this.extensionHost.subscribe(R.CANVAS_INDEX_CHANGE,e=>{this.viewCanvas(e)}),this.extensionHost.subscribe(p.CFI_FRAGMENT_CHANGE,e=>{this.cfiFragement=e,this.fire(p.CFI_FRAGMENT_CHANGE,this.cfiFragement)})}createModules(){super.createModules(),this.isHeaderPanelEnabled()?this.headerPanel=new ye(this.shell.$headerPanel):this.shell.$headerPanel.hide(),this.isLeftPanelEnabled()?this.leftPanel=new dt(this.shell.$leftPanel):this.shell.$leftPanel.hide(),this.centerPanel=new pt(this.shell.$centerPanel),this.isRightPanelEnabled()?this.rightPanel=new _e(this.shell.$rightPanel):this.shell.$rightPanel.hide(),this.isFooterPanelEnabled()?(this.footerPanel=new te(this.shell.$footerPanel),this.mobileFooterPanel=new $t(this.shell.$mobileFooterPanel)):this.shell.$footerPanel.hide(),this.$moreInfoDialogue=$('<div class="overlay moreInfo" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$moreInfoDialogue),this.moreInfoDialogue=new ve(this.$moreInfoDialogue),this.$shareDialogue=$('<div class="overlay share" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new gt(this.$shareDialogue),this.$downloadDialogue=$('<div class="overlay download" aria-hidden="true" role="region"></div>'),this.shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new ft(this.$downloadDialogue),this.$settingsDialogue=$('<div class="overlay settings" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new mt(this.$settingsDialogue),this.isHeaderPanelEnabled()&&this.headerPanel.init(),this.isLeftPanelEnabled()&&this.leftPanel.init(),this.isRightPanelEnabled()&&this.rightPanel.init(),this.isFooterPanelEnabled()&&this.footerPanel.init()}isLeftPanelEnabled(){return!0}render(){super.render(),this.checkForCFIParam()}getEmbedScript(e,t,n){let o=`${this.getAppUri()}#?manifest=${this.helper.manifestUri}&cfi=${this.cfiFragement}`;return be.format(e,o,t.toString(),n.toString())}checkForCFIParam(){let e=this.data.cfi;e&&this.extensionHost.publish(p.CFI_FRAGMENT_CHANGE,e)}};export{St as default};
